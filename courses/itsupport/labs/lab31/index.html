<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Lab 31: Entra ID - License Assignment</title>
<style>
* { box-sizing: border-box; margin: 0; padding: 0; }
html, body { height: 100%; }
body { background-color: #1e1e1e; padding: 20px; overflow: hidden; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; color: #111; }

.task-instructions {
  background: linear-gradient(135deg, #e3f2fd 0%, #f1f8e9 100%);
  border: 1px solid #90caf9; border-radius: 8px; padding: 14px 16px; margin: 0 0 14px 0;
  position: sticky; top: 0; z-index: 1000;
}
.task-instructions .task-title {
  font-weight: 600; color: #ffffff; background: linear-gradient(135deg, #0078d4 0%, #005a9e 100%);
  padding: 8px 12px; border-radius: 6px; display: inline-block; margin-bottom: 8px;
}
.task-instructions .task-description { color: #1e1e1e; line-height: 1.45; }
.task-instructions ol { margin: 8px 0 0 20px; }

.lab-container {
  width: 1200px; height: 700px; margin: 0 auto;
  background: #ffffff; border-radius: 8px; box-shadow: 0 8px 32px rgba(0,0,0,0.3);
  overflow: hidden; position: relative;
}

.azure-header {
  height: 50px; background: #0078d4; color: white; display: flex; align-items: center;
  padding: 0 20px; font-weight: 500; border-bottom: 1px solid #005a9e;
}
.azure-header .logo { margin-right: 16px; font-size: 18px; }
.azure-header .search { margin-left: auto; background: rgba(255,255,255,0.2); border: none; 
  padding: 6px 12px; border-radius: 4px; color: white; width: 200px; }
.azure-header .search::placeholder { color: rgba(255,255,255,0.7); }

.azure-nav {
  width: 250px; height: calc(100% - 50px); background: #f8f9fa; border-right: 1px solid #dee2e6;
  overflow-y: auto; padding: 16px 0;
}
.nav-item {
  padding: 10px 20px; cursor: pointer; font-size: 14px; color: #495057;
  border-left: 3px solid transparent; transition: all 0.2s ease;
}
.nav-item:hover { background: #e9ecef; }
.nav-item.active { background: #e3f2fd; color: #0078d4; border-left-color: #0078d4; font-weight: 500; }
.nav-item .icon { margin-right: 12px; width: 16px; display: inline-block; }

.main-content {
  position: absolute; left: 250px; top: 50px; right: 0; bottom: 0;
  background: white; overflow: auto;
}
.content-header {
  padding: 20px 24px; border-bottom: 1px solid #dee2e6; background: #fafbfc;
}
.content-title { font-size: 20px; font-weight: 600; margin-bottom: 4px; }
.content-subtitle { color: #6c757d; font-size: 14px; }

.user-list {
  padding: 24px;
}
.user-table {
  width: 100%; border-collapse: collapse; background: white; border-radius: 8px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.1); overflow: hidden;
}
.user-table th {
  background: #f8f9fa; padding: 12px 16px; text-align: left; font-weight: 600;
  border-bottom: 2px solid #dee2e6; color: #495057; font-size: 13px;
}
.user-table td {
  padding: 12px 16px; border-bottom: 1px solid #f1f3f4; font-size: 14px;
}
.user-table tbody tr:hover { background: #f8f9fa; }
.user-table tbody tr { cursor: pointer; transition: background 0.2s ease; }

.status-badge {
  display: inline-block; padding: 4px 8px; border-radius: 12px; font-size: 11px;
  font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px;
}
.status-active { background: #d4edda; color: #155724; }
.status-unlicensed { background: #fff3cd; color: #856404; }

.search-box {
  margin-bottom: 16px; position: relative;
}
.search-box input {
  width: 300px; padding: 8px 12px 8px 40px; border: 1px solid #ced4da;
  border-radius: 4px; font-size: 14px;
}
.search-box::before {
  content: "üîç"; position: absolute; left: 12px; top: 50%; transform: translateY(-50%);
  color: #6c757d;
}

.user-detail {
  position: absolute; left: 250px; top: 50px; right: 0; bottom: 0;
  background: white; display: none; z-index: 100;
}
.detail-header {
  padding: 20px 24px; border-bottom: 1px solid #dee2e6; background: #fafbfc;
  display: flex; align-items: center; gap: 16px;
}
.detail-title { font-size: 20px; font-weight: 600; }
.back-btn {
  padding: 6px 12px; border: 1px solid #ced4da; border-radius: 4px;
  background: white; cursor: pointer; font-size: 14px; color: #495057;
}
.back-btn:hover { background: #f8f9fa; }

.detail-tabs {
  display: flex; border-bottom: 1px solid #dee2e6; background: #fafbfc;
}
.tab {
  padding: 12px 20px; cursor: pointer; border-bottom: 2px solid transparent;
  font-weight: 500; color: #6c757d; transition: all 0.2s ease;
}
.tab.active { color: #0078d4; border-bottom-color: #0078d4; }
.tab:hover:not(.active) { color: #495057; }

.tab-content {
  padding: 24px;
}
.license-section {
  background: white; border: 1px solid #dee2e6; border-radius: 8px;
  padding: 20px; margin-bottom: 16px;
}
.license-header {
  display: flex; justify-content: space-between; align-items: center;
  margin-bottom: 16px;
}
.assign-btn {
  background: #0078d4; color: white; border: none; padding: 8px 16px;
  border-radius: 4px; cursor: pointer; font-weight: 500;
}
.assign-btn:hover { background: #106ebe; }
.assign-btn:disabled { background: #6c757d; cursor: not-allowed; }

.license-modal {
  position: fixed; top: 0; left: 0; right: 0; bottom: 0;
  background: rgba(0,0,0,0.5); display: none; z-index: 1000;
  align-items: center; justify-content: center;
}
.modal-content {
  background: white; border-radius: 8px; box-shadow: 0 16px 64px rgba(0,0,0,0.3);
  width: 600px; max-height: 80vh; overflow: auto;
}
.modal-header {
  padding: 20px 24px; border-bottom: 1px solid #dee2e6;
  font-size: 18px; font-weight: 600;
}
.modal-body { padding: 24px; }
.modal-footer {
  padding: 16px 24px; border-top: 1px solid #dee2e6;
  display: flex; gap: 12px; justify-content: flex-end;
}

.form-group {
  margin-bottom: 20px;
}
.form-label {
  display: block; margin-bottom: 8px; font-weight: 500; color: #495057;
}
.form-select {
  width: 100%; padding: 8px 12px; border: 1px solid #ced4da;
  border-radius: 4px; font-size: 14px;
}

.license-plan {
  border: 1px solid #dee2e6; border-radius: 4px; margin-bottom: 12px;
  transition: all 0.2s ease;
}
.license-plan.selected { border-color: #0078d4; background: #f8f9fa; }
.plan-header {
  padding: 16px; display: flex; align-items: center; gap: 12px;
  cursor: pointer;
}
.plan-details {
  padding: 0 16px 16px; display: none; border-top: 1px solid #dee2e6;
  margin-top: 16px; padding-top: 16px;
}
.plan-details.show { display: block; }

.service-plans {
  display: grid; grid-template-columns: 1fr 1fr; gap: 8px;
  margin-top: 12px;
}
.service-item {
  display: flex; align-items: center; gap: 8px; padding: 4px 0;
  font-size: 13px;
}

.btn {
  padding: 8px 16px; border: 1px solid #ced4da; border-radius: 4px;
  background: white; cursor: pointer; font-size: 14px;
}
.btn-primary { background: #0078d4; color: white; border-color: #0078d4; }
.btn-primary:hover { background: #106ebe; }

.success-toast {
  position: fixed; bottom: 20px; right: 20px; background: #d4edda;
  color: #155724; padding: 16px 20px; border-radius: 8px;
  box-shadow: 0 4px 16px rgba(0,0,0,0.2); display: none;
  border-left: 4px solid #28a745;
}

.assigned-license {
  border: 1px solid #28a745; border-radius: 4px; padding: 16px;
  background: #f8fff8; margin-bottom: 12px;
}
.license-name {
  font-weight: 600; color: #155724; margin-bottom: 4px;
}
.license-status {
  font-size: 13px; color: #6c757d;
}

.loading {
  display: inline-block; width: 20px; height: 20px; border: 2px solid #f3f3f3;
  border-top: 2px solid #0078d4; border-radius: 50%; animation: spin 1s linear infinite;
}
@keyframes spin { to { transform: rotate(360deg); } }
</style>
</head>
<body>
<div class="task-instructions">
  <div class="task-title">Lab: Entra ID - Assign Microsoft 365 License</div>
  <div class="task-description">
    <strong>Goal:</strong> Assign a <strong>Microsoft 365 Business Premium</strong> license to <strong>Jane Smith</strong> who currently has "Unlicensed" status.
    <ol>
      <li>Click on <strong>Azure Active Directory</strong> in the left navigation.</li>
      <li>Locate <strong>Jane Smith</strong> in the user list (status: Unlicensed).</li>
      <li>Click on <strong>Jane Smith</strong> to open her user profile.</li>
      <li>Click the <strong>Licenses</strong> tab.</li>
      <li>Click <strong>+ Assign licenses</strong> button.</li>
      <li>Select <strong>Microsoft 365 Business Premium</strong> license.</li>
      <li>Click <strong>Assign</strong> and observe the success notification.</li>
    </ol>
  </div>
</div>

<div class="lab-container">
  <div class="azure-header">
    <div class="logo">üåê Microsoft Azure</div>
    <input class="search" placeholder="Search resources, services, and docs">
  </div>

  <div class="azure-nav">
    <div class="nav-item">
      <span class="icon">üè†</span>Home
    </div>
    <div class="nav-item">
      <span class="icon">üìä</span>Dashboard
    </div>
    <div class="nav-item">
      <span class="icon">üí∞</span>Cost Management
    </div>
    <div class="nav-item active" id="aadNav">
      <span class="icon">üë•</span>Azure Active Directory
    </div>
    <div class="nav-item">
      <span class="icon">üîê</span>Security Center
    </div>
    <div class="nav-item">
      <span class="icon">üíæ</span>Storage accounts
    </div>
    <div class="nav-item">
      <span class="icon">üñ•Ô∏è</span>Virtual machines
    </div>
  </div>

  <div class="main-content" id="mainContent">
    <div class="content-header">
      <div class="content-title">Azure Active Directory</div>
      <div class="content-subtitle">Contoso | Default Directory</div>
    </div>

    <div class="user-list">
      <div class="search-box">
        <input type="text" placeholder="Search users" id="userSearch">
      </div>

      <table class="user-table">
        <thead>
          <tr>
            <th>Display Name</th>
            <th>User Principal Name</th>
            <th>Status</th>
            <th>Department</th>
          </tr>
        </thead>
        <tbody id="userTableBody">
          <tr data-user="john.admin">
            <td>John Admin</td>
            <td>john.admin@contoso.com</td>
            <td><span class="status-badge status-active">Active</span></td>
            <td>IT Administration</td>
          </tr>
          <tr data-user="jane.smith">
            <td>Jane Smith</td>
            <td>jane.smith@contoso.com</td>
            <td><span class="status-badge status-unlicensed">Unlicensed</span></td>
            <td>Marketing</td>
          </tr>
          <tr data-user="mike.sales">
            <td>Mike Sales</td>
            <td>mike.sales@contoso.com</td>
            <td><span class="status-badge status-active">Active</span></td>
            <td>Sales</td>
          </tr>
          <tr data-user="sarah.hr">
            <td>Sarah HR</td>
            <td>sarah.hr@contoso.com</td>
            <td><span class="status-badge status-active">Active</span></td>
            <td>Human Resources</td>
          </tr>
          <tr data-user="bob.dev">
            <td>Bob Developer</td>
            <td>bob.dev@contoso.com</td>
            <td><span class="status-badge status-unlicensed">Unlicensed</span></td>
            <td>Development</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <div class="user-detail" id="userDetail">
    <div class="detail-header">
      <button class="back-btn" id="backBtn">‚Üê Back to users</button>
      <div class="detail-title" id="detailTitle">Jane Smith</div>
    </div>

    <div class="detail-tabs">
      <div class="tab active" data-tab="profile">Profile</div>
      <div class="tab" data-tab="licenses">Licenses</div>
      <div class="tab" data-tab="groups">Groups</div>
      <div class="tab" data-tab="roles">Roles</div>
    </div>

    <div class="tab-content">
      <div id="profileTab" class="tab-panel">
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 24px;">
          <div>
            <h3 style="margin-bottom: 16px;">Basic Information</h3>
            <div style="margin-bottom: 12px;"><strong>Display Name:</strong> Jane Smith</div>
            <div style="margin-bottom: 12px;"><strong>User Principal Name:</strong> jane.smith@contoso.com</div>
            <div style="margin-bottom: 12px;"><strong>Email:</strong> jane.smith@contoso.com</div>
            <div style="margin-bottom: 12px;"><strong>Department:</strong> Marketing</div>
          </div>
          <div>
            <h3 style="margin-bottom: 16px;">Account Status</h3>
            <div style="margin-bottom: 12px;"><strong>Status:</strong> <span class="status-badge status-unlicensed" id="userStatus">Unlicensed</span></div>
            <div style="margin-bottom: 12px;"><strong>Created:</strong> 2024-12-01</div>
            <div style="margin-bottom: 12px;"><strong>Last Sign In:</strong> Never</div>
          </div>
        </div>
      </div>

      <div id="licensesTab" class="tab-panel" style="display: none;">
        <div class="license-section">
          <div class="license-header">
            <div>
              <h3>Assigned Licenses</h3>
              <p style="color: #6c757d; margin-top: 4px;" id="licenseDescription">This user currently has no licenses assigned.</p>
            </div>
            <button class="assign-btn" id="assignLicenseBtn">+ Assign licenses</button>
          </div>
          <div id="assignedLicenses"></div>
        </div>
      </div>

      <div id="groupsTab" class="tab-panel" style="display: none;">
        <p>No groups assigned</p>
      </div>

      <div id="rolesTab" class="tab-panel" style="display: none;">
        <p>No roles assigned</p>
      </div>
    </div>
  </div>

  <div class="license-modal" id="licenseModal">
    <div class="modal-content">
      <div class="modal-header">
        Assign licenses to Jane Smith
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label class="form-label">License location</label>
          <select class="form-select">
            <option>United States</option>
          </select>
        </div>

        <div class="form-group">
          <label class="form-label">License plans</label>
          
          <div class="license-plan" data-license="m365bp">
            <div class="plan-header">
              <input type="checkbox" id="m365bp">
              <label for="m365bp" style="flex: 1; cursor: pointer;">
                <div style="font-weight: 600;">Microsoft 365 Business Premium</div>
                <div style="font-size: 13px; color: #6c757d;">Includes Office apps, email, file storage, meetings, and advanced security</div>
              </label>
            </div>
            <div class="plan-details" id="m365bpDetails">
              <div style="margin-bottom: 12px; font-weight: 600;">Included services:</div>
              <div class="service-plans">
                <div class="service-item">
                  <input type="checkbox" checked disabled>
                  <span>Exchange Online (Plan 2)</span>
                </div>
                <div class="service-item">
                  <input type="checkbox" checked disabled>
                  <span>Microsoft Teams</span>
                </div>
                <div class="service-item">
                  <input type="checkbox" checked disabled>
                  <span>SharePoint Online (Plan 2)</span>
                </div>
                <div class="service-item">
                  <input type="checkbox" checked disabled>
                  <span>OneDrive for Business (Plan 2)</span>
                </div>
                <div class="service-item">
                  <input type="checkbox" checked disabled>
                  <span>Microsoft 365 Apps for business</span>
                </div>
                <div class="service-item">
                  <input type="checkbox" checked disabled>
                  <span>Microsoft Defender for Office 365</span>
                </div>
                <div class="service-item">
                  <input type="checkbox" checked>
                  <span>Microsoft Intune</span>
                </div>
                <div class="service-item">
                  <input type="checkbox" checked>
                  <span>Azure Information Protection</span>
                </div>
              </div>
            </div>
          </div>

          <div class="license-plan" data-license="o365e3">
            <div class="plan-header">
              <input type="checkbox" id="o365e3">
              <label for="o365e3" style="flex: 1; cursor: pointer;">
                <div style="font-weight: 600;">Office 365 E3</div>
                <div style="font-size: 13px; color: #6c757d;">Core productivity and collaboration tools</div>
              </label>
            </div>
          </div>

          <div class="license-plan" data-license="exonline">
            <div class="plan-header">
              <input type="checkbox" id="exonline">
              <label for="exonline" style="flex: 1; cursor: pointer;">
                <div style="font-weight: 600;">Exchange Online Plan 2</div>
                <div style="font-size: 13px; color: #6c757d;">Email and calendaring only</div>
              </label>
            </div>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn" id="cancelAssign">Cancel</button>
        <button class="btn btn-primary" id="confirmAssign" disabled>Assign</button>
      </div>
    </div>
  </div>

  <div class="success-toast" id="successToast">
    ‚úÖ License successfully assigned to Jane Smith
  </div>
</div>

<script>
// State management
let currentUser = null;

// Navigation
document.getElementById('aadNav').addEventListener('click', () => {
  document.getElementById('userDetail').style.display = 'none';
  document.getElementById('mainContent').style.display = 'block';
});

// User table interaction
document.getElementById('userTableBody').addEventListener('click', (e) => {
  const row = e.target.closest('tr');
  if (!row) return;
  
  const userId = row.getAttribute('data-user');
  if (userId === 'jane.smith') {
    showUserDetail(userId);
  }
});

// Back button
document.getElementById('backBtn').addEventListener('click', () => {
  document.getElementById('userDetail').style.display = 'none';
  document.getElementById('mainContent').style.display = 'block';
});

// Tab switching
document.querySelectorAll('.tab').forEach(tab => {
  tab.addEventListener('click', () => {
    const tabId = tab.getAttribute('data-tab');
    
    // Update active tab
    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
    tab.classList.add('active');
    
    // Show corresponding panel
    document.querySelectorAll('.tab-panel').forEach(panel => {
      panel.style.display = 'none';
    });
    document.getElementById(tabId + 'Tab').style.display = 'block';
  });
});

// License assignment
document.getElementById('assignLicenseBtn').addEventListener('click', () => {
  document.getElementById('licenseModal').style.display = 'flex';
});

// License plan selection
document.querySelectorAll('.license-plan').forEach(plan => {
  const checkbox = plan.querySelector('input[type="checkbox"]');
  const header = plan.querySelector('.plan-header');
  
  header.addEventListener('click', (e) => {
    if (e.target.tagName !== 'INPUT') {
      checkbox.checked = !checkbox.checked;
      updateLicensePlan(plan, checkbox.checked);
    } else {
      updateLicensePlan(plan, checkbox.checked);
    }
  });
  
  checkbox.addEventListener('change', () => {
    updateLicensePlan(plan, checkbox.checked);
  });
});

function updateLicensePlan(plan, selected) {
  plan.classList.toggle('selected', selected);
  plan.querySelector('.plan-details').classList.toggle('show', selected);
  
  // Update assign button state
  const anySelected = document.querySelectorAll('.license-plan input[type="checkbox"]:checked').length > 0;
  document.getElementById('confirmAssign').disabled = !anySelected;
}

// Modal controls
document.getElementById('cancelAssign').addEventListener('click', () => {
  document.getElementById('licenseModal').style.display = 'none';
  resetModal();
});

document.getElementById('confirmAssign').addEventListener('click', () => {
  const selectedLicense = document.querySelector('.license-plan input[type="checkbox"]:checked');
  if (selectedLicense) {
    assignLicense(selectedLicense.id);
  }
});

function showUserDetail(userId) {
  if (userId === 'jane.smith') {
    currentUser = 'jane.smith';
    document.getElementById('mainContent').style.display = 'none';
    document.getElementById('userDetail').style.display = 'block';
  }
}

function assignLicense(licenseType) {
  // Show loading state
  document.getElementById('confirmAssign').innerHTML = '<span class="loading"></span> Assigning...';
  document.getElementById('confirmAssign').disabled = true;
  
  setTimeout(() => {
    // Update user status
    updateUserStatus('active');
    
    // Show assigned license
    showAssignedLicense(licenseType);
    
    // Close modal
    document.getElementById('licenseModal').style.display = 'none';
    
    // Show success toast
    showSuccessToast();
    
    // Reset modal
    resetModal();
  }, 2000);
}

function updateUserStatus(status) {
  const statusElement = document.getElementById('userStatus');
  const tableRow = document.querySelector('[data-user="jane.smith"] .status-badge');
  
  if (status === 'active') {
    statusElement.className = 'status-badge status-active';
    statusElement.textContent = 'Active';
    tableRow.className = 'status-badge status-active';
    tableRow.textContent = 'Active';
  }
}

function showAssignedLicense(licenseType) {
  const container = document.getElementById('assignedLicenses');
  const description = document.getElementById('licenseDescription');
  
  let licenseName = '';
  switch(licenseType) {
    case 'm365bp':
      licenseName = 'Microsoft 365 Business Premium';
      break;
    case 'o365e3':
      licenseName = 'Office 365 E3';
      break;
    case 'exonline':
      licenseName = 'Exchange Online Plan 2';
      break;
  }
  
  container.innerHTML = `
    <div class="assigned-license">
      <div class="license-name">${licenseName}</div>
      <div class="license-status">Status: Active | Assignment: Direct</div>
    </div>
  `;
  
  description.textContent = 'This user has the following licenses assigned.';
}

function showSuccessToast() {
  const toast = document.getElementById('successToast');
  toast.style.display = 'block';
  setTimeout(() => {
    toast.style.display = 'none';
  }, 4000);
}

function resetModal() {
  document.querySelectorAll('.license-plan input[type="checkbox"]').forEach(cb => {
    cb.checked = false;
  });
  document.querySelectorAll('.license-plan').forEach(plan => {
    plan.classList.remove('selected');
    plan.querySelector('.plan-details').classList.remove('show');
  });
  document.getElementById('confirmAssign').innerHTML = 'Assign';
  document.getElementById('confirmAssign').disabled = true;
}

// Search functionality
document.getElementById('userSearch').addEventListener('input', (e) => {
  const searchTerm = e.target.value.toLowerCase();
  const rows = document.querySelectorAll('#userTableBody tr');
  
  rows.forEach(row => {
    const name = row.querySelector('td').textContent.toLowerCase();
    const email = row.querySelectorAll('td')[1].textContent.toLowerCase();
    const visible = name.includes(searchTerm) || email.includes(searchTerm);
    row.style.display = visible ? '' : 'none';
  });
});

// Highlight Jane Smith row initially
setTimeout(() => {
  const janeRow = document.querySelector('[data-user="jane.smith"]');
  janeRow.style.background = '#fff3cd';
  setTimeout(() => {
    janeRow.style.background = '';
  }, 3000);
}, 1000);
</script>
</body>
</html>