<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Windows 11 - End Unresponsive Application (Lab Simulation)</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
/* ========== WINDOWS 11 23H2+ REALISTIC THEME ========== */
:root {
  /* Windows 11 Accent Colors */
  --win-accent: #0078D4;
  --win-accent-hover: #106EBE;
  --win-accent-light: #E3F2FD;
  --win-danger: #D13438;
  --win-danger-hover: #C42B1C;
  --win-warning: #FFB900;
  --win-success: #107C10;
  
  /* Backgrounds */
  --win-bg: rgba(255, 255, 255, 0.88);
  --win-bg-solid: #FFFFFF;
  --win-bg-mica: rgba(255, 255, 255, 0.72);
  --win-bg-acrylic: rgba(255, 255, 255, 0.64);
  --win-taskbar: rgba(32, 32, 32, 0.94);
  --win-start-menu: rgba(36, 36, 38, 0.98);
  --win-context-menu: rgba(40, 40, 42, 0.98);
  
  /* Borders & Shadows */
  --win-border: rgba(0, 0, 0, 0.08);
  --win-border-heavy: rgba(0, 0, 0, 0.12);
  --win-border-light: rgba(255, 255, 255, 0.2);
  --win-shadow: rgba(0, 0, 0, 0.12);
  --win-shadow-heavy: rgba(0, 0, 0, 0.24);
  
  /* Text Colors */
  --win-text: #000000;
  --win-text-secondary: #616161;
  --win-text-tertiary: #8A8A8A;
  --win-text-inverse: #FFFFFF;
  
  /* Interactive States */
  --win-hover: rgba(0, 0, 0, 0.04);
  --win-pressed: rgba(0, 0, 0, 0.08);
  --win-selected: rgba(0, 120, 212, 0.12);
  --win-focus: rgba(0, 120, 212, 0.2);
}

/* ========== BASE RESET & TYPOGRAPHY ========== */
* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
  -webkit-tap-highlight-color: transparent;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

html, body {
  height: 100%;
  overflow: hidden;
  font-family: "Segoe UI Variable", "Segoe UI", system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
  font-size: 13.5px;
  font-weight: 400;
  line-height: 1.4;
  letter-spacing: -0.08px;
}

body {
  background: 
    radial-gradient(circle at 15% 85%, rgba(120, 119, 198, 0.15) 0%, transparent 35%),
    radial-gradient(circle at 85% 15%, rgba(255, 119, 198, 0.1) 0%, transparent 35%),
    linear-gradient(155deg, #1A1F35 0%, #2D2F45 30%, #3A3F55 70%, #2A2F45 100%);
  color: var(--win-text);
  position: relative;
  overflow: hidden;
  cursor: default;
}

/* ========== DESKTOP ========== */
#desktop {
  position: absolute;
  inset: 0 0 48px 0;
  padding: 24px;
  overflow: hidden;
  pointer-events: none;
}

.desktop-icon {
  position: absolute;
  width: 86px;
  height: 86px;
  color: #FFFFFF;
  text-align: center;
  cursor: pointer;
  user-select: none;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 6px;
  border-radius: 6px;
  padding: 10px 6px;
  pointer-events: auto;
  transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
  filter: drop-shadow(0 2px 8px rgba(0, 0, 0, 0.3));
}

.desktop-icon:hover {
  background-color: rgba(255, 255, 255, 0.12);
  transform: translateY(-2px);
  filter: drop-shadow(0 4px 12px rgba(0, 0, 0, 0.4));
}

.desktop-icon:active {
  background-color: rgba(255, 255, 255, 0.18);
  transform: translateY(0);
  transition-duration: 0.1s;
}

.desktop-icon.selected {
  background-color: rgba(0, 120, 212, 0.24);
  color: #FFFFFF;
}

.desktop-icon .icon {
  font-size: 42px;
  width: 42px;
  height: 42px;
  display: flex;
  align-items: center;
  justify-content: center;
  margin-bottom: 2px;
}

.desktop-icon .label {
  font-size: 11.5px;
  font-weight: 450;
  padding: 3px 8px;
  border-radius: 4px;
  max-width: 100%;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(8px);
  -webkit-backdrop-filter: blur(8px);
}

/* ========== TASKBAR ========== */
.taskbar {
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  height: 48px;
  background: var(--win-taskbar);
  backdrop-filter: saturate(180%) blur(40px);
  -webkit-backdrop-filter: saturate(180%) blur(40px);
  border-top: 1px solid rgba(255, 255, 255, 0.08);
  display: flex;
  align-items: center;
  z-index: 10000;
  padding: 0 12px;
}

.taskbar-center {
  flex: 1;
  display: flex;
  justify-content: center;
  gap: 4px;
  align-items: center;
  margin: 0 auto;
  max-width: 520px;
}

.start-button {
  width: 44px;
  height: 44px;
  border-radius: 8px;
  background: rgba(255, 255, 255, 0.08);
  display: grid;
  place-items: center;
  cursor: pointer;
  transition: all 0.22s cubic-bezier(0.4, 0, 0.2, 1);
  border: none;
  outline: none;
  position: relative;
}

.start-button:hover {
  background: rgba(255, 255, 255, 0.16);
  transform: translateY(-1px);
}

.start-button:active {
  transform: scale(0.94);
  background: rgba(255, 255, 255, 0.22);
  transition-duration: 0.1s;
}

.start-button svg {
  width: 24px;
  height: 24px;
  fill: #FFFFFF;
  transition: transform 0.2s;
}

.start-button:hover svg {
  transform: scale(1.08);
}

.taskbar-icon {
  width: 44px;
  height: 44px;
  border-radius: 8px;
  background: rgba(255, 255, 255, 0.06);
  display: grid;
  place-items: center;
  cursor: pointer;
  transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
  font-size: 17px;
  color: rgba(255, 255, 255, 0.9);
  position: relative;
}

.taskbar-icon:hover {
  background: rgba(255, 255, 255, 0.14);
  transform: translateY(-1px);
  color: #FFFFFF;
}

.taskbar-icon.active {
  background: rgba(255, 255, 255, 0.2);
  color: #FFFFFF;
}

.taskbar-icon.active::after {
  content: '';
  position: absolute;
  bottom: 4px;
  left: 50%;
  transform: translateX(-50%);
  width: 4px;
  height: 4px;
  border-radius: 50%;
  background: var(--win-accent);
}

.taskbar-icon .badge {
  position: absolute;
  top: 4px;
  right: 4px;
  width: 6px;
  height: 6px;
  border-radius: 50%;
  background: var(--win-accent);
  border: 1px solid var(--win-taskbar);
}

/* ========== SYSTEM TRAY ========== */
.system-tray {
  position: absolute;
  right: 12px;
  display: flex;
  align-items: center;
  height: 100%;
  gap: 6px;
}

.tray-group {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 0 10px;
  height: 32px;
  background: rgba(255, 255, 255, 0.08);
  border-radius: 6px;
  border: 1px solid rgba(255, 255, 255, 0.15);
  cursor: pointer;
  transition: all 0.2s;
  position: relative;
}

.tray-group:hover {
  background: rgba(255, 255, 255, 0.14);
}

.tray-group:active {
  background: rgba(255, 255, 255, 0.2);
  transition-duration: 0.1s;
}

.tray-time {
  display: flex;
  flex-direction: column;
  align-items: center;
  line-height: 1.2;
  color: rgba(255, 255, 255, 0.95);
  font-size: 11px;
  font-weight: 450;
  min-width: 64px;
}

.tray-time #currentTime {
  font-size: 11px;
  font-weight: 500;
  letter-spacing: 0.2px;
}

.tray-time #currentDate {
  font-size: 10px;
  opacity: 0.85;
}

/* ========== WINDOWS ========== */
.window, .unresponsive-window {
  position: absolute;
  background: var(--win-bg);
  backdrop-filter: blur(40px) saturate(180%);
  -webkit-backdrop-filter: blur(40px) saturate(180%);
  border-radius: 10px;
  box-shadow: 
    0 0 0 1px var(--win-border),
    0 12px 48px var(--win-shadow-heavy);
  overflow: hidden;
  display: flex;
  flex-direction: column;
  z-index: 100;
  border: 1px solid rgba(255, 255, 255, 0.25);
  transition: box-shadow 0.3s, transform 0.3s;
  animation: windowAppear 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

.window:hover {
  box-shadow: 
    0 0 0 1px var(--win-border),
    0 16px 56px rgba(0, 0, 0, 0.28);
}

.window.maximized {
  border-radius: 0;
  border: none;
  box-shadow: none;
}

@keyframes windowAppear {
  from {
    opacity: 0;
    transform: scale(0.95) translateY(8px);
  }
  to {
    opacity: 1;
    transform: scale(1) translateY(0);
  }
}

.window-header {
  height: 42px;
  background: transparent;
  display: flex;
  align-items: center;
  padding: 0 12px;
  user-select: none;
  cursor: move;
  border-bottom: 1px solid var(--win-border);
  position: relative;
}

.window-title {
  font-weight: 500;
  font-size: 13px;
  flex: 1;
  margin-left: 10px;
  color: var(--win-text);
  display: flex;
  align-items: center;
  gap: 10px;
  overflow: hidden;
}

.window-title .app-icon {
  font-size: 16px;
  width: 20px;
  height: 20px;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
}

.window-title .app-name {
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.window-controls {
  display: flex;
  gap: 8px;
  align-items: center;
}

.window-control {
  width: 12px;
  height: 12px;
  border-radius: 50%;
  transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 8px;
  color: rgba(0, 0, 0, 0.6);
  font-weight: 700;
  position: relative;
  overflow: hidden;
}

.window-control::before {
  content: '';
  position: absolute;
  inset: 0;
  background: currentColor;
  opacity: 0;
  transition: opacity 0.2s;
}

.window-control:hover::before {
  opacity: 0.1;
}

.window-control.minimize { background: #FFBD44; }
.window-control.maximize { background: #00CA4E; }
.window-control.close { background: #FF605C; }

.window-control:hover {
  transform: scale(1.2);
}

.window-control.close:hover {
  background: #FF5F57;
  color: #000000;
}

.window-body {
  flex: 1;
  overflow: auto;
  background: transparent;
  padding: 20px;
  position: relative;
}

/* Window Resize Handles */
.window-resize {
  position: absolute;
  z-index: 10;
}

.window-resize.n { top: 0; left: 5px; right: 5px; height: 5px; cursor: n-resize; }
.window-resize.s { bottom: 0; left: 5px; right: 5px; height: 5px; cursor: s-resize; }
.window-resize.e { top: 5px; right: 0; bottom: 5px; width: 5px; cursor: e-resize; }
.window-resize.w { top: 5px; left: 0; bottom: 5px; width: 5px; cursor: w-resize; }
.window-resize.ne { top: 0; right: 0; width: 10px; height: 10px; cursor: ne-resize; }
.window-resize.nw { top: 0; left: 0; width: 10px; height: 10px; cursor: nw-resize; }
.window-resize.se { bottom: 0; right: 0; width: 10px; height: 10px; cursor: se-resize; }
.window-resize.sw { bottom: 0; left: 0; width: 10px; height: 10px; cursor: sw-resize; }

/* ========== UNRESPONSIVE WINDOW ========== */
.unresponsive-window {
  animation: unresponsiveShake 4s infinite ease-in-out, unresponsivePulse 3s infinite ease-in-out;
  filter: saturate(0.9) brightness(0.98);
}

.unresponsive-window .window-header {
  background: linear-gradient(to right, rgba(255, 235, 238, 0.9), rgba(255, 245, 245, 0.9));
  border-bottom: 1px solid rgba(255, 192, 203, 0.3);
}

.unresponsive-window .window-controls .window-control {
  filter: grayscale(0.7) brightness(0.9);
}

.unresponsive-overlay {
  position: absolute;
  inset: 0;
  background: rgba(255, 255, 255, 0.92);
  backdrop-filter: blur(3px) grayscale(0.3);
  -webkit-backdrop-filter: blur(3px) grayscale(0.3);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  color: var(--win-danger);
  font-weight: 600;
  font-size: 13px;
  pointer-events: none;
  z-index: 10;
  animation: overlayPulse 2s infinite ease-in-out;
}

.unresponsive-overlay::before {
  content: "‚è≥";
  font-size: 36px;
  margin-bottom: 14px;
  opacity: 0.9;
  animation: hourglassSpin 3s infinite linear;
}

.unresponsive-overlay::after {
  content: '';
  position: absolute;
  inset: 0;
  background: linear-gradient(45deg, transparent 48%, rgba(255, 0, 0, 0.03) 50%, transparent 52%);
  background-size: 200% 200%;
  animation: scanLine 4s infinite linear;
}

@keyframes unresponsiveShake {
  0%, 100% { transform: translateX(0) translateY(0) rotate(0); }
  15% { transform: translateX(-1px) translateY(0.5px) rotate(-0.05deg); }
  30% { transform: translateX(0.8px) translateY(-0.3px) rotate(0.03deg); }
  45% { transform: translateX(-0.6px) translateY(-0.2px) rotate(-0.02deg); }
  60% { transform: translateX(0.4px) translateY(0.1px) rotate(0.01deg); }
  75% { transform: translateX(-0.2px) translateY(0px) rotate(-0.005deg); }
}

@keyframes unresponsivePulse {
  0%, 100% { box-shadow: 0 0 0 1px var(--win-border), 0 12px 48px rgba(0, 0, 0, 0.2); }
  50% { box-shadow: 0 0 0 1px rgba(212, 52, 56, 0.3), 0 12px 48px rgba(212, 52, 56, 0.1); }
}

@keyframes hourglassSpin {
  0% { transform: rotate(0deg); }
  25% { transform: rotate(90deg); }
  50% { transform: rotate(180deg); }
  75% { transform: rotate(270deg); }
  100% { transform: rotate(360deg); }
}

@keyframes scanLine {
  0% { background-position: 200% 200%; }
  100% { background-position: -200% -200%; }
}

@keyframes overlayPulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.95; }
}

/* ========== START MENU ========== */
.start-menu {
  position: absolute;
  bottom: 56px;
  left: 50%;
  transform: translateX(-50%);
  width: 660px;
  height: 560px;
  background: var(--win-start-menu);
  backdrop-filter: blur(48px) saturate(200%);
  -webkit-backdrop-filter: blur(48px) saturate(200%);
  border-radius: 10px;
  box-shadow: 
    0 0 0 1px rgba(255, 255, 255, 0.12),
    0 32px 64px rgba(0, 0, 0, 0.5),
    0 2px 8px rgba(0, 0, 0, 0.1) inset;
  display: none;
  overflow: hidden;
  z-index: 9999;
  animation: startMenuAppear 0.25s cubic-bezier(0.4, 0, 0.2, 1);
  border: 1px solid rgba(255, 255, 255, 0.15);
}

@keyframes startMenuAppear {
  from {
    opacity: 0;
    transform: translateX(-50%) translateY(10px) scale(0.98);
  }
  to {
    opacity: 1;
    transform: translateX(-50%) translateY(0) scale(1);
  }
}

.start-menu-header {
  height: 56px;
  background: rgba(255, 255, 255, 0.06);
  padding: 0 24px;
  display: flex;
  align-items: center;
  font-weight: 500;
  font-size: 14px;
  color: #FFFFFF;
  border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}

.start-menu-body {
  display: grid;
  grid-template-columns: 1fr 280px;
  height: calc(100% - 56px);
}

.start-menu-left {
  padding: 24px;
  overflow-y: auto;
}

.pinned-section-title {
  color: rgba(255, 255, 255, 0.8);
  font-size: 12px;
  font-weight: 500;
  margin-bottom: 16px;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.pinned-apps {
  display: grid;
  grid-template-columns: repeat(6, 1fr);
  gap: 12px;
  margin-bottom: 32px;
}

.pinned-tile {
  width: 72px;
  height: 72px;
  background: rgba(255, 255, 255, 0.08);
  border-radius: 8px;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  color: #FFFFFF;
  font-size: 11px;
  transition: all 0.22s cubic-bezier(0.4, 0, 0.2, 1);
  cursor: pointer;
  border: 1px solid transparent;
  position: relative;
  overflow: hidden;
}

.pinned-tile:hover {
  background: rgba(255, 255, 255, 0.16);
  border-color: rgba(255, 255, 255, 0.2);
  transform: translateY(-3px);
  box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
}

.pinned-tile:active {
  transform: translateY(-1px);
  transition-duration: 0.1s;
}

.pinned-tile .icon {
  font-size: 26px;
  margin-bottom: 6px;
}

.recommended-section {
  margin-top: 32px;
}

.recommended-item {
  display: flex;
  align-items: center;
  gap: 16px;
  padding: 12px 16px;
  border-radius: 8px;
  cursor: pointer;
  transition: background-color 0.2s;
  margin-bottom: 4px;
}

.recommended-item:hover {
  background: rgba(255, 255, 255, 0.08);
}

.recommended-item .icon {
  width: 40px;
  height: 40px;
  border-radius: 6px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 20px;
  background: rgba(255, 255, 255, 0.1);
}

.recommended-item .details {
  flex: 1;
}

.recommended-item .title {
  font-weight: 500;
  color: #FFFFFF;
  margin-bottom: 2px;
}

.recommended-item .subtitle {
  font-size: 11px;
  color: rgba(255, 255, 255, 0.7);
}

.start-menu-right {
  background: rgba(0, 0, 0, 0.2);
  padding: 24px;
  border-left: 1px solid rgba(255, 255, 255, 0.08);
}

.power-section {
  margin-bottom: 32px;
}

.power-section-title {
  color: rgba(255, 255, 255, 0.8);
  font-size: 12px;
  font-weight: 500;
  margin-bottom: 12px;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.power-button {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 12px 16px;
  border-radius: 8px;
  cursor: pointer;
  transition: background-color 0.2s;
  margin-bottom: 4px;
}

.power-button:hover {
  background: rgba(255, 255, 255, 0.08);
}

.power-button .icon {
  font-size: 18px;
  width: 24px;
  text-align: center;
}

.power-button .label {
  font-weight: 450;
  color: #FFFFFF;
}

/* ========== CONTEXT MENU ========== */
.context-menu {
  position: absolute;
  background: var(--win-context-menu);
  backdrop-filter: blur(40px) saturate(180%);
  -webkit-backdrop-filter: blur(40px) saturate(180%);
  border-radius: 8px;
  box-shadow: 
    0 0 0 1px rgba(255, 255, 255, 0.12),
    0 16px 32px rgba(0, 0, 0, 0.4);
  display: none;
  overflow: hidden;
  z-index: 10001;
  min-width: 240px;
  border: 1px solid rgba(255, 255, 255, 0.15);
  animation: contextMenuAppear 0.15s cubic-bezier(0.4, 0, 0.2, 1);
}

@keyframes contextMenuAppear {
  from {
    opacity: 0;
    transform: scale(0.95) translateY(-4px);
  }
  to {
    opacity: 1;
    transform: scale(1) translateY(0);
  }
}

.context-menu-item {
  padding: 10px 16px;
  display: flex;
  align-items: center;
  gap: 12px;
  font-size: 13px;
  color: rgba(255, 255, 255, 0.95);
  cursor: pointer;
  transition: background-color 0.15s;
  border-bottom: 1px solid rgba(255, 255, 255, 0.05);
  position: relative;
}

.context-menu-item:last-child {
  border-bottom: none;
}

.context-menu-item:hover {
  background: rgba(255, 255, 255, 0.12);
}

.context-menu-item:active {
  background: rgba(255, 255, 255, 0.18);
  transition-duration: 0.1s;
}

.context-menu-item .icon {
  font-size: 16px;
  width: 20px;
  text-align: center;
  color: rgba(255, 255, 255, 0.9);
}

.context-menu-item .shortcut {
  margin-left: auto;
  font-size: 11px;
  color: rgba(255, 255, 255, 0.5);
  font-weight: 450;
}

.context-menu-divider {
  height: 1px;
  background: rgba(255, 255, 255, 0.08);
  margin: 4px 0;
}

/* ========== TASK MANAGER ========== */
.task-manager-tabs {
  display: flex;
  background: linear-gradient(to bottom, #F8F8F8, #F0F0F0);
  border-bottom: 1px solid #E5E5E5;
  height: 42px;
  padding: 0 12px;
  gap: 4px;
}

.task-manager-tab {
  padding: 0 18px;
  display: flex;
  align-items: center;
  cursor: pointer;
  font-size: 13px;
  color: var(--win-text-secondary);
  border-bottom: 2px solid transparent;
  transition: all 0.2s;
  position: relative;
  font-weight: 450;
  white-space: nowrap;
}

.task-manager-tab:hover {
  color: var(--win-text);
  background: rgba(0, 0, 0, 0.04);
}

.task-manager-tab.active {
  color: var(--win-accent);
  border-bottom-color: var(--win-accent);
  font-weight: 500;
}

.task-manager-tab.active::after {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 1px;
  background: linear-gradient(to right, transparent, rgba(0, 120, 212, 0.2), transparent);
}

.process-list-container {
  height: calc(100% - 42px);
  overflow: hidden;
  display: flex;
  flex-direction: column;
}

.process-list {
  width: 100%;
  border-collapse: collapse;
  font-size: 12.5px;
  flex: 1;
}

.process-list thead {
  position: sticky;
  top: 0;
  background: #F8F8F8;
  z-index: 2;
  box-shadow: 0 1px 0 #E5E5E5;
}

.process-list th {
  padding: 14px 16px;
  text-align: left;
  font-weight: 500;
  color: var(--win-text);
  border-bottom: 1px solid #E5E5E5;
  background: #F8F8F8;
  position: relative;
  user-select: none;
  transition: background-color 0.2s;
}

.process-list th:hover {
  background: #F0F0F0;
}

.process-list th.sortable {
  cursor: pointer;
}

.process-list th.sortable::after {
  content: '‚Üï';
  margin-left: 6px;
  font-size: 10px;
  opacity: 0.4;
}

.process-list th.sorted-asc::after {
  content: '‚Üë';
  opacity: 0.8;
}

.process-list th.sorted-desc::after {
  content: '‚Üì';
  opacity: 0.8;
}

.process-list tbody tr {
  border-bottom: 1px solid #F0F0F0;
  transition: background-color 0.15s;
  animation: rowAppear 0.3s ease-out;
  animation-fill-mode: both;
}

@keyframes rowAppear {
  from {
    opacity: 0;
    transform: translateX(-4px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

.process-list tbody tr:hover {
  background: var(--win-hover);
}

.process-list tbody tr.selected {
  background: var(--win-selected);
  color: var(--win-accent);
  position: relative;
}

.process-list tbody tr.selected::before {
  content: '';
  position: absolute;
  left: 0;
  top: 0;
  bottom: 0;
  width: 3px;
  background: var(--win-accent);
}

.process-list tbody tr.unresponsive {
  background: linear-gradient(to right, rgba(255, 235, 238, 0.1), rgba(255, 245, 245, 0.05));
  color: var(--win-danger);
  font-weight: 500;
  position: relative;
  animation: unresponsiveRowPulse 2s infinite ease-in-out;
}

.process-list tbody tr.unresponsive:hover {
  background: linear-gradient(to right, rgba(255, 235, 238, 0.2), rgba(255, 245, 245, 0.1));
}

@keyframes unresponsiveRowPulse {
  0%, 100% { background: linear-gradient(to right, rgba(255, 235, 238, 0.1), rgba(255, 245, 245, 0.05)); }
  50% { background: linear-gradient(to right, rgba(255, 235, 238, 0.15), rgba(255, 245, 245, 0.08)); }
}

.process-list td {
  padding: 12px 16px;
  position: relative;
}

.process-list .process-icon {
  width: 16px;
  height: 16px;
  margin-right: 10px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  vertical-align: middle;
  font-size: 14px;
}

.process-list .process-name {
  display: inline-flex;
  align-items: center;
  vertical-align: middle;
}

.process-list .process-name .pid {
  font-size: 11px;
  color: var(--win-text-tertiary);
  margin-left: 8px;
  font-family: 'Consolas', 'Monaco', monospace;
}

.process-actions {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 16px 20px;
  background: #F8F8F8;
  border-top: 1px solid #E5E5E5;
  box-shadow: 0 -1px 0 rgba(0, 0, 0, 0.05);
}

.end-task-btn {
  background: linear-gradient(to bottom, var(--win-danger), #C42B1C);
  color: white;
  border: none;
  padding: 10px 24px;
  border-radius: 6px;
  font-size: 13px;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
  display: inline-flex;
  align-items: center;
  gap: 8px;
  box-shadow: 
    0 2px 4px rgba(212, 52, 56, 0.3),
    0 0 0 1px rgba(255, 255, 255, 0.1) inset;
  position: relative;
  overflow: hidden;
}

.end-task-btn::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
  transition: left 0.6s;
}

.end-task-btn:hover:not(:disabled) {
  background: linear-gradient(to bottom, #E0454A, #D13438);
  transform: translateY(-2px);
  box-shadow: 
    0 4px 12px rgba(212, 52, 56, 0.4),
    0 0 0 1px rgba(255, 255, 255, 0.15) inset;
}

.end-task-btn:hover:not(:disabled)::before {
  left: 100%;
}

.end-task-btn:active:not(:disabled) {
  transform: translateY(0);
  transition-duration: 0.1s;
}

.end-task-btn:disabled {
  background: linear-gradient(to bottom, #E0E0E0, #D0D0D0);
  color: #9E9E9E;
  cursor: not-allowed;
  transform: none;
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
}

.end-task-btn .icon {
  font-size: 14px;
}

.task-manager-footer {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 0 20px 16px;
  color: var(--win-text-secondary);
  font-size: 12px;
}

.process-count {
  display: flex;
  align-items: center;
  gap: 8px;
}

.process-count .count {
  font-weight: 500;
  color: var(--win-text);
}

.cpu-usage {
  display: flex;
  align-items: center;
  gap: 8px;
}

.cpu-usage .bar {
  width: 100px;
  height: 6px;
  background: #E0E0E0;
  border-radius: 3px;
  overflow: hidden;
}

.cpu-usage .bar-fill {
  height: 100%;
  background: linear-gradient(to right, #4CAF50, #8BC34A, #FFC107, #FF9800, #F44336);
  border-radius: 3px;
  transition: width 1s ease-out;
}

/* ========== LOADING SPINNER ========== */
.task-manager-loading {
  position: absolute;
  inset: 0;
  background: rgba(255, 255, 255, 0.92);
  backdrop-filter: blur(4px);
  -webkit-backdrop-filter: blur(4px);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  z-index: 10;
  animation: loadingFadeIn 0.3s ease-out;
}

@keyframes loadingFadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

.loading-spinner {
  width: 48px;
  height: 48px;
  border: 3px solid rgba(0, 120, 212, 0.1);
  border-top: 3px solid var(--win-accent);
  border-radius: 50%;
  animation: spin 1.2s cubic-bezier(0.5, 0.1, 0.5, 0.9) infinite;
  margin-bottom: 20px;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

.loading-text {
  font-size: 14px;
  color: var(--win-text-secondary);
  font-weight: 450;
  letter-spacing: 0.3px;
}

.loading-dots::after {
  content: '';
  animation: loadingDots 1.5s infinite;
}

@keyframes loadingDots {
  0%, 20% { content: '.'; }
  40% { content: '..'; }
  60%, 100% { content: '...'; }
}

/* ========== PROCESS TERMINATION ========== */
.process-terminating {
  animation: processTerminate 0.6s cubic-bezier(0.4, 0, 0.2, 1) forwards;
  position: relative;
  overflow: hidden;
}

.process-terminating::before {
  content: '';
  position: absolute;
  inset: 0;
  background: linear-gradient(90deg, transparent, rgba(212, 52, 56, 0.1), transparent);
  animation: terminateScan 0.6s ease-out;
}

@keyframes processTerminate {
  0% {
    opacity: 1;
    transform: translateX(0);
    max-height: 100px;
    padding-top: 12px;
    padding-bottom: 12px;
  }
  50% {
    opacity: 0.5;
    transform: translateX(-20px);
    background: rgba(212, 52, 56, 0.1);
  }
  100% {
    opacity: 0;
    transform: translateX(-100px);
    max-height: 0;
    padding-top: 0;
    padding-bottom: 0;
    border: none;
    margin: 0;
  }
}

@keyframes terminateScan {
  0% { transform: translateX(-100%); }
  100% { transform: translateX(100%); }
}

/* ========== TOAST NOTIFICATIONS ========== */
#toast {
  position: fixed;
  bottom: 100px;
  left: 50%;
  transform: translateX(-50%);
  background: rgba(30, 30, 30, 0.96);
  backdrop-filter: blur(24px) saturate(180%);
  -webkit-backdrop-filter: blur(24px) saturate(180%);
  color: #FFFFFF;
  padding: 14px 28px;
  border-radius: 8px;
  font-size: 13px;
  font-weight: 450;
  display: none;
  z-index: 100000;
  box-shadow: 
    0 0 0 1px rgba(255, 255, 255, 0.1),
    0 12px 32px rgba(0, 0, 0, 0.4);
  animation: toastSlideUp 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  max-width: 400px;
  text-align: center;
  border: 1px solid rgba(255, 255, 255, 0.12);
}

@keyframes toastSlideUp {
  from {
    opacity: 0;
    transform: translateX(-50%) translateY(20px) scale(0.98);
  }
  to {
    opacity: 1;
    transform: translateX(-50%) translateY(0) scale(1);
  }
}

/* ========== CALENDAR POPOVER ========== */
.tray-popover {
  position: absolute;
  bottom: 56px;
  right: 12px;
  width: 340px;
  background: var(--win-start-menu);
  backdrop-filter: blur(48px) saturate(200%);
  -webkit-backdrop-filter: blur(48px) saturate(200%);
  border-radius: 10px;
  box-shadow: 
    0 0 0 1px rgba(255, 255, 255, 0.12),
    0 24px 48px rgba(0, 0, 0, 0.4);
  display: none;
  z-index: 9999;
  overflow: hidden;
  border: 1px solid rgba(255, 255, 255, 0.15);
  animation: popoverAppear 0.2s cubic-bezier(0.4, 0, 0.2, 1);
}

@keyframes popoverAppear {
  from {
    opacity: 0;
    transform: translateY(10px) scale(0.98);
  }
  to {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

.pop-header {
  padding: 16px 20px;
  background: rgba(255, 255, 255, 0.06);
  border-bottom: 1px solid rgba(255, 255, 255, 0.1);
  font-size: 13px;
  font-weight: 500;
  color: #FFFFFF;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.pop-header .actions {
  display: flex;
  gap: 8px;
}

.pop-body {
  padding: 20px;
}

.big-clock {
  font-size: 44px;
  font-weight: 300;
  color: #FFFFFF;
  margin-bottom: 8px;
  font-variant-numeric: tabular-nums;
  letter-spacing: -1px;
}

.small-date {
  font-size: 14px;
  color: rgba(255, 255, 255, 0.8);
  margin-bottom: 24px;
  font-weight: 450;
}

.calendar {
  color: #FFFFFF;
}

.cal-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 16px;
}

.month {
  font-weight: 500;
  font-size: 14px;
}

.prev-month, .next-month {
  width: 32px;
  height: 32px;
  border-radius: 6px;
  display: grid;
  place-items: center;
  cursor: pointer;
  transition: background-color 0.2s;
  font-size: 20px;
  color: rgba(255, 255, 255, 0.9);
}

.prev-month:hover, .next-month:hover {
  background: rgba(255, 255, 255, 0.1);
}

.prev-month:active, .next-month:active {
  background: rgba(255, 255, 255, 0.2);
  transition-duration: 0.1s;
}

.cal-grid {
  display: grid;
  grid-template-columns: repeat(7, 1fr);
  gap: 4px;
}

.dow {
  text-align: center;
  padding: 10px 0;
  font-size: 12px;
  color: rgba(255, 255, 255, 0.6);
  font-weight: 450;
}

.day {
  text-align: center;
  padding: 10px 0;
  border-radius: 6px;
  cursor: default;
  font-size: 13px;
  transition: all 0.2s;
  font-weight: 450;
}

.day:hover:not(.other):not(.today) {
  background: rgba(255, 255, 255, 0.1);
}

.day.today {
  background: var(--win-accent);
  color: #FFFFFF;
  font-weight: 500;
  box-shadow: 0 2px 8px rgba(0, 120, 212, 0.3);
}

.day.other {
  color: rgba(255, 255, 255, 0.3);
}

/* ========== BUTTONS ========== */
button {
  background: linear-gradient(to bottom, rgba(255, 255, 255, 0.9), rgba(240, 240, 240, 0.9));
  border: 1px solid rgba(0, 0, 0, 0.1);
  color: var(--win-text);
  padding: 8px 18px;
  border-radius: 6px;
  font-size: 13px;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
  display: inline-flex;
  align-items: center;
  gap: 8px;
  box-shadow: 
    0 1px 2px rgba(0, 0, 0, 0.05),
    0 0 0 1px rgba(255, 255, 255, 0.1) inset;
  position: relative;
  overflow: hidden;
}

button::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
  transition: left 0.6s;
}

button:hover {
  background: linear-gradient(to bottom, #FFFFFF, #F0F0F0);
  border-color: rgba(0, 0, 0, 0.15);
  transform: translateY(-2px);
  box-shadow: 
    0 4px 12px rgba(0, 0, 0, 0.1),
    0 0 0 1px rgba(255, 255, 255, 0.2) inset;
}

button:hover::before {
  left: 100%;
}

button:active {
  transform: translateY(0);
  transition-duration: 0.1s;
  box-shadow: 
    0 1px 2px rgba(0, 0, 0, 0.1),
    0 0 0 1px rgba(0, 0, 0, 0.1) inset;
}

button:disabled {
  opacity: 0.6;
  cursor: not-allowed;
  transform: none;
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
}

button .icon {
  font-size: 14px;
}

/* ========== SCROLLBARS ========== */
::-webkit-scrollbar {
  width: 10px;
  height: 10px;
}

::-webkit-scrollbar-track {
  background: transparent;
}

::-webkit-scrollbar-thumb {
  background: rgba(0, 0, 0, 0.2);
  border-radius: 5px;
  border: 2px solid transparent;
  background-clip: padding-box;
}

::-webkit-scrollbar-thumb:hover {
  background: rgba(0, 0, 0, 0.3);
  border: 2px solid transparent;
  background-clip: padding-box;
}

::-webkit-scrollbar-thumb:active {
  background: rgba(0, 0, 0, 0.4);
}

::-webkit-scrollbar-corner {
  background: transparent;
}

/* ========== UTILITY CLASSES ========== */
.hidden {
  display: none !important;
}

.transparent {
  opacity: 0 !important;
  pointer-events: none !important;
}

/* ========== FOCUS STATES ========== */
:focus-visible {
  outline: 2px solid var(--win-accent);
  outline-offset: 2px;
  border-radius: 4px;
}

/* ========== RESPONSIVE ========== */
@media (max-width: 1024px) {
  .start-menu {
    width: 90vw;
  }
  
  .window {
    max-width: 90vw;
  }
  
  .taskbar-center {
    max-width: 80vw;
  }
}

/* ========== DARK MODE SUPPORT ========== */
@media (prefers-color-scheme: dark) {
  :root {
    --win-bg: rgba(32, 32, 32, 0.88);
    --win-bg-solid: #202020;
    --win-text: #FFFFFF;
    --win-text-secondary: #A0A0A0;
    --win-text-tertiary: #707070;
    --win-border: rgba(255, 255, 255, 0.08);
  }
  
  body {
    background: linear-gradient(155deg, #0A0A15 0%, #1A1A25 30%, #252535 70%, #1A1A25 100%);
  }
  
  .window {
    border: 1px solid rgba(255, 255, 255, 0.15);
  }
}
</style>
</head>
<body>

<!-- Desktop Icons -->
<div id="desktop">
  <div class="desktop-icon" style="left: 48px; top: 48px;" data-icon="this-pc" data-name="This PC">
    <div class="icon">üíª</div>
    <div class="label">This PC</div>
  </div>
  <div class="desktop-icon" style="left: 48px; top: 168px;" data-icon="recycle" data-name="Recycle Bin">
    <div class="icon">üóëÔ∏è</div>
    <div class="label">Recycle Bin</div>
  </div>
  <div class="desktop-icon" style="left: 48px; top: 288px;" data-icon="documents" data-name="Documents">
    <div class="icon">üìÅ</div>
    <div class="label">Documents</div>
  </div>
  <div class="desktop-icon" style="left: 48px; top: 408px;" data-icon="network" data-name="Network">
    <div class="icon">üåê</div>
    <div class="label">Network</div>
  </div>
  <div class="desktop-icon" style="left: 168px; top: 48px;" data-icon="control-panel" data-name="Control Panel">
    <div class="icon">‚öôÔ∏è</div>
    <div class="label">Control Panel</div>
  </div>
</div>

<!-- Unresponsive Photos App Window -->
<div class="unresponsive-window" id="photoViewerWindow" style="left: 460px; top: 140px; width: 520px; height: 400px;">
  <div class="window-header">
    <div class="window-title">
      <span class="app-icon">üñºÔ∏è</span>
      <span class="app-name">Photos - beach_vacation.jpg (Not responding)</span>
    </div>
    <div class="window-controls">
      <div class="window-control minimize" title="Minimize">‚àí</div>
      <div class="window-control maximize" title="Maximize">‚¨ú</div>
      <div class="window-control close" title="Close">‚úï</div>
    </div>
  </div>
  <div class="window-body" style="display: flex; align-items: center; justify-content: center; background: linear-gradient(135deg, #F5F7FA 0%, #E4E7EB 100%);">
    <div style="text-align: center; color: #5A5A5A;">
      <div style="font-size: 80px; margin-bottom: 20px; filter: grayscale(0.3);">üñºÔ∏è</div>
      <div style="font-size: 17px; margin-bottom: 8px; font-weight: 500;">Loading image...</div>
      <div style="font-size: 12.5px; color: #8A8A8A;">5.2 MB ‚Ä¢ 3840√ó2160 ‚Ä¢ JPEG ‚Ä¢ 98% quality</div>
      <div style="margin-top: 24px; width: 200px; height: 4px; background: rgba(0, 0, 0, 0.1); border-radius: 2px; overflow: hidden;">
        <div style="width: 65%; height: 100%; background: linear-gradient(to right, #4CAF50, #8BC34A); border-radius: 2px; animation: progressPulse 2s infinite ease-in-out;"></div>
      </div>
    </div>
  </div>
  <div class="unresponsive-overlay">
    <div>Not responding</div>
    <div style="font-size: 11px; margin-top: 4px; font-weight: 400; color: #8A8A8A;">Click and drag to move this window</div>
  </div>
  
  <!-- Window resize handles -->
  <div class="window-resize n"></div>
  <div class="window-resize s"></div>
  <div class="window-resize e"></div>
  <div class="window-resize w"></div>
  <div class="window-resize ne"></div>
  <div class="window-resize nw"></div>
  <div class="window-resize se"></div>
  <div class="window-resize sw"></div>
</div>

@keyframes progressPulse {
  0%, 100% { opacity: 0.7; }
  50% { opacity: 1; }
}

<!-- Instructions Window -->
<div class="window" id="instructionsWindow" style="left: 90px; top: 90px; width: 540px; height: 440px;">
  <div class="window-header">
    <div class="window-title">
      <span class="app-icon">üìã</span>
      <span class="app-name">Lab Instructions</span>
    </div>
    <div class="window-controls">
      <div class="window-control minimize" title="Minimize">‚àí</div>
      <div class="window-control maximize" title="Maximize">‚¨ú</div>
      <div class="window-control close" title="Close">‚úï</div>
    </div>
  </div>
  <div class="window-body">
    <div style="display: flex; align-items: center; gap: 16px; margin-bottom: 24px;">
      <div style="font-size: 32px; color: var(--win-accent);">üß™</div>
      <div>
        <h2 style="color: var(--win-accent); margin-bottom: 4px; font-weight: 600; font-size: 20px;">End an Unresponsive Application</h2>
        <div style="color: var(--win-text-secondary); font-size: 13px;">Windows 11 Task Manager Simulation Lab</div>
      </div>
    </div>
    
    <div style="margin-bottom: 28px; line-height: 1.6; color: var(--win-text); font-size: 14px;">
      <p>The <strong>Photos application</strong> has stopped responding and is consuming excessive system resources. Your task is to use Windows Task Manager to terminate this unresponsive process.</p>
    </div>
    
    <div style="background: linear-gradient(to right, #FFF8E1, #FFF3E0); border-left: 4px solid #FFB300; padding: 18px; border-radius: 6px; margin-bottom: 28px;">
      <div style="display: flex; align-items: flex-start; gap: 14px;">
        <div style="font-size: 22px; color: #FF9800; margin-top: 2px;">üí°</div>
        <div>
          <strong style="display: block; margin-bottom: 6px; color: #5D4037;">Pro Tip:</strong>
          <div style="color: #5D4037; font-size: 13.5px; line-height: 1.5;">Even unresponsive windows can be dragged to reposition them. Try moving the Photos window if it's obstructing your view.</div>
        </div>
      </div>
    </div>
    
    <h3 style="margin-bottom: 16px; font-weight: 600; color: var(--win-text); font-size: 15px;">Step-by-Step Instructions:</h3>
    <ol style="margin-left: 24px; margin-bottom: 32px; line-height: 1.7; font-size: 14px;">
      <li style="margin-bottom: 10px;"><strong>Right-click</strong> the <span style="background: rgba(0, 120, 212, 0.1); padding: 2px 6px; border-radius: 4px;">Start button</span> in the taskbar</li>
      <li style="margin-bottom: 10px;">Select <strong>Task Manager</strong> from the context menu (or press Ctrl+Shift+Esc)</li>
      <li style="margin-bottom: 10px;">In Task Manager, locate <strong>PhotoViewer.exe</strong> (marked as "Not responding")</li>
      <li style="margin-bottom: 10px;">Select the process and click <span style="background: rgba(212, 52, 56, 0.1); color: var(--win-danger); padding: 2px 6px; border-radius: 4px; font-weight: 500;">End task</span></li>
    </ol>
    
    <div style="display: flex; gap: 14px; margin-top: 32px;">
      <button id="resetLab">
        <span class="icon">üîÑ</span>
        Reset Lab
      </button>
      <button id="closeBrowser">
        <span class="icon">üö™</span>
        Exit Simulation
      </button>
      <button id="hintButton" style="margin-left: auto;">
        <span class="icon">‚ùì</span>
        Show Hint
      </button>
    </div>
  </div>
  
  <!-- Window resize handles -->
  <div class="window-resize n"></div>
  <div class="window-resize s"></div>
  <div class="window-resize e"></div>
  <div class="window-resize w"></div>
  <div class="window-resize ne"></div>
  <div class="window-resize nw"></div>
  <div class="window-resize se"></div>
  <div class="window-resize sw"></div>
</div>

<!-- Task Manager Window -->
<div class="window" id="taskManagerWindow" style="left: 280px; top: 120px; width: 920px; height: 640px; display: none;">
  <div class="window-header">
    <div class="window-title">
      <span class="app-icon">üß∞</span>
      <span class="app-name">Task Manager</span>
    </div>
    <div class="window-controls">
      <div class="window-control minimize" title="Minimize">‚àí</div>
      <div class="window-control maximize" title="Maximize">‚¨ú</div>
      <div class="window-control close" title="Close">‚úï</div>
    </div>
  </div>
  
  <div class="task-manager-tabs">
    <div class="task-manager-tab active">Processes</div>
    <div class="task-manager-tab">Performance</div>
    <div class="task-manager-tab">App history</div>
    <div class="task-manager-tab">Startup</div>
    <div class="task-manager-tab">Users</div>
    <div class="task-manager-tab">Details</div>
    <div class="task-manager-tab">Services</div>
  </div>
  
  <div class="window-body" style="position: relative; padding: 0;">
    <div class="task-manager-loading" id="taskManagerLoading">
      <div class="loading-spinner"></div>
      <div class="loading-text">Loading processes<span class="loading-dots"></span></div>
      <div style="margin-top: 16px; color: var(--win-text-tertiary); font-size: 12px; text-align: center;">
        <div>Gathering system information</div>
        <div style="margin-top: 4px; font-size: 11px;">Simulating Windows Task Manager</div>
      </div>
    </div>
    
    <div class="process-list-container">
      <table class="process-list">
        <thead>
          <tr>
            <th class="sortable">Name</th>
            <th class="sortable">Status</th>
            <th class="sortable">CPU</th>
            <th class="sortable">Memory</th>
            <th class="sortable">Disk</th>
            <th class="sortable">Network</th>
          </tr>
        </thead>
        <tbody id="processTbody">
          <!-- Process rows will be populated here -->
        </tbody>
      </table>
      
      <div class="process-actions">
        <button class="end-task-btn" id="endTaskBtn" disabled>
          <span class="icon">‚ö∞Ô∏è</span>
          End task
        </button>
        <button style="background: transparent; border: 1px solid #D0D0D0; color: var(--win-text);">
          <span class="icon">‚ûï</span>
          Run new task
        </button>
        
        <div style="margin-left: auto; display: flex; align-items: center; gap: 20px;">
          <div class="process-count">
            <span class="label">Processes:</span>
            <span class="count" id="processCount">0</span>
          </div>
          <div class="cpu-usage">
            <span class="label">CPU:</span>
            <span class="bar">
              <span class="bar-fill" id="cpuUsageBar" style="width: 12%;"></span>
            </span>
            <span class="percentage" id="cpuPercentage">12%</span>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Window resize handles -->
  <div class="window-resize n"></div>
  <div class="window-resize s"></div>
  <div class="window-resize e"></div>
  <div class="window-resize w"></div>
  <div class="window-resize ne"></div>
  <div class="window-resize nw"></div>
  <div class="window-resize se"></div>
  <div class="window-resize sw"></div>
</div>

<!-- Taskbar -->
<div class="taskbar">
  <div class="taskbar-center">
    <button class="start-button" id="startButton" aria-label="Start" title="Start">
      <svg viewBox="0 0 24 24">
        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
      </svg>
    </button>
    
    <div class="taskbar-icon" title="Search">
      <i class="fas fa-search"></i>
    </div>
    <div class="taskbar-icon" title="Widgets">
      <i class="fas fa-grip-vertical"></i>
    </div>
    <div class="taskbar-icon" title="Microsoft Teams">
      <i class="fas fa-comments"></i>
    </div>
    <div class="taskbar-icon" title="File Explorer">
      <i class="fas fa-folder"></i>
    </div>
    <div class="taskbar-icon active" title="Microsoft Edge">
      <i class="fab fa-edge"></i>
      <div class="badge"></div>
    </div>
    <div class="taskbar-icon" title="Visual Studio Code">
      <i class="fas fa-code"></i>
    </div>
    <div class="taskbar-icon" title="Photos">
      <i class="fas fa-images"></i>
    </div>
  </div>
  
  <div class="system-tray">
    <div class="tray-group" id="trayHiddenIcons" title="Hidden icons">
      <i class="fas fa-chevron-up" style="font-size: 10px;"></i>
    </div>
    <div class="tray-group" id="trayNetwork" title="Network">
      <i class="fas fa-wifi" style="font-size: 14px;"></i>
    </div>
    <div class="tray-group" id="trayVolume" title="Volume">
      <i class="fas fa-volume-up" style="font-size: 14px;"></i>
    </div>
    <div class="tray-group" id="trayTimeChip" title="Date and time">
      <div class="tray-time">
        <div id="currentTime">14:30</div>
        <div id="currentDate">12/06/2024</div>
      </div>
    </div>
  </div>
</div>

<!-- Start Menu -->
<div class="start-menu" id="startMenu">
  <div class="start-menu-header">
    <div style="display: flex; align-items: center; gap: 14px;">
      <div style="font-size: 24px; width: 40px; height: 40px; border-radius: 8px; background: linear-gradient(135deg, #0078D4, #00BCF2); display: grid; place-items: center; color: white;">W</div>
      <div>
        <div style="font-weight: 500; color: #FFFFFF;">Windows 11 Pro</div>
        <div style="font-size: 11.5px; opacity: 0.8; color: rgba(255, 255, 255, 0.9);">Lab Simulation Environment</div>
      </div>
    </div>
  </div>
  <div class="start-menu-body">
    <div class="start-menu-left">
      <div class="pinned-section-title">Pinned</div>
      <div class="pinned-apps">
        <div class="pinned-tile" data-app="edge">
          <div class="icon"><i class="fab fa-edge"></i></div>
          <div>Edge</div>
        </div>
        <div class="pinned-tile" data-app="explorer">
          <div class="icon"><i class="fas fa-folder"></i></div>
          <div>File Explorer</div>
        </div>
        <div class="pinned-tile" data-app="store">
          <div class="icon"><i class="fas fa-shopping-bag"></i></div>
          <div>Microsoft Store</div>
        </div>
        <div class="pinned-tile" data-app="settings">
          <div class="icon"><i class="fas fa-cog"></i></div>
          <div>Settings</div>
        </div>
        <div class="pinned-tile" data-app="photos">
          <div class="icon"><i class="fas fa-images"></i></div>
          <div>Photos</div>
        </div>
        <div class="pinned-tile" data-app="calculator">
          <div class="icon"><i class="fas fa-calculator"></i></div>
          <div>Calculator</div>
        </div>
        <div class="pinned-tile" data-app="vscode">
          <div class="icon"><i class="fas fa-code"></i></div>
          <div>VS Code</div>
        </div>
        <div class="pinned-tile" data-app="word">
          <div class="icon"><i class="fas fa-file-word"></i></div>
          <div>Word</div>
        </div>
        <div class="pinned-tile" data-app="excel">
          <div class="icon"><i class="fas fa-file-excel"></i></div>
          <div>Excel</div>
        </div>
        <div class="pinned-tile" data-app="powerpoint">
          <div class="icon"><i class="fas fa-file-powerpoint"></i></div>
          <div>PowerPoint</div>
        </div>
        <div class="pinned-tile" data-app="teams">
          <div class="icon"><i class="fas fa-comments"></i></div>
          <div>Teams</div>
        </div>
        <div class="pinned-tile" data-app="notepad">
          <div class="icon"><i class="fas fa-sticky-note"></i></div>
          <div>Notepad</div>
        </div>
      </div>
      
      <div class="recommended-section">
        <div class="pinned-section-title">Recommended</div>
        <div class="recommended-item">
          <div class="icon" style="background: linear-gradient(135deg, #FF6B6B, #FF8E53);">
            <i class="fas fa-clipboard-list" style="color: white;"></i>
          </div>
          <div class="details">
            <div class="title">Lab Instructions</div>
            <div class="subtitle">Updated today ‚Ä¢ Windows 11 Lab</div>
          </div>
        </div>
        <div class="recommended-item">
          <div class="icon" style="background: linear-gradient(135deg, #4ECDC4, #44A08D);">
            <i class="fas fa-tasks" style="color: white;"></i>
          </div>
          <div class="details">
            <div class="title">Task Manager Guide</div>
            <div class="subtitle">PDF ‚Ä¢ 2.4 MB</div>
          </div>
        </div>
        <div class="recommended-item">
          <div class="icon" style="background: linear-gradient(135deg, #FFD166, #FFB347);">
            <i class="fas fa-image" style="color: white;"></i>
          </div>
          <div class="details">
            <div class="title">beach_vacation.jpg</div>
            <div class="subtitle">Today ‚Ä¢ 5.2 MB</div>
          </div>
        </div>
      </div>
    </div>
    
    <div class="start-menu-right">
      <div class="power-section">
        <div class="power-section-title">Power</div>
        <div class="power-button" data-action="user">
          <div class="icon"><i class="fas fa-user"></i></div>
          <div class="label">User</div>
        </div>
        <div class="power-button" data-action="settings">
          <div class="icon"><i class="fas fa-cog"></i></div>
          <div class="label">Settings</div>
        </div>
        <div class="power-button" data-action="power">
          <div class="icon"><i class="fas fa-power-off"></i></div>
          <div class="label">Power</div>
        </div>
      </div>
      
      <div style="margin-top: 32px;">
        <div class="power-section-title">Recent</div>
        <div class="power-button" data-action="documents">
          <div class="icon"><i class="fas fa-folder"></i></div>
          <div class="label">Documents</div>
        </div>
        <div class="power-button" data-action="downloads">
          <div class="icon"><i class="fas fa-download"></i></div>
          <div class="label">Downloads</div>
        </div>
        <div class="power-button" data-action="pictures">
          <div class="icon"><i class="fas fa-images"></i></div>
          <div class="label">Pictures</div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Context Menu -->
<div class="context-menu" id="startContext" style="display: none;">
  <div class="context-menu-item" data-action="apps">
    <div class="icon"><i class="fas fa-th"></i></div>
    <div>Apps and Features</div>
    <div class="shortcut"></div>
  </div>
  <div class="context-menu-item" data-action="mobility">
    <div class="icon"><i class="fas fa-laptop"></i></div>
    <div>Mobility Center</div>
  </div>
  <div class="context-menu-item" data-action="power">
    <div class="icon"><i class="fas fa-bolt"></i></div>
    <div>Power Options</div>
  </div>
  <div class="context-menu-item" data-action="event">
    <div class="icon"><i class="fas fa-chart-bar"></i></div>
    <div>Event Viewer</div>
  </div>
  <div class="context-menu-item" data-action="system">
    <div class="icon"><i class="fas fa-desktop"></i></div>
    <div>System</div>
  </div>
  <div class="context-menu-divider"></div>
  <div class="context-menu-item" data-action="device">
    <div class="icon"><i class="fas fa-microchip"></i></div>
    <div>Device Manager</div>
  </div>
  <div class="context-menu-item" data-action="network">
    <div class="icon"><i class="fas fa-network-wired"></i></div>
    <div>Network Connections</div>
  </div>
  <div class="context-menu-item" data-action="disk">
    <div class="icon"><i class="fas fa-hdd"></i></div>
    <div>Disk Management</div>
  </div>
  <div class="context-menu-item" data-action="computer">
    <div class="icon"><i class="fas fa-tasks"></i></div>
    <div>Computer Management</div>
  </div>
  <div class="context-menu-divider"></div>
  <div class="context-menu-item" data-action="terminal">
    <div class="icon"><i class="fas fa-terminal"></i></div>
    <div>Windows Terminal</div>
    <div class="shortcut"></div>
  </div>
  <div class="context-menu-item" data-action="taskmgr" style="background: rgba(0, 120, 212, 0.15);">
    <div class="icon"><i class="fas fa-tasks"></i></div>
    <div><strong>Task Manager</strong></div>
    <div class="shortcut">Ctrl+Shift+Esc</div>
  </div>
  <div class="context-menu-divider"></div>
  <div class="context-menu-item" data-action="settings">
    <div class="icon"><i class="fas fa-cog"></i></div>
    <div>Settings</div>
  </div>
  <div class="context-menu-item" data-action="search">
    <div class="icon"><i class="fas fa-search"></i></div>
    <div>Search</div>
  </div>
  <div class="context-menu-item" data-action="run">
    <div class="icon"><i class="fas fa-running"></i></div>
    <div>Run...</div>
    <div class="shortcut">Win+R</div>
  </div>
  <div class="context-menu-divider"></div>
  <div class="context-menu-item" data-action="shutdown">
    <div class="icon"><i class="fas fa-power-off"></i></div>
    <div>Shut down or sign out</div>
    <div class="shortcut">‚Üí</div>
  </div>
  <div class="context-menu-item" data-action="desktop">
    <div class="icon"><i class="fas fa-desktop"></i></div>
    <div>Show desktop</div>
    <div class="shortcut">Win+D</div>
  </div>
</div>

<!-- Calendar Popover -->
<div class="tray-popover" id="calendarPopover">
  <div class="pop-header">
    <span>Date and time</span>
    <div class="actions">
      <button style="background: transparent; border: 1px solid rgba(255, 255, 255, 0.2); color: white; padding: 4px 12px; font-size: 12px;">
        <i class="fas fa-cog" style="font-size: 12px;"></i>
        Settings
      </button>
    </div>
  </div>
  <div class="pop-body">
    <div class="big-clock" id="bigClock">14:30</div>
    <div class="small-date" id="smallDate">Friday, December 6, 2024</div>
    
    <div class="calendar">
      <div class="cal-header">
        <div class="prev-month" id="prevMonth">
          <i class="fas fa-chevron-left"></i>
        </div>
        <div class="month" id="monthLabel">December 2024</div>
        <div class="next-month" id="nextMonth">
          <i class="fas fa-chevron-right"></i>
        </div>
      </div>
      <div class="cal-grid" id="calGrid">
        <div class="dow">Sun</div>
        <div class="dow">Mon</div>
        <div class="dow">Tue</div>
        <div class="dow">Wed</div>
        <div class="dow">Thu</div>
        <div class="dow">Fri</div>
        <div class="dow">Sat</div>
        <!-- Days will be populated by JavaScript -->
      </div>
    </div>
    
    <div style="margin-top: 24px; padding-top: 16px; border-top: 1px solid rgba(255, 255, 255, 0.1);">
      <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 12px;">
        <span style="font-size: 13px; color: rgba(255, 255, 255, 0.9);">Additional clocks</span>
        <button style="background: transparent; border: 1px solid rgba(255, 255, 255, 0.2); color: white; padding: 4px 12px; font-size: 12px;">
          <i class="fas fa-plus" style="font-size: 10px;"></i>
          Add
        </button>
      </div>
    </div>
  </div>
</div>

<!-- Toast Notification -->
<div id="toast"></div>

<!-- Keyboard Shortcuts Hint -->
<div id="keyboardHint" style="position: fixed; bottom: 160px; right: 24px; background: rgba(30, 30, 30, 0.9); backdrop-filter: blur(20px); color: white; padding: 16px; border-radius: 8px; font-size: 12px; display: none; z-index: 99999; border: 1px solid rgba(255, 255, 255, 0.1); max-width: 240px; box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);">
  <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 12px;">
    <strong style="font-size: 13px;">Keyboard Shortcuts</strong>
    <button id="closeHint" style="background: transparent; border: none; color: rgba(255, 255, 255, 0.7); cursor: pointer; font-size: 14px;">
      <i class="fas fa-times"></i>
    </button>
  </div>
  <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px;">
    <div><kbd>Win</kbd> Start menu</div>
    <div><kbd>Ctrl+Shift+Esc</kbd> Task Manager</div>
    <div><kbd>Alt+F4</kbd> Close window</div>
    <div><kbd>Win+D</kbd> Show desktop</div>
    <div><kbd>Win+R</kbd> Run dialog</div>
    <div><kbd>Win+X</kbd> Power menu</div>
  </div>
</div>

<script>
// ========== GLOBAL STATE & UTILITIES ==========
const $ = (selector, root = document) => root.querySelector(selector);
const $$ = (selector, root = document) => Array.from(root.querySelectorAll(selector));

let dragElement = null;
let dragOffset = { x: 0, y: 0 };
let isDragging = false;
let isResizing = false;
let resizeDirection = null;
let selectedProcess = null;
let currentSort = { column: 'cpu', direction: 'desc' };

// Enhanced process data with realistic Windows 11 processes
const processData = [
  { name: 'System', pid: 4, status: 'Running', cpu: 0.3, memory: 145.2, disk: 0.1, network: 0, responsive: true, icon: '‚öôÔ∏è', description: 'NT Kernel & System' },
  { name: 'Registry', pid: 112, status: 'Running', cpu: 0.1, memory: 12.8, disk: 0, network: 0, responsive: true, icon: 'üóÑÔ∏è', description: 'Windows Registry' },
  { name: 'Memory Compression', pid: 1204, status: 'Running', cpu: 0.8, memory: 45.3, disk: 0, network: 0, responsive: true, icon: 'üíæ', description: 'Memory Compression' },
  { name: 'Windows Explorer', pid: 2848, status: 'Running', cpu: 0.5, memory: 68.4, disk: 0, network: 0, responsive: true, icon: 'üìÅ', description: 'Windows Shell Experience' },
  { name: 'Desktop Window Manager', pid: 1340, status: 'Running', cpu: 1.2, memory: 92.6, disk: 0, network: 0, responsive: true, icon: 'üñ•Ô∏è', description: 'Desktop Window Manager' },
  { name: 'Client Server Runtime Process', pid: 892, status: 'Running', cpu: 0.2, memory: 18.7, disk: 0, network: 0, responsive: true, icon: 'üîß', description: 'CSRSS.exe' },
  { name: 'Microsoft Edge', pid: 3824, status: 'Running', cpu: 3.5, memory: 328.8, disk: 0.2, network: 1.4, responsive: true, icon: 'üåê', description: 'Microsoft Edge Browser' },
  { name: 'Antimalware Service Executable', pid: 1428, status: 'Running', cpu: 0.9, memory: 162.3, disk: 0.3, network: 0, responsive: true, icon: 'üõ°Ô∏è', description: 'Windows Defender' },
  { name: 'Windows Security Health Service', pid: 2016, status: 'Running', cpu: 0.3, memory: 34.2, disk: 0, network: 0, responsive: true, icon: 'üîí', description: 'Security Health Service' },
  { name: 'Runtime Broker', pid: 2840, status: 'Running', cpu: 0.4, memory: 48.8, disk: 0, network: 0, responsive: true, icon: 'üèÉ', description: 'Runtime Broker' },
  { name: 'PhotoViewer.exe', pid: 3848, status: 'Not responding', cpu: 95.8, memory: 512.3, disk: 15.2, network: 0, responsive: false, icon: 'üñºÔ∏è', description: 'Windows Photo Viewer' },
  { name: 'SearchHost.exe', pid: 2912, status: 'Running', cpu: 0.6, memory: 79.3, disk: 0.1, network: 0.1, responsive: true, icon: 'üîç', description: 'Windows Search' },
  { name: 'StartMenuExperienceHost', pid: 2832, status: 'Running', cpu: 0.2, memory: 34.1, disk: 0, network: 0, responsive: true, icon: 'üè†', description: 'Start Menu' },
  { name: 'TextInputHost', pid: 2948, status: 'Running', cpu: 0.1, memory: 20.9, disk: 0, network: 0, responsive: true, icon: '‚å®Ô∏è', description: 'Text Input' },
  { name: 'Service Host: Local System', pid: 1156, status: 'Running', cpu: 0.7, memory: 68.4, disk: 0.2, network: 0, responsive: true, icon: 'üîÑ', description: 'Service Host' },
  { name: 'Widgets', pid: 3124, status: 'Running', cpu: 0.4, memory: 57.2, disk: 0, network: 0.3, responsive: true, icon: 'üìä', description: 'Windows Widgets' },
  { name: 'Microsoft Photos', pid: 0, status: 'Suspended', cpu: 0, memory: 12.4, disk: 0, network: 0, responsive: true, icon: 'üñºÔ∏è', description: 'Photos App' }
];

// ========== TOAST NOTIFICATION ==========
function showToast(message, duration = 3000) {
  const toast = $('#toast');
  toast.textContent = message;
  toast.style.display = 'block';
  
  // Clear any existing timeout
  if (toast.timeoutId) clearTimeout(toast.timeoutId);
  
  toast.timeoutId = setTimeout(() => {
    toast.style.display = 'none';
    toast.timeoutId = null;
  }, duration);
}

// ========== TIME UPDATES ==========
function updateTime() {
  const now = new Date();
  
  // Update taskbar time
  $('#currentTime').textContent = now.toLocaleTimeString([], { 
    hour: '2-digit', 
    minute: '2-digit',
    hour12: false
  });
  
  $('#currentDate').textContent = now.toLocaleDateString([], { 
    month: '2-digit',
    day: '2-digit',
    year: 'numeric'
  });
  
  // Update big clock in calendar if visible
  const bigClock = $('#bigClock');
  if (bigClock) {
    bigClock.textContent = now.toLocaleTimeString([], { 
      hour: '2-digit', 
      minute: '2-digit',
      hour12: false
    });
  }
  
  // Update small date in calendar
  const smallDate = $('#smallDate');
  if (smallDate) {
    smallDate.textContent = now.toLocaleDateString([], { 
      weekday: 'long', 
      day: 'numeric', 
      month: 'long', 
      year: 'numeric' 
    });
  }
}

// Initialize time
updateTime();
setInterval(updateTime, 1000);

// ========== WINDOW DRAGGING & RESIZING ==========
function initWindowInteractions() {
  // Window dragging
  $$('.window-header').forEach(header => {
    header.addEventListener('mousedown', startDrag);
  });
  
  // Also allow dragging from the unresponsive window's body
  $('#photoViewerWindow .window-body').addEventListener('mousedown', startDrag);
  
  // Window resizing
  $$('.window-resize').forEach(resizeHandle => {
    resizeHandle.addEventListener('mousedown', startResize);
  });
}

function startDrag(e) {
  if (e.target.closest('.window-control')) return;
  
  dragElement = e.target.closest('.window, .unresponsive-window');
  if (!dragElement) return;
  
  const rect = dragElement.getBoundingClientRect();
  dragOffset.x = e.clientX - rect.left;
  dragOffset.y = e.clientY - rect.top;
  isDragging = true;
  
  // Bring to front
  bringWindowToFront(dragElement);
  
  document.addEventListener('mousemove', onDrag);
  document.addEventListener('mouseup', stopDrag);
}

function onDrag(e) {
  if (!dragElement || !isDragging) return;
  
  e.preventDefault();
  
  const x = e.clientX - dragOffset.x;
  const y = e.clientY - dragOffset.y;
  
  // Boundary check
  const maxX = window.innerWidth - dragElement.offsetWidth;
  const maxY = window.innerHeight - 48 - dragElement.offsetHeight;
  
  dragElement.style.left = `${Math.max(0, Math.min(x, maxX))}px`;
  dragElement.style.top = `${Math.max(0, Math.min(y, maxY))}px`;
}

function startResize(e) {
  e.stopPropagation();
  
  dragElement = e.target.closest('.window, .unresponsive-window');
  if (!dragElement) return;
  
  resizeDirection = e.target.className.replace('window-resize ', '');
  isResizing = true;
  
  const rect = dragElement.getBoundingClientRect();
  dragOffset.x = e.clientX;
  dragOffset.y = e.clientY;
  
  dragElement.dataset.originalWidth = rect.width;
  dragElement.dataset.originalHeight = rect.height;
  dragElement.dataset.originalX = rect.left;
  dragElement.dataset.originalY = rect.top;
  
  // Bring to front
  bringWindowToFront(dragElement);
  
  document.addEventListener('mousemove', onResize);
  document.addEventListener('mouseup', stopResize);
}

function onResize(e) {
  if (!dragElement || !isResizing) return;
  
  e.preventDefault();
  
  const dx = e.clientX - dragOffset.x;
  const dy = e.clientY - dragOffset.y;
  
  const originalWidth = parseInt(dragElement.dataset.originalWidth);
  const originalHeight = parseInt(dragElement.dataset.originalHeight);
  const originalX = parseInt(dragElement.dataset.originalX);
  const originalY = parseInt(dragElement.dataset.originalY);
  
  let newX = originalX;
  let newY = originalY;
  let newWidth = originalWidth;
  let newHeight = originalHeight;
  
  // Calculate new size and position based on resize direction
  switch(resizeDirection) {
    case 'n':
      newHeight = Math.max(200, originalHeight - dy);
      newY = originalY + (originalHeight - newHeight);
      break;
    case 's':
      newHeight = Math.max(200, originalHeight + dy);
      break;
    case 'e':
      newWidth = Math.max(300, originalWidth + dx);
      break;
    case 'w':
      newWidth = Math.max(300, originalWidth - dx);
      newX = originalX + (originalWidth - newWidth);
      break;
    case 'ne':
      newHeight = Math.max(200, originalHeight - dy);
      newY = originalY + (originalHeight - newHeight);
      newWidth = Math.max(300, originalWidth + dx);
      break;
    case 'nw':
      newHeight = Math.max(200, originalHeight - dy);
      newY = originalY + (originalHeight - newHeight);
      newWidth = Math.max(300, originalWidth - dx);
      newX = originalX + (originalWidth - newWidth);
      break;
    case 'se':
      newHeight = Math.max(200, originalHeight + dy);
      newWidth = Math.max(300, originalWidth + dx);
      break;
    case 'sw':
      newHeight = Math.max(200, originalHeight + dy);
      newWidth = Math.max(300, originalWidth - dx);
      newX = originalX + (originalWidth - newWidth);
      break;
  }
  
  // Apply boundaries
  const maxWidth = window.innerWidth - newX;
  const maxHeight = window.innerHeight - newY - 48;
  
  newWidth = Math.min(newWidth, maxWidth);
  newHeight = Math.min(newHeight, maxHeight);
  newY = Math.max(0, Math.min(newY, window.innerHeight - 48 - newHeight));
  newX = Math.max(0, Math.min(newX, window.innerWidth - newWidth));
  
  // Apply changes
  dragElement.style.left = `${newX}px`;
  dragElement.style.top = `${newY}px`;
  dragElement.style.width = `${newWidth}px`;
  dragElement.style.height = `${newHeight}px`;
}

function stopDrag() {
  isDragging = false;
  dragElement = null;
  document.removeEventListener('mousemove', onDrag);
  document.removeEventListener('mouseup', stopDrag);
}

function stopResize() {
  isResizing = false;
  dragElement = null;
  resizeDirection = null;
  document.removeEventListener('mousemove', onResize);
  document.removeEventListener('mouseup', stopResize);
}

function bringWindowToFront(windowElement) {
  $$('.window, .unresponsive-window').forEach(win => {
    win.style.zIndex = '100';
  });
  windowElement.style.zIndex = '200';
}

// ========== WINDOW CONTROLS ==========
function initWindowControls() {
  // Close buttons
  $$('.window-control.close').forEach(btn => {
    btn.addEventListener('click', (e) => {
      e.stopPropagation();
      const window = btn.closest('.window, .unresponsive-window');
      window.style.display = 'none';
      
      if (window.id === 'taskManagerWindow') {
        showToast('Task Manager closed');
      } else if (window.id === 'photoViewerWindow') {
        showToast('Photos closed (simulated)');
      }
    });
  });
  
  // Minimize buttons
  $$('.window-control.minimize').forEach(btn => {
    btn.addEventListener('click', (e) => {
      e.stopPropagation();
      const window = btn.closest('.window, .unresponsive-window');
      window.style.display = 'none';
      showToast(`${$('.app-name', window).textContent} minimized`);
    });
  });
  
  // Maximize buttons
  $$('.window-control.maximize').forEach(btn => {
    btn.addEventListener('click', (e) => {
      e.stopPropagation();
      const window = btn.closest('.window, .unresponsive-window');
      
      if (window.classList.contains('maximized')) {
        // Restore
        window.classList.remove('maximized');
        
        // Restore to default sizes
        if (window.id === 'instructionsWindow') {
          window.style = 'left: 90px; top: 90px; width: 540px; height: 440px;';
        } else if (window.id === 'taskManagerWindow') {
          window.style = 'left: 280px; top: 120px; width: 920px; height: 640px;';
        } else if (window.id === 'photoViewerWindow') {
          window.style = 'left: 460px; top: 140px; width: 520px; height: 400px;';
        }
        
        showToast('Window restored');
      } else {
        // Maximize
        window.classList.add('maximized');
        window.style = 'left: 0; top: 0; width: 100%; height: calc(100% - 48px); border-radius: 0;';
        showToast('Window maximized');
      }
    });
  });
}

// ========== TASKBAR INTERACTIONS ==========
function initTaskbar() {
  const startButton = $('#startButton');
  const startMenu = $('#startMenu');
  const startContext = $('#startContext');
  const trayTimeChip = $('#trayTimeChip');
  const calendarPopover = $('#calendarPopover');
  const keyboardHint = $('#keyboardHint');
  const closeHint = $('#closeHint');
  const hintButton = $('#hintButton');
  
  // Start button click - toggle start menu
  startButton.addEventListener('click', (e) => {
    e.stopPropagation();
    const isVisible = startMenu.style.display === 'block';
    
    // Hide other popups
    startContext.style.display = 'none';
    calendarPopover.style.display = 'none';
    keyboardHint.style.display = 'none';
    
    startMenu.style.display = isVisible ? 'none' : 'block';
    
    // Position start menu
    if (!isVisible) {
      const rect = startButton.getBoundingClientRect();
      startMenu.style.left = '50%';
      startMenu.style.transform = 'translateX(-50%)';
      startMenu.style.bottom = '56px';
    }
  });
  
  // Start button right-click - show context menu
  startButton.addEventListener('contextmenu', (e) => {
    e.preventDefault();
    e.stopPropagation();
    
    // Hide other popups
    startMenu.style.display = 'none';
    calendarPopover.style.display = 'none';
    keyboardHint.style.display = 'none';
    
    // Position context menu
    const rect = startButton.getBoundingClientRect();
    startContext.style.left = `${rect.left}px`;
    startContext.style.bottom = '56px';
    startContext.style.display = 'block';
    
    // Highlight Task Manager item
    $$('#startContext .context-menu-item').forEach(item => {
      item.style.background = '';
    });
    $('#startContext [data-action="taskmgr"]').style.background = 'rgba(0, 120, 212, 0.15)';
  });
  
  // Time chip click - show calendar
  trayTimeChip.addEventListener('click', (e) => {
    e.stopPropagation();
    
    // Hide other popups
    startMenu.style.display = 'none';
    startContext.style.display = 'none';
    keyboardHint.style.display = 'none';
    
    // Position calendar
    const rect = trayTimeChip.getBoundingClientRect();
    calendarPopover.style.right = '12px';
    calendarPopover.style.bottom = '56px';
    calendarPopover.style.display = 'block';
    
    // Update calendar
    updateCalendar();
  });
  
  // Context menu items
  $$('#startContext .context-menu-item').forEach(item => {
    item.addEventListener('click', () => {
      const action = item.dataset.action;
      startContext.style.display = 'none';
      
      if (action === 'taskmgr') {
        openTaskManager();
      } else if (action === 'run') {
        showToast('Run dialog opened (simulated)');
      } else if (action === 'desktop') {
        // Minimize all windows
        $$('.window, .unresponsive-window').forEach(win => {
          if (win.style.display !== 'none') {
            win.style.display = 'none';
          }
        });
        showToast('Desktop shown');
      } else {
        showToast(`${item.textContent.trim()} selected (simulated)`);
      }
    });
  });
  
  // Start menu items
  $$('.pinned-tile, .power-button, .recommended-item').forEach(item => {
    item.addEventListener('click', () => {
      startMenu.style.display = 'none';
      const itemName = item.querySelector('.label, .title')?.textContent || item.textContent;
      showToast(`${itemName.trim()} opened (simulated)`);
    });
  });
  
  // Hint button
  hintButton.addEventListener('click', () => {
    keyboardHint.style.display = 'block';
  });
  
  closeHint.addEventListener('click', () => {
    keyboardHint.style.display = 'none';
  });
  
  // Close popups when clicking elsewhere
  document.addEventListener('click', (e) => {
    if (!startMenu.contains(e.target) && e.target !== startButton) {
      startMenu.style.display = 'none';
    }
    if (!startContext.contains(e.target) && e.target !== startButton) {
      startContext.style.display = 'none';
    }
    if (!calendarPopover.contains(e.target) && !trayTimeChip.contains(e.target)) {
      calendarPopover.style.display = 'none';
    }
    if (!keyboardHint.contains(e.target) && e.target !== hintButton) {
      keyboardHint.style.display = 'none';
    }
  });
  
  // Taskbar icons
  $$('.taskbar-icon').forEach(icon => {
    icon.addEventListener('click', () => {
      const title = icon.getAttribute('title');
      if (title === 'Photos') {
        // Show the unresponsive window if Photos is clicked
        $('#photoViewerWindow').style.display = 'block';
        bringWindowToFront($('#photoViewerWindow'));
      } else if (title === 'File Explorer') {
        showToast('File Explorer opened (simulated)');
      } else {
        showToast(`${title} opened (simulated)`);
      }
    });
  });
  
  // System tray icons
  $$('.tray-group').forEach(group => {
    if (group.id !== 'trayTimeChip') {
      group.addEventListener('click', (e) => {
        e.stopPropagation();
        const title = group.getAttribute('title');
        showToast(`${title} opened (simulated)`);
      });
    }
  });
}

// ========== TASK MANAGER ==========
function openTaskManager() {
  const taskManagerWindow = $('#taskManagerWindow');
  const loading = $('#taskManagerLoading');
  
  // Show loading state
  taskManagerWindow.style.display = 'flex';
  loading.style.display = 'flex';
  
  // Bring to front
  bringWindowToFront(taskManagerWindow);
  
  // Simulate loading delay
  setTimeout(() => {
    loading.style.display = 'none';
    populateProcessList();
    showToast('Task Manager opened');
    
    // Update CPU usage
    updateCpuUsage();
  }, 1500);
}

function populateProcessList() {
  const tbody = $('#processTbody');
  tbody.innerHTML = '';
  
  // Sort processes
  const sortedProcesses = [...processData].sort((a, b) => {
    if (currentSort.direction === 'desc') {
      return b[currentSort.column] - a[currentSort.column];
    } else {
      return a[currentSort.column] - b[currentSort.column];
    }
  });
  
  sortedProcesses.forEach((process, index) => {
    const tr = document.createElement('tr');
    
    if (!process.responsive) {
      tr.classList.add('unresponsive');
      tr.id = 'unresponsiveProcess';
    }
    
    // Format values
    const cpuFormatted = `${process.cpu.toFixed(1)}%`;
    const memoryFormatted = `${process.memory.toFixed(1)} MB`;
    const diskFormatted = process.disk > 0 ? `${process.disk.toFixed(1)} MB/s` : '0 MB/s';
    const networkFormatted = process.network > 0 ? `${process.network.toFixed(1)} Mbps` : '0 Mbps';
    
    tr.innerHTML = `
      <td>
        <span class="process-icon">${process.icon}</span>
        <span class="process-name">
          ${process.name}
          <span class="pid">(${process.pid})</span>
        </span>
      </td>
      <td>${process.status}</td>
      <td>${cpuFormatted}</td>
      <td>${memoryFormatted}</td>
      <td>${diskFormatted}</td>
      <td>${networkFormatted}</td>
    `;
    
    // Add click handler for selection
    tr.addEventListener('click', (e) => {
      if (e.target.tagName === 'TH') return;
      
      // Deselect all rows
      $$('#processTbody tr').forEach(row => {
        row.classList.remove('selected');
      });
      
      // Select this row
      tr.classList.add('selected');
      selectedProcess = tr;
      
      // Enable end task button
      const endTaskBtn = $('#endTaskBtn');
      endTaskBtn.disabled = false;
      
      // Update button text
      const processName = process.name;
      endTaskBtn.innerHTML = `<span class="icon">‚ö∞Ô∏è</span> End task - ${processName}`;
      
      // Special styling for unresponsive process
      if (!process.responsive) {
        endTaskBtn.style.background = 'linear-gradient(to bottom, #FF5252, #D32F2F)';
      } else {
        endTaskBtn.style.background = 'linear-gradient(to bottom, var(--win-danger), #C42B1C)';
      }
    });
    
    // Add double-click for process details
    tr.addEventListener('dblclick', () => {
      showToast(`Details for ${process.name}: ${process.description}`);
    });
    
    tbody.appendChild(tr);
  });
  
  // Update process count
  $('#processCount').textContent = sortedProcesses.length;
}

function initTaskManager() {
  const endTaskBtn = $('#endTaskBtn');
  
  // End task button
  endTaskBtn.addEventListener('click', () => {
    if (!selectedProcess || endTaskBtn.disabled) return;
    
    // Get process name from selected row
    const processNameCell = selectedProcess.cells[0];
    const processName = processNameCell.textContent.split('(')[0].trim();
    
    // Add termination animation
    selectedProcess.classList.add('process-terminating');
    
    setTimeout(() => {
      // Check if it's the unresponsive process
      if (selectedProcess.id === 'unresponsiveProcess') {
        // Remove the process from the list
        selectedProcess.remove();
        
        // Hide the photo viewer window
        $('#photoViewerWindow').style.display = 'none';
        
        // Show success messages
        showToast('PhotoViewer.exe has been terminated');
        
        // Update taskbar icon
        $$('.taskbar-icon').forEach(icon => {
          if (icon.getAttribute('title') === 'Photos') {
            icon.classList.remove('active');
          }
        });
        
        setTimeout(() => {
          showToast('‚úÖ Lab completed successfully! The unresponsive application has been terminated.', 4000);
        }, 800);
      } else {
        // Remove regular process
        selectedProcess.remove();
        showToast(`Process "${processName}" ended successfully`);
      }
      
      // Update process count
      const remainingProcesses = $$('#processTbody tr').length;
      $('#processCount').textContent = remainingProcesses;
      
      // Update CPU usage
      updateCpuUsage();
      
      // Reset selection
      selectedProcess = null;
      endTaskBtn.disabled = true;
      endTaskBtn.innerHTML = `<span class="icon">‚ö∞Ô∏è</span> End task`;
      endTaskBtn.style.background = 'linear-gradient(to bottom, var(--win-danger), #C42B1C)';
      
    }, 600);
  });
  
  // Task manager tabs
  $$('.task-manager-tab').forEach((tab, index) => {
    tab.addEventListener('click', () => {
      // Remove active class from all tabs
      $$('.task-manager-tab').forEach(t => t.classList.remove('active'));
      
      // Add active class to clicked tab
      tab.classList.add('active');
      
      // Show appropriate content (simplified for this lab)
      if (index === 0) {
        // Already on Processes tab
      } else if (index === 1) {
        showToast('Performance tab selected - CPU, Memory, Disk, and Network graphs (simulated)');
      } else {
        showToast(`${tab.textContent} tab selected (simulated)`);
      }
    });
  });
  
  // Table sorting
  $$('.process-list th.sortable').forEach(th => {
    th.addEventListener('click', () => {
      const column = th.textContent.toLowerCase();
      
      // Remove sorted classes from all headers
      $$('.process-list th').forEach(header => {
        header.classList.remove('sorted-asc', 'sorted-desc');
      });
      
      // Toggle sort direction
      if (currentSort.column === column) {
        currentSort.direction = currentSort.direction === 'asc' ? 'desc' : 'asc';
      } else {
        currentSort.column = column;
        currentSort.direction = 'desc';
      }
      
      // Add sorted class to current header
      th.classList.add(`sorted-${currentSort.direction}`);
      
      // Re-populate process list with new sort
      populateProcessList();
    });
  });
}

function updateCpuUsage() {
  // Calculate total CPU usage
  const totalCpu = processData.reduce((sum, process) => sum + process.cpu, 0);
  const avgCpu = Math.min(100, totalCpu / processData.length * 2);
  
  // Update CPU bar and percentage
  $('#cpuUsageBar').style.width = `${avgCpu}%`;
  $('#cpuPercentage').textContent = `${avgCpu.toFixed(1)}%`;
  
  // Change bar color based on CPU usage
  const barFill = $('#cpuUsageBar');
  if (avgCpu < 30) {
    barFill.style.background = 'linear-gradient(to right, #4CAF50, #8BC34A)';
  } else if (avgCpu < 70) {
    barFill.style.background = 'linear-gradient(to right, #FFC107, #FF9800)';
  } else {
    barFill.style.background = 'linear-gradient(to right, #FF9800, #F44336)';
  }
}

// ========== CALENDAR ==========
let calendarDate = new Date();

function updateCalendar() {
  const monthLabel = $('#monthLabel');
  const calGrid = $('#calGrid');
  
  // Remove existing day elements (keep day of week headers)
  $$('#calGrid .day').forEach(day => day.remove());
  
  // Set month label
  monthLabel.textContent = calendarDate.toLocaleDateString([], { 
    month: 'long', 
    year: 'numeric' 
  });
  
  // Get first day of month and number of days
  const year = calendarDate.getFullYear();
  const month = calendarDate.getMonth();
  const firstDay = new Date(year, month, 1);
  const lastDay = new Date(year, month + 1, 0);
  const daysInMonth = lastDay.getDate();
  const startingDay = firstDay.getDay();
  
  // Add empty cells for days before the first day of month
  for (let i = 0; i < startingDay; i++) {
    const emptyCell = document.createElement('div');
    emptyCell.className = 'day other';
    emptyCell.textContent = '';
    calGrid.appendChild(emptyCell);
  }
  
  // Add days of the month with "today" highlight
  const today = new Date();
  const highlight = (today.getFullYear() === year && today.getMonth() === month) ? today.getDate() : -1;
  
  for (let day = 1; day <= daysInMonth; day++) {
    const dayCell = document.createElement('div');
    dayCell.className = 'day';
    dayCell.textContent = day;
    
    // Highlight today
    if (day === highlight) {
      dayCell.classList.add('today');
    }
    
    calGrid.appendChild(dayCell);
  }
  
  // Fill remaining cells to complete the grid
  const totalCells = 42; // 6 rows * 7 columns
  const currentCells = calGrid.querySelectorAll('.day').length;
  
  for (let i = currentCells; i < totalCells; i++) {
    const emptyCell = document.createElement('div');
    emptyCell.className = 'day other';
    emptyCell.textContent = '';
    calGrid.appendChild(emptyCell);
  }
  
  // Calendar navigation
  $('#prevMonth').addEventListener('click', (e) => {
    e.stopPropagation();
    calendarDate.setMonth(calendarDate.getMonth() - 1);
    updateCalendar();
  });
  
  $('#nextMonth').addEventListener('click', (e) => {
    e.stopPropagation();
    calendarDate.setMonth(calendarDate.getMonth() + 1);
    updateCalendar();
  });
}

// ========== DESKTOP INTERACTIONS ==========
function initDesktopIcons() {
  $$('.desktop-icon').forEach(icon => {
    // Single click - select
    icon.addEventListener('click', (e) => {
      e.stopPropagation();
      
      // Deselect all icons
      $$('.desktop-icon').forEach(i => i.classList.remove('selected'));
      
      // Select this icon
      icon.classList.add('selected');
    });
    
    // Double click - open
    icon.addEventListener('dblclick', (e) => {
      e.stopPropagation();
      const iconName = icon.dataset.name;
      showToast(`${iconName} opened (simulated)`);
    });
    
    // Right click - context menu
    icon.addEventListener('contextmenu', (e) => {
      e.preventDefault();
      e.stopPropagation();
      
      // Select this icon
      $$('.desktop-icon').forEach(i => i.classList.remove('selected'));
      icon.classList.add('selected');
      
      // Show context menu
      const rect = icon.getBoundingClientRect();
      const contextMenu = $('#startContext').cloneNode(true);
      contextMenu.id = 'desktopContext';
      contextMenu.style.left = `${rect.left}px`;
      contextMenu.style.top = `${rect.top + 86}px`;
      contextMenu.style.display = 'block';
      
      // Update context menu items for desktop
      $$('.context-menu-item', contextMenu).forEach(item => {
        if (item.dataset.action === 'taskmgr') {
          item.style.background = '';
        }
      });
      
      document.body.appendChild(contextMenu);
      
      // Close menu when clicking elsewhere
      const closeMenu = () => {
        if (contextMenu && contextMenu.parentNode) {
          contextMenu.parentNode.removeChild(contextMenu);
        }
        document.removeEventListener('click', closeMenu);
      };
      
      setTimeout(() => {
        document.addEventListener('click', closeMenu);
      }, 100);
    });
  });
  
  // Click on desktop background to deselect icons
  document.addEventListener('click', (e) => {
    if (!e.target.closest('.desktop-icon') && !e.target.closest('#desktop')) {
      $$('.desktop-icon').forEach(icon => icon.classList.remove('selected'));
    }
  });
}

// ========== LAB CONTROLS ==========
function initLabControls() {
  // Reset Lab button
  $('#resetLab').addEventListener('click', () => {
    showToast('Resetting lab simulation...');
    
    // Reload the page after a delay
    setTimeout(() => {
      location.reload();
    }, 800);
  });
  
  // Exit Simulation button
  $('#closeBrowser').addEventListener('click', () => {
    showToast('Exiting simulation...');
    
    // Show completion screen
    setTimeout(() => {
      document.body.innerHTML = `
        <div style="display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100vh; background: linear-gradient(135deg, #1A1F35 0%, #2A2F45 100%); color: white; text-align: center; padding: 40px;">
          <div style="font-size: 72px; margin-bottom: 24px;">üéâ</div>
          <h1 style="margin-bottom: 16px; font-size: 32px; font-weight: 600;">Lab Completed Successfully!</h1>
          <p style="margin-bottom: 32px; font-size: 18px; opacity: 0.9; max-width: 600px; line-height: 1.6;">
            You have successfully terminated the unresponsive PhotoViewer.exe process using Windows Task Manager.
          </p>
          <div style="display: flex; gap: 16px; margin-bottom: 48px;">
            <div style="background: rgba(255, 255, 255, 0.1); padding: 16px; border-radius: 12px; min-width: 160px;">
              <div style="font-size: 24px; margin-bottom: 8px;">üß∞</div>
              <div style="font-size: 14px; opacity: 0.9;">Task Manager</div>
              <div style="font-size: 20px; font-weight: 600;">Mastered</div>
            </div>
            <div style="background: rgba(255, 255, 255, 0.1); padding: 16px; border-radius: 12px; min-width: 160px;">
              <div style="font-size: 24px; margin-bottom: 8px;">‚ö°</div>
              <div style="font-size: 14px; opacity: 0.9;">System Recovery</div>
              <div style="font-size: 20px; font-weight: 600;">Achieved</div>
            </div>
            <div style="background: rgba(255, 255, 255, 0.1); padding: 16px; border-radius: 12px; min-width: 160px;">
              <div style="font-size: 24px; margin-bottom: 8px;">üñ•Ô∏è</div>
              <div style="font-size: 14px; opacity: 0.9;">Windows 11</div>
              <div style="font-size: 20px; font-weight: 600;">Simulated</div>
            </div>
          </div>
          <button onclick="location.reload()" style="background: var(--win-accent); color: white; border: none; padding: 16px 40px; border-radius: 8px; font-size: 16px; font-weight: 600; cursor: pointer; transition: all 0.2s; box-shadow: 0 4px 20px rgba(0, 120, 212, 0.4);">
            <i class="fas fa-redo" style="margin-right: 8px;"></i>
            Restart Lab
          </button>
          <div style="margin-top: 32px; font-size: 14px; opacity: 0.7;">
            Windows 11 Task Manager Lab Simulation ‚Ä¢ Created for educational purposes
          </div>
        </div>
      `;
    }, 1000);
  });
}

// ========== KEYBOARD SHORTCUTS ==========
function initKeyboardShortcuts() {
  document.addEventListener('keydown', (e) => {
    // Ctrl+Shift+Esc - Open Task Manager
    if (e.ctrlKey && e.shiftKey && e.key === 'Escape') {
      e.preventDefault();
      openTaskManager();
      showToast('Task Manager opened (Ctrl+Shift+Esc)');
    }
    
    // Win key - Toggle Start Menu
    if (e.key === 'Meta' || e.key === 'Win') {
      e.preventDefault();
      $('#startButton').click();
    }
    
    // Win+D - Show Desktop
    if (e.key === 'd' && e.metaKey) {
      e.preventDefault();
      $$('.window, .unresponsive-window').forEach(win => {
        if (win.style.display !== 'none') {
          win.style.display = 'none';
        }
      });
      showToast('Desktop shown (Win+D)');
    }
    
    // Win+R - Run dialog
    if (e.key === 'r' && e.metaKey) {
      e.preventDefault();
      showToast('Run dialog opened (Win+R)');
    }
    
    // Alt+F4 - Close active window
    if (e.altKey && e.key === 'F4') {
      e.preventDefault();
      const windows = $$('.window, .unresponsive-window').filter(win => 
        win.style.display !== 'none' && parseInt(win.style.zIndex) === 200
      );
      
      if (windows.length > 0) {
        windows[0].style.display = 'none';
        showToast('Window closed (Alt+F4)');
      }
    }
    
    // Escape - Close menus
    if (e.key === 'Escape') {
      $('#startMenu').style.display = 'none';
      $('#startContext').style.display = 'none';
      $('#calendarPopover').style.display = 'none';
      $('#keyboardHint').style.display = 'none';
    }
  });
}

// ========== INITIALIZATION ==========
function init() {
  // Initialize all components
  initWindowInteractions();
  initWindowControls();
  initTaskbar();
  initTaskManager();
  initDesktopIcons();
  initLabControls();
  initKeyboardShortcuts();
  
  // Show initial instructions
  showToast('Right-click the Start button and select Task Manager to begin the lab ‚Ä¢ Press ? for keyboard shortcuts', 5000);
  
  // Make sure instructions window is visible and on top
  const instructionsWindow = $('#instructionsWindow');
  instructionsWindow.style.display = 'flex';
  bringWindowToFront(instructionsWindow);
  
  // Update calendar initially
  updateCalendar();
  
  // Update CPU usage initially
  updateCpuUsage();
}

// Start everything when page loads
document.addEventListener('DOMContentLoaded', init);

// Prevent context menu on the whole page (except where needed)
document.addEventListener('contextmenu', (e) => {
  // Allow context menu on start button, desktop icons, and taskbar icons
  if (!e.target.closest('#startButton') && 
      !e.target.closest('.desktop-icon') && 
      !e.target.closest('.taskbar-icon') &&
      !e.target.closest('#systemTray')) {
    e.preventDefault();
  }
});
</script>
</body>
</html>