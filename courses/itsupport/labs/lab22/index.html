<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lab 22: Reset a User Password</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            background-color: #f0f0f0;
        }
        .sidebar {
            background-color: #ffffff;
            border-right: 1px solid #d1d5db;
            height: calc(100vh - 6rem);
            overflow-y: auto;
        }
        .tree-node {
            padding: 4px 8px;
            cursor: pointer;
            user-select: none;
        }
        .tree-node:hover {
            background-color: #e5f0ff;
        }
        .tree-node.active {
            background-color: #0078d4;
            color: white;
        }
        .table-header {
            background-color: #f8f9fa;
            border-bottom: 1px solid #d1d5db;
        }
        .table-row:hover {
            background-color: #f1f5f9;
        }
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            justify-content: center;
            align-items: center;
        }
        .modal-content {
            background-color: white;
            padding: 20px;
            border-radius: 5px;
            width: 400px;
        }
        .toast {
            display: none;
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background-color: #28a745;
            color: white;
            padding: 10px 20px;
            border-radius: 5px;
            z-index: 1000;
        }
        .instructions-panel {
            background-color: #ffffff;
            border: 1px solid #d1d5db;
            border-radius: 5px;
            padding: 15px;
            margin-bottom: 10px;
        }
        .task-list li {
            margin-bottom: 10px;
        }
        .context-menu {
            position: absolute;
            background-color: white;
            border: 1px solid #d1d5db;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
            z-index: 1000;
            min-width: 150px;
        }
        .context-menu-item {
            padding: 8px 12px;
            cursor: pointer;
        }
        .context-menu-item:hover {
            background-color: #e5f0ff;
        }
    </style>
</head>
<body class="flex flex-col h-screen">
    <!-- Header -->
    <header class="bg-white shadow-sm p-2">
        <h1 class="text-lg font-semibold text-gray-800">Active Directory Users and Computers - Blockshell.app</h1>
    </header>

    <!-- Toolbar -->
    <div class="bg-gray-100 p-2 border-b border-gray-300"></div>

    <!-- Main Content -->
    <div class="flex flex-1 overflow-hidden">
        <!-- Sidebar: Instructions -->
        <div class="w-1/4 sidebar p-4">
            <div class="instructions-panel">
                <h2 class="text-lg font-semibold mb-4">Lab Instructions — Reset a User Password</h2>
                <p class="mb-4">Use Active Directory Users and Computers (ADUC) to reset the password for <strong>Ethan Carter</strong> (Corporate > Finance) and require a password change at next logon (include Unlock account if needed).</p>
                <ul class="task-list list-disc pl-5">
                    <li>Click Blockshell.app to expand the domain structure.</li>
                    <li>Expand Corporate > Finance in the tree view.</li>
                    <li>Right-click <strong>Ethan Carter</strong> in the object list and select "Reset Password…".</li>
                    <li>Enter and confirm a new password. Check "User must change password at next logon" (and "Unlock account" if required). Click OK.</li>
                    <li>Observe the green success toast at the bottom.</li>
                </ul>
                <div class="flex justify-between mt-4">
                    <button class="bg-blue-600 text-white px-4 py-2 rounded" onclick="resetLab()">Reset Lab</button>
                    <button class="bg-gray-300 px-4 py-2 rounded" onclick="closeLab()">Close Lab</button>
                </div>
            </div>
            <div class="text-sm text-gray-600">Tip: Click the time at the bottom-right to open the popup calendar.</div>
        </div>

        <!-- Main Panel: AD Tree and Object List -->
        <div class="flex-1 p-4 bg-white">
            <div class="flex h-full">
                <!-- AD Tree -->
                <div class="w-1/3 border-r border-gray-300 pr-4">
                    <div id="treeView">
                        <div class="tree-node active" data-path="" onclick="toggleNode(this)">📁 Blockshell.app</div>
                        <div class="pl-4 hidden" data-child="">
                            <div class="tree-node" data-path="Administration" onclick="toggleNode(this)">📁 Administration</div>
                            <div class="pl-8 hidden" data-child="Administration">
                                <div class="tree-node" data-path="Administration/Service Accounts" onclick="selectNode(this)">📁 Service Accounts</div>
                            </div>
                            <div class="tree-node" data-path="Corporate" onclick="toggleNode(this)">📁 Corporate</div>
                            <div class="pl-8 hidden" data-child="Corporate">
                                <div class="tree-node" data-path="Corporate/Finance" onclick="selectNode(this)">📁 Finance</div>
                                <div class="tree-node" data-path="Corporate/Human Resources" onclick="selectNode(this)">📁 Human Resources</div>
                            </div>
                            <div class="tree-node" data-path="Builtin" onclick="selectNode(this)">📁 Builtin</div>
                            <div class="tree-node" data-path="Computers" onclick="toggleNode(this)">📁 Computers</div>
                            <div class="pl-8 hidden" data-child="Computers">
                                <div class="tree-node" data-path="Computers/Workstations" onclick="selectNode(this)">📁 Workstations</div>
                                <div class="tree-node" data-path="Computers/Servers" onclick="selectNode(this)">📁 Servers</div>
                            </div>
                            <div class="tree-node" data-path="Domain Controllers" onclick="selectNode(this)">📁 Domain Controllers</div>
                            <div class="tree-node" data-path="ForeignSecurityPrincipals" onclick="selectNode(this)">📁 ForeignSecurityPrincipals</div>
                            <div class="tree-node" data-path="ITEC_Import" onclick="toggleNode(this)">📁 ITEC_Import</div>
                            <div class="pl-8 hidden" data-child="ITEC_Import">
                                <div class="tree-node" data-path="ITEC_Import/Development" onclick="selectNode(this)">📁 Development</div>
                            </div>
                            <div class="tree-node" data-path="Managed Service Accounts" onclick="selectNode(this)">📁 Managed Service Accounts</div>
                            <div class="tree-node" data-path="Users" onclick="selectNode(this)">📁 Users</div>
                        </div>
                    </div>
                </div>

                <!-- Object List -->
                <div class="flex-1 pl-4">
                    <table id="objectTable" class="w-full text-sm text-left text-gray-700">
                        <thead class="table-header">
                            <tr>
                                <th class="p-2">Name</th>
                                <th class="p-2">Type</th>
                                <th class="p-2">Description</th>
                            </tr>
                        </thead>
                        <tbody id="objectTableBody"></tbody>
                    </table>
                    <div id="objectCount" class="mt-2 text-sm text-gray-600">Select a container to view its contents.</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Context Menu -->
    <div id="contextMenu" class="context-menu hidden">
        <div class="context-menu-item" onclick="openResetPasswordModal()">Reset Password…</div>
    </div>

    <!-- Modal for New Object -->
    <div id="newObjectModal" class="modal">
        <div class="modal-content">
            <h2 class="text-lg font-semibold mb-4">New Object</h2>
            <label class="block mb-2">Object Name:</label>
            <input id="newObjectName" type="text" class="w-full border border-gray-300 rounded px-2 py-1 mb-4">
            <label class="block mb-2">Object Type:</label>
            <select id="newObjectType" class="w-full border border-gray-300 rounded px-2 py-1 mb-4">
                <option value="Organizational Unit">Organizational Unit</option>
                <option value="Container">Container</option>
                <option value="Security Group">Security Group</option>
                <option value="User">User</option>
                <option value="Computer">Computer</option>
            </select>
            <label class="block mb-2">Description:</label>
            <textarea id="newObjectDescription" class="w-full border border-gray-300 rounded px-2 py-1 mb-4"></textarea>
            <div class="flex justify-end space-x-2">
                <button class="bg-gray-300 px-4 py-2 rounded" onclick="closeModal()">Cancel</button>
                <button class="bg-blue-600 text-white px-4 py-2 rounded" onclick="createObject()">Create</button>
            </div>
        </div>
    </div>

    <!-- Modal for Reset Password -->
    <div id="resetPasswordModal" class="modal">
        <div class="modal-content">
            <h2 class="text-lg font-semibold mb-4">Reset Password for <span id="resetUserName"></span></h2>
            <label class="block mb-2">New password:</label>
            <input id="newPassword" type="password" class="w-full border border-gray-300 rounded px-2 py-1 mb-4">
            <label class="block mb-2">Confirm password:</label>
            <input id="confirmPassword" type="password" class="w-full border border-gray-300 rounded px-2 py-1 mb-4">
            <label class="flex items-center mb-4">
                <input id="changePasswordNextLogon" type="checkbox" class="mr-2">
                User must change password at next logon
            </label>
            <label class="flex items-center mb-4">
                <input id="unlockAccount" type="checkbox" class="mr-2">
                Unlock account
            </label>
            <p id="passwordError" class="text-red-500 text-sm hidden">Passwords do not match.</p>
            <div class="flex justify-end space-x-2">
                <button class="bg-gray-300 px-4 py-2 rounded" onclick="closeResetPasswordModal()">Cancel</button>
                <button class="bg-blue-600 text-white px-4 py-2 rounded" onclick="resetPassword()">OK</button>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="toast">Password reset successfully!</div>

    <!-- Date and Time Display -->
    <div class="fixed bottom-4 right-4 text-sm text-gray-600 cursor-pointer" onclick="toggleCalendar()">
        <span id="currentTime">--:--</span>
        <span id="currentDate">-- ---, ----</span>
    </div>

    <!-- Calendar Modal -->
    <div id="calendarModal" class="modal">
        <div class="modal-content">
            <div class="flex justify-between mb-4">
                <button onclick="prevMonth()">‹</button>
                <span id="calendarMonthYear">Month Year</span>
                <button onclick="nextMonth()">›</button>
            </div>
            <table class="w-full text-sm">
                <thead>
                    <tr>
                        <th>Su</th><th>Mo</th><th>Tu</th><th>We</th><th>Th</th><th>Fr</th><th>Sa</th>
                    </tr>
                </thead>
                <tbody id="calendarBody"></tbody>
            </table>
            <div class="flex justify-end mt-4">
                <button class="bg-gray-300 px-4 py-2 rounded" onclick="toggleCalendar()">Close</button>
            </div>
        </div>
    </div>

    <script>
        let currentPath = '';
        let history = [''];
        let historyIndex = 0;
        let objects = [
            { name: 'Administration', type: 'Organizational Unit', description: 'Administrative accounts and groups', path: 'Administration' },
            { name: 'Service Accounts', type: 'Organizational Unit', description: 'Service account management', path: 'Administration/Service Accounts' },
            { name: 'svc_sql', type: 'User', description: 'SQL Server service account', path: 'Administration/Service Accounts/svc_sql' },
            { name: 'svc_web', type: 'User', description: 'Web server service account', path: 'Administration/Service Accounts/svc_web' },
            { name: 'Corporate', type: 'Organizational Unit', description: 'Corporate Domain Objects', path: 'Corporate' },
            { name: 'Finance', type: 'Organizational Unit', description: 'Finance department objects', path: 'Corporate/Finance' },
            { name: 'Ethan Carter', type: 'User', description: 'Finance Director', path: 'Corporate/Finance/Ethan Carter', locked: true },
            { name: 'Marcus Patel', type: 'User', description: 'Finance Manager', path: 'Corporate/Finance/Marcus Patel' },
            { name: 'Finance Admins', type: 'Security Group', description: 'Finance department administrators', path: 'Corporate/Finance/Finance Admins' },
            { name: 'Human Resources', type: 'Organizational Unit', description: 'HR department objects', path: 'Corporate/Human Resources' },
            { name: 'Daniel Novak', type: 'User', description: 'HR Director', path: 'Corporate/Human Resources/Daniel Novak' },
            { name: 'Sophia Kim', type: 'User', description: 'HR Manager', path: 'Corporate/Human Resources/Sophia Kim' },
            { name: 'HR Staff', type: 'Security Group', description: 'HR department staff group', path: 'Corporate/Human Resources/HR Staff' },
            { name: 'Builtin', type: 'builtinDomain', description: 'Built-in security principals', path: 'Builtin' },
            { name: 'Administrators', type: 'Security Group', description: 'Built-in Administrators group', path: 'Builtin/Administrators' },
            { name: 'Guests', type: 'Security Group', description: 'Built-in Guests group', path: 'Builtin/Guests' },
            { name: 'Computers', type: 'Container', description: 'Default container for upgraded computer accounts', path: 'Computers' },
            { name: 'Workstations', type: 'Organizational Unit', description: 'Workstation computers', path: 'Computers/Workstations' },
            { name: 'WKSTN001', type: 'Computer', description: 'Employee Workstation', path: 'Computers/Workstations/WKSTN001' },
            { name: 'WKSTN002', type: 'Computer', description: 'Employee Workstation', path: 'Computers/Workstations/WKSTN002' },
            { name: 'Servers', type: 'Organizational Unit', description: 'Server computers', path: 'Computers/Servers' },
            { name: 'SRV001', type: 'Computer', description: 'File Server', path: 'Computers/Servers/SRV001' },
            { name: 'SRV002', type: 'Computer', description: 'Application Server', path: 'Computers/Servers/SRV002' },
            { name: 'Domain Controllers', type: 'Organizational Unit', description: 'Default container for domain controllers', path: 'Domain Controllers' },
            { name: 'DC01', type: 'Computer', description: 'Primary Domain Controller', path: 'Domain Controllers/DC01' },
            { name: 'DC02', type: 'Computer', description: 'Secondary Domain Controller', path: 'Domain Controllers/DC02' },
            { name: 'ForeignSecurityPrincipals', type: 'Container', description: 'Default container for security principals', path: 'ForeignSecurityPrincipals' },
            { name: 'ExtPartner1', type: 'Security Group', description: 'External Partner Group', path: 'ForeignSecurityPrincipals/ExtPartner1' },
            { name: 'ITEC_Import', type: 'Organizational Unit', description: 'Imported IT objects', path: 'ITEC_Import' },
            { name: 'Development', type: 'Organizational Unit', description: 'Development team objects', path: 'ITEC_Import/Development' },
            { name: 'Oliver Rossi', type: 'User', description: 'Lead Developer', path: 'ITEC_Import/Development/Oliver Rossi' },
            { name: 'Layla Ahmed', type: 'User', description: 'Senior Developer', path: 'ITEC_Import/Development/Layla Ahmed' },
            { name: 'Chloe Bennett', type: 'User', description: 'Developer', path: 'ITEC_Import/Development/Chloe Bennett' },
            { name: 'Ryan Fischer', type: 'User', description: 'Developer', path: 'ITEC_Import/Development/Ryan Fischer' },
            { name: 'Dev Team', type: 'Security Group', description: 'Development team group', path: 'ITEC_Import/Development/Dev Team' },
            { name: 'Managed Service Accounts', type: 'Container', description: 'Default container for managed service accounts', path: 'Managed Service Accounts' },
            { name: 'msa_app1', type: 'User', description: 'Managed Service Account for App1', path: 'Managed Service Accounts/msa_app1' },
            { name: 'Users', type: 'Container', description: 'Default container for upgraded user accounts', path: 'Users' },
            { name: 'Guest', type: 'User', description: 'Default Guest Account', path: 'Users/Guest' }
        ];

        function toggleNode(element) {
            const childDiv = document.querySelector(`[data-child="${element.dataset.path}"]`);
            if (childDiv) {
                childDiv.classList.toggle('hidden');
            }
            selectNode(element);
        }

        function selectNode(element) {
            document.querySelectorAll('.tree-node').forEach(n => n.classList.remove('active'));
            element.classList.add('active');
            currentPath = element.dataset.path === '' ? '' : element.dataset.path;
            history = history.slice(0, historyIndex + 1);
            history.push(currentPath);
            historyIndex++;
            updateObjectTable();
        }

        function updateObjectTable() {
            const tbody = document.getElementById('objectTableBody');
            const objectCount = document.getElementById('objectCount');
            tbody.innerHTML = '';
            if (!currentPath) {
                objectCount.textContent = 'Select a container to view its contents.';
                return;
            }
            const filteredObjects = objects.filter(obj => obj.path.startsWith(currentPath) && obj.path !== currentPath);
            filteredObjects.forEach(obj => {
                const row = document.createElement('tr');
                row.className = 'table-row';
                row.dataset.name = obj.name;
                row.dataset.path = obj.path;
                const icon = obj.type === 'User' ? '👤' : obj.type === 'Computer' ? '💻' : obj.type === 'Security Group' ? '👥' : '📁';
                row.innerHTML = `
                    <td class="p-2">${icon} ${obj.name}${obj.locked ? ' 🔒' : ''}</td>
                    <td class="p-2">${obj.type}</td>
                    <td class="p-2">${obj.description}</td>
                `;
                row.addEventListener('click', () => {
                    document.querySelectorAll('.table-row').forEach(r => r.classList.remove('bg-blue-100'));
                    row.classList.add('bg-blue-100');
                });
                row.addEventListener('contextmenu', (e) => {
                    e.preventDefault();
                    if (obj.type === 'User') {
                        showContextMenu(e, obj);
                    }
                });
                tbody.appendChild(row);
            });
            objectCount.textContent = `${filteredObjects.length} object(s)`;
        }

        function showContextMenu(e, obj) {
            const contextMenu = document.getElementById('contextMenu');
            contextMenu.style.top = `${e.pageY}px`;
            contextMenu.style.left = `${e.pageX}px`;
            contextMenu.classList.remove('hidden');
            contextMenu.dataset.path = obj.path;
            document.addEventListener('click', hideContextMenu, { once: true });
        }

        function hideContextMenu() {
            document.getElementById('contextMenu').classList.add('hidden');
        }

        function navigateBack() {
            if (historyIndex > 0) {
                historyIndex--;
                currentPath = history[historyIndex];
                updateTreeSelection();
                updateObjectTable();
            }
        }

        function navigateForward() {
            if (historyIndex < history.length - 1) {
                historyIndex++;
                currentPath = history[historyIndex];
                updateTreeSelection();
                updateObjectTable();
            }
        }

        function navigateUp() {
            const parentPath = currentPath.split('/').slice(0, -1).join('/');
            if (parentPath !== currentPath) {
                currentPath = parentPath || '';
                history = history.slice(0, historyIndex + 1);
                history.push(currentPath);
                historyIndex++;
                updateTreeSelection();
                updateObjectTable();
            }
        }

        function updateTreeSelection() {
            document.querySelectorAll('.tree-node').forEach(n => n.classList.remove('active'));
            const node = document.querySelector(`.tree-node[data-path="${currentPath}"]`);
            if (node) node.classList.add('active');
        }

        function openNewObjectModal() {
            if (!currentPath) {
                alert('Please select a container first.');
                return;
            }
            document.getElementById('newObjectModal').style.display = 'flex';
        }

        function closeModal() {
            document.getElementById('newObjectModal').style.display = 'none';
            document.getElementById('newObjectName').value = '';
            document.getElementById('newObjectDescription').value = '';
        }

        function createObject() {
            const name = document.getElementById('newObjectName').value;
            const type = document.getElementById('newObjectType').value;
            const description = document.getElementById('newObjectDescription').value;
            if (name && currentPath) {
                const newPath = currentPath + '/' + name;
                objects.push({ name, type, description, path: newPath });
                if (type === 'Organizational Unit') {
                    const treeView = document.getElementById('treeView');
                    const childDiv = document.querySelector(`[data-child="${currentPath}"]`) || document.createElement('div');
                    childDiv.className = `pl-${currentPath.split('/').length * 4 + 4}`;
                    childDiv.dataset.child = currentPath;
                    const newNode = document.createElement('div');
                    newNode.className = 'tree-node';
                    newNode.dataset.path = newPath;
                    newNode.innerHTML = `📁 ${name}`;
                    newNode.onclick = () => toggleNode(newNode);
                    childDiv.appendChild(newNode);
                    if (!document.querySelector(`[data-child="${currentPath}"]`)) {
                        const parentNode = document.querySelector(`[data-path="${currentPath}"]`).parentNode;
                        parentNode.appendChild(childDiv);
                    }
                }
                updateObjectTable();
                closeModal();
            }
        }

        function deleteObject() {
            const selectedRow = document.querySelector('.table-row.bg-blue-100');
            if (selectedRow) {
                const path = selectedRow.dataset.path;
                objects = objects.filter(obj => !obj.path.startsWith(path + '/'));
                updateObjectTable();
            }
        }

        function openResetPasswordModal() {
            const selectedRow = document.querySelector('.table-row.bg-blue-100') || document.querySelector(`tr[data-path="${document.getElementById('contextMenu').dataset.path || ''}"]`);
            if (selectedRow) {
                const path = selectedRow.dataset.path;
                const obj = objects.find(o => o.path === path);
                if (obj && obj.type === 'User') {
                    document.getElementById('resetUserName').textContent = obj.name;
                    document.getElementById('newPassword').value = '';
                    document.getElementById('confirmPassword').value = '';
                    document.getElementById('changePasswordNextLogon').checked = false;
                    document.getElementById('unlockAccount').checked = obj.locked || false;
                    document.getElementById('passwordError').classList.add('hidden');
                    document.getElementById('resetPasswordModal').style.display = 'flex';
                    hideContextMenu();
                }
            }
        }

        function closeResetPasswordModal() {
            document.getElementById('resetPasswordModal').style.display = 'none';
        }

        function resetPassword() {
            const newPassword = document.getElementById('newPassword').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            if (newPassword === confirmPassword && newPassword.length > 0) {
                const selectedRow = document.querySelector('.table-row.bg-blue-100') || document.querySelector(`tr[data-path="${document.getElementById('contextMenu').dataset.path || ''}"]`);
                if (selectedRow) {
                    const path = selectedRow.dataset.path;
                    const objIndex = objects.findIndex(o => o.path === path);
                    if (objIndex !== -1) {
                        objects[objIndex].locked = false;
                        showToast();
                        closeResetPasswordModal();
                        updateObjectTable();
                    }
                }
            } else if (newPassword !== confirmPassword) {
                document.getElementById('passwordError').classList.remove('hidden');
            }
        }

        function showToast() {
            const toast = document.getElementById('toast');
            toast.style.display = 'block';
            setTimeout(() => {
                toast.style.display = 'none';
            }, 3000);
        }

        function resetLab() {
            // Ensure the target user (Ethan Carter) is locked again
            objects = objects.map(obj => {
                if (obj.path === 'Corporate/Finance/Ethan Carter') {
                    return { ...obj, locked: true };
                }
                return obj;
            });
            currentPath = '';
            history = [''];
            historyIndex = 0;
            document.querySelectorAll('[data-child]').forEach(child => child.classList.add('hidden'));
            updateTreeSelection();
            updateObjectTable();
        }

        function closeLab() {
            window.close();
        }

        function refreshView() {
            updateObjectTable();
        }

        // Date and Time
        function updateTime() {
            const now = new Date('2025-09-20T20:58:00Z'); // 09:58 PM BST
            const timeString = now.toLocaleTimeString('en-GB', { hour12: true, hour: '2-digit', minute: '2-digit' });
            const dateString = now.toLocaleDateString('en-GB', { weekday: 'short', day: '2-digit', month: 'short', year: 'numeric' });
            document.getElementById('currentTime').textContent = timeString;
            document.getElementById('currentDate').textContent = dateString;
        }

        let currentMonth = 8; // September
        let currentYear = 2025;

        function updateCalendar() {
            const monthYear = document.getElementById('calendarMonthYear');
            const calendarBody = document.getElementById('calendarBody');
            monthYear.textContent = `${new Date(currentYear, currentMonth).toLocaleString('en-GB', { month: 'long' })} ${currentYear}`;
            calendarBody.innerHTML = '';
            const firstDay = new Date(currentYear, currentMonth, 1).getDay();
            const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();
            let row = document.createElement('tr');
            for (let i = 0; i < firstDay; i++) {
                row.innerHTML += '<td></td>';
            }
            for (let day = 1; day <= daysInMonth; day++) {
                if ((firstDay + day - 1) % 7 === 0 && day !== 1) {
                    calendarBody.appendChild(row);
                    row = document.createElement('tr');
                }
                const cellClass = day === 20 ? ' bg-blue-200' : '';
                row.innerHTML += `<td class="p-1 text-center${cellClass}">${day}</td>`;
            }
            calendarBody.appendChild(row);
        }

        function toggleCalendar() {
            const calendarModal = document.getElementById('calendarModal');
            calendarModal.style.display = calendarModal.style.display === 'flex' ? 'none' : 'flex';
            if (calendarModal.style.display === 'flex') updateCalendar();
        }

        function prevMonth() {
            currentMonth--;
            if (currentMonth < 0) {
                currentMonth = 11;
                currentYear--;
            }
            updateCalendar();
        }

        function nextMonth() {
            currentMonth++;
            if (currentMonth > 11) {
                currentMonth = 0;
                currentYear++;
            }
            updateCalendar();
        }

        // Initialize
        updateTime();
        updateObjectTable();
        resetLab();
    </script>
</body>
</html>
