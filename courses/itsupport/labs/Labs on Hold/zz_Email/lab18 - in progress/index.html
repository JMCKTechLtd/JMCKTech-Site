<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Lab 18: Outlook - Send As</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Segoe+UI+Variable:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://res.cdn.office.net/owamail/2025-11-10/css/fluent-icons.css" />
  <style>
    :root {
      --ms-blue: #0078D4;
      --ms-blue-dark: #106EBE;
      --ms-gray-20: #F5F5F5;
      --ms-gray-130: #3B3A39;
      --ms-gray-160: #605E5C;
      --ms-gray-200: #7A7574;
      --ms-success: #107C10;
      --ms-focus: #0078D4;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0; padding: 0; background: #FAFAFA; font-family: 'Segoe UI Variable', 'Segoe UI', system-ui, sans-serif;
      color: #252424; line-height: 1.5; height: 100vh; display: flex; flex-direction: column;
    }

    /* Header - Exact OWA */
    .owa-header {
      background: white; border-bottom: 1px solid #E1E1E1; height: 50px; display: flex; align-items: center;
      padding: 0 16px; gap: 16px; font-size: 14px; z-index: 100;
    }
    .owa-header .logo { font-weight: 600; color: var(--ms-blue); }
    .owa-header .user-menu {
      margin-left: auto; display: flex; align-items: center; gap: 8px; cursor: pointer;
    }
    .owa-header .avatar {
      width: 32px; height: 32px; border-radius: 50%; background: #6264A7; color: white;
      display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 13px;
    }

    /* Ribbon */
    .ribbon {
      background: #F3F2F1; border-bottom: 1px solid #E1E1E1; padding: 8px 12px; display: flex; gap: 8px;
    }
    .ribbon button {
      background: white; border: 1px solid #8A8886; border-radius: 4px; padding: 6px 12px;
      font-size: 13px; font-weight: 600; cursor: pointer; display: flex; align-items: center; gap: 6px;
      transition: all 0.15s ease;
    }
    .ribbon button:hover { background: #EDEBE9; }
    .ribbon button:active { background: #E1DFDD; }
    .ribbon button i { font-size: 16px; }

    /* Layout */
    .main {
      flex: 1; display: flex; background: #E1E1E1; overflow: hidden;
    }
    .folder-pane {
      width: 200px; background: white; border-right: 1px solid #E1E1E1;
    }
    .folder-pane h3 {
      padding: 12px 16px 4px; font-size: 11px; font-weight: 600; text-transform: uppercase; color: #605E5C; letter-spacing: 0.5px;
    }
    .folder-pane ul { list-style: none; padding: 0; margin: 0; }
    .folder-pane li {
      padding: 6px 16px; font-size: 13px; display: flex; align-items: center; gap: 8px; cursor: pointer;
      user-select: none;
    }
    .folder-pane li:hover { background: #F3F2F1; }
    .folder-pane li.selected { background: #DEECF9; color: var(--ms-blue); font-weight: 600; }
    .folder-pane li i { font-size: 16px; width: 20px; }
    .folder-pane .count {
      margin-left: auto; background: #C8C8C8; color: #252424; font-size: 11px; padding: 0 6px; border-radius: 10px; min-width: 18px; text-align: center;
    }
    .folder-pane .unread { font-weight: 600; }
    .folder-pane .shared { color: #5B5B5B; }

    .message-list {
      width: 320px; background: white; border-right: 1px solid #E1E1E1; display: flex; flex-direction: column;
    }
    .message-list-header {
      padding: 8px 12px; font-size: 12px; color: #605E5C; border-bottom: 1px solid #E1E1E1; display: flex; gap: 12px;
    }
    .message-list-header span:hover { color: var(--ms-blue); cursor: pointer; text-decoration: underline; }
    .message-list-header .active { color: var(--ms-blue); font-weight: 600; }
    .messages {
      flex: 1; overflow-y: auto;
    }
    .message-item {
      padding: 10px 12px; border-bottom: 1px solid #F3F2F1; cursor: pointer; position: relative;
      transition: background 0.15s ease;
    }
    .message-item:hover { background: #F9F9F9; }
    .message-item.selected { background: #DEECF9; }
    .message-item.unread { font-weight: 600; }
    .message-item.unread::before {
      content: ''; position: absolute; left: 0; top: 8px; bottom: 8px; width: 4px; background: var(--ms-blue);
    }
    .message-item .sender { font-size: 13px; margin-bottom: 2px; }
    .message-item .subject { font-size: 13px; color: #252424; }
    .message-item .preview { font-size: 12px; color: #605E5C; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
    .message-item .time {
      position: absolute; right: 12px; top: 10px; font-size: 11px; color: #605E5C;
    }
    .message-item .attachment { margin-left: 4px; color: #605E5C; }

    .reading-pane {
      flex: 1; background: white; display: flex; flex-direction: column;
    }
    .lab-instructions {
      padding: 32px; flex: 1; overflow-y: auto;
    }
    .lab-badge {
      display: inline-block; background: #E5F3FF; color: #0078D4; padding: 4px 12px; border-radius: 16px;
      font-size: 12px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px;
    }
    .lab-title {
      font-size: 28px; font-weight: 600; margin: 16px 0 8px; color: #252424;
    }
    .lab-desc {
      font-size: 15px; color: #605E5C; margin-bottom: 24px;
    }
    .steps {
      display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 16px;
    }
    .step {
      background: #F9F9F9; border: 1px solid #E1E1E1; border-radius: 8px; padding: 20px;
      position: relative; counter-increment: step;
    }
    .step::before {
      content: counter(step); position: absolute; left: -12px; top: 16px;
      background: var(--ms-blue); color: white; width: 28px; height: 28px; border-radius: 50%;
      display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 14px;
    }
    .step b { color: var(--ms-blue); }

    /* Compose Dialog */
    .overlay { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.5); backdrop-filter: blur(4px); z-index: 1000; }
    .compose-dialog {
      position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%) scale(0.95);
      width: 90%; max-width: 800px; background: white; border-radius: 8px; box-shadow: 0 25px 50px rgba(0,0,0,0.3);
      display: none; flex-direction: column; max-height: 90vh; z-index: 1001; opacity: 0; transition: all 0.2s ease;
    }
    .compose-dialog.open { display: flex; transform: translate(-50%, -50%) scale(1); opacity: 1; }
    .dialog-header {
      padding: 12px 16px; background: #F3F2F1; border-bottom: 1px solid #E1E1E1; font-weight: 600; font-size: 15px;
      display: flex; justify-content: space-between; align-items: center;
    }
    .dialog-header button { background: none; border: none; font-size: 20px; cursor: pointer; padding: 4px; border-radius: 4px; }
    .dialog-header button:hover { background: #E1DFDD; }
    .dialog-body {
      flex: 1; padding: 16px; overflow-y: auto; display: flex; flex-direction: column; gap: 12px;
    }
    .field {
      display: flex; align-items: center; gap: 12px; border-bottom: 1px solid #E1E1E1; padding-bottom: 8px;
    }
    .field-label { font-weight: 600; font-size: 13px; width: 60px; color: #252424; }
    .field-input {
      flex: 1; border: none; font-size: 14px; padding: 4px 0; outline: none;
    }
    .field-input:focus { border-bottom: 2px solid var(--ms-blue); padding-bottom: 6px; margin-bottom: -2px; }
    .from-field { position: relative; }
    .from-dropdown {
      background: white; border: 1px solid #8A8886; border-radius: 4px; padding: 8px 12px;
      cursor: pointer; display: flex; justify-content: space-between; align-items: center; font-size: 14px;
    }
    .from-options {
      position: absolute; top: 100%; left: 0; right: 0; background: white; border: 1px solid #8A8886;
      border-radius: 4px; margin-top: 4px; box-shadow: 0 6px 12px rgba(0,0,0,0.15); max-height: 200px; overflow: auto; z-index: 10;
      display: none;
    }
    .from-opt {
      padding: 10px 12px; font-size: 14px; cursor: pointer;
    }
    .from-opt:hover { background: #F3F2F1; }
    .from-opt.delegated { color: #0078D4; font-weight: 600; }
    .from-opt.delegated::before { content: "✓ "; }
    .message-body {
      flex: 1; border: 1px solid #E1E1E1; border-radius: 4px; padding: 12px; font-size: 14px;
      resize: vertical; min-height: 180px; margin-top: 8px;
    }
    .dialog-footer {
      padding: 12px 16px; background: #F3F2F1; border-top: 1px solid #E1E1E1; display: flex; justify-content: space-between; align-items: center;
    }
    .send-btn {
      background: var(--ms-blue); color: white; border: none; border-radius: 4px; padding: 8px 20px;
      font-weight: 600; cursor: pointer; display: flex; align-items: center; gap: 6px;
    }
    .send-btn:disabled { background: #A6A6A6; cursor: not-allowed; }
    .send-btn:hover:not(:disabled) { background: #106EBE; }

    /* Toast */
    .owa-toast {
      position: fixed; bottom: 24px; left: 50%; transform: translateX(-50%);
      background: #107C10; color: white; padding: 12px 24px; border-radius: 4px;
      box-shadow: 0 8px 16px rgba(0,0,0,0.25); font-size: 14px; font-weight: 600;
      display: none; z-index: 2000; align-items: center; gap: 12px; animation: toastIn 0.3s ease;
    }
    @keyframes toastIn { from { transform: translateX(-50%) translateY(100px); opacity: 0; } to { transform: translateX(-50%) translateY(0); opacity: 1; } }

    /* Responsive */
    @media (max-width: 900px) {
      .main { flex-direction: column; }
      .folder-pane, .message-list { width: 100%; max-height: 200px; }
      .steps { grid-template-columns: 1fr; }
    }
  </style>
</head>
<body>

  <!-- Header -->
  <header class="owa-header">
    <div class="logo">Outlook</div>
    <div class="user-menu">
      <span>alex@blockshell.app</span>
      <div class="avatar">AR</div>
    </div>
  </header>

  <!-- Ribbon -->
  <div class="ribbon">
    <button id="newEmailBtn"><i class="ms-Icon ms-Icon--Mail"></i> New message</button>
  </div>

  <div class="main">
    <!-- Folder Pane -->
    <nav class="folder-pane">
      <h3>Folders</h3>
      <ul>
        <li class="selected"><i class="ms-Icon ms-Icon--Inbox"></i> Inbox <span class="count">16</span></li>
        <li><i class="ms-Icon ms-Icon--Send"></i> Sent Items</li>
        <li><i class="ms-Icon ms-Icon--Trash"></i> Deleted Items <span class="count">7</span></li>
        <li><i class="ms-Icon ms-Icon--Draft"></i> Drafts</li>
      </ul>
      <h3>Groups & Shared</h3>
      <ul>
        <li class="shared"><i class="ms-Icon ms-Icon--People"></i> Support Team</li>
        <li class="shared"><i class="ms-Icon ms-Icon--Group"></i> BlockShell Exchange</li>
      </ul>
    </nav>

    <!-- Message List -->
    <section class="message-list">
      <div class="message-list-header">
        <span class="active">All</span>
        <span>Unread</span>
        <span>To Me</span>
      </div>
      <div class="messages" id="emailList">
        <div class="message-item unread" data-email-item>
          <div class="time">12:42</div>
          <div class="sender">Joel McKenzie (BlockShell)</div>
          <div class="subject">Re: BlockShell Pilot for A-Level Students</div>
          <div class="preview">BlockShell_Pilot_Guide.pdf <i class="ms-Icon ms-Icon--Attach attachment"></i></div>
        </div>
        <div class="message-item unread" data-email-item>
          <div class="time">09:15</div>
          <div class="sender">BlockShell Training</div>
          <div class="subject">You’ve been added to the BlockShell Learning Hub</div>
        </div>
        <div class="message-item" data-email-item>
          <div class="time">08:03</div>
          <div class="sender">Support Team</div>
          <div class="subject">Welcome to BlockShell Support Access</div>
          <div class="preview">You can now send as support@blockshell.app…</div>
        </div>
      </div>
    </section>

    <!-- Reading Pane -->
    <section class="reading-pane">
      <div class="lab-instructions">
        <span class="lab-badge">Lab 18</span>
        <h1 class="lab-title">Send As — Shared Mailbox</h1>
        <p class="lab-desc">Master sending emails from a shared mailbox (e.g., support@blockshell.app) using delegated "Send As" permissions. This is standard for team inboxes.</p>
        <div class="steps">
          <div class="step">
            Click <b>New message</b> in the ribbon above.
          </div>
          <div class="step">
            In the compose window, click the <b>From</b> field and select <b>Support Team (support@blockshell.app)</b>.
          </div>
          <div class="step">
            Enter a recipient, subject, and body.
          </div>
          <div class="step">
            Click <b>Send</b> — you should see a green toast confirming it was sent <i>as</i> the shared mailbox.
          </div>
        </div>
      </div>
    </section>
  </div>

  <!-- Compose Dialog -->
  <div class="overlay" id="overlay"></div>
  <div class="compose-dialog" id="compose">
    <div class="dialog-header">
      <span>New Message</span>
      <button id="closeDialog">×</button>
    </div>
    <div class="dialog-body">
      <div class="field from-field">
        <div class="field-label">From</div>
        <div class="from-dropdown" id="fromDropdown">
          <span id="fromText">alex@blockshell.app</span>
          <i class="ms-Icon ms-Icon--ChevronDown"></i>
        </div>
        <div class="from-options" id="fromOptions">
          <div class="from-opt" data-value="alex@blockshell.app">alex@blockshell.app</div>
          <div class="from-opt delegated" data-value="support@blockshell.app">Support Team (support@blockshell.app)</div>
        </div>
      </div>
      <div class="field">
        <div class="field-label">To</div>
        <input type="email" class="field-input" id="toField" placeholder="recipient@example.com" />
      </div>
      <div class="field">
        <div class="field-label">Subject</div>
        <input type="text" class="field-input" id="subjectField" placeholder="" />
      </div>
      <textarea class="message-body" id="bodyField" placeholder="Type your message here..."></textarea>
    </div>
    <div class="dialog-footer">
      <div></div>
      <button class="send-btn" id="sendBtn" disabled>
        <i class="ms-Icon ms-Icon--Send"></i> Send
      </button>
    </div>
  </div>

  <!-- Toast -->
  <div class="owa-toast" id="toast">
    <i class="ms-Icon ms-Icon--CheckMark" style="font-size:18px;"></i>
    Message sent from Support Team (support@blockshell.app)
  </div>

  <script>
    // Realistic Outlook behavior
    document.addEventListener('DOMContentLoaded', () => {
      const overlay = document.getElementById('overlay');
      const compose = document.getElementById('compose');
      const newEmailBtn = document.getElementById('newEmailBtn');
      const closeDialog = document.getElementById('closeDialog');
      const sendBtn = document.getElementById('sendBtn');
      const toast = document.getElementById('toast');

      const fromDropdown = document.getElementById('fromDropdown');
      const fromOptions = document.getElementById('fromOptions');
      const fromText = document.getElementById('fromText');

      const toField = document.getElementById('toField');
      const subjectField = document.getElementById('subjectField');
      const bodyField = document.getElementById('bodyField');

      let selectedFrom = 'alex@blockshell.app';

      const openCompose = () => {
        overlay.style.display = 'block';
        compose.classList.add('open');
        toField.focus();
      };
      const closeCompose = () => {
        overlay.style.display = 'none';
        compose.classList.remove('open');
        fromOptions.style.display = 'none';
        // reset
        selectedFrom = 'alex@blockshell.app';
        fromText.textContent = 'alex@blockshell.app';
        toField.value = subjectField.value = bodyField.value = '';
        validate();
      };

      const validate = () => {
        const valid = toField.value.includes('@') && 
                      subjectField.value.trim().length > 0 && 
                      selectedFrom === 'support@blockshell.app';
        sendBtn.disabled = !valid;
      };

      newEmailBtn.addEventListener('click', openCompose);
      overlay.addEventListener('click', closeCompose);
      closeDialog.addEventListener('click', closeCompose);

      fromDropdown.addEventListener('click', (e) => {
        e.stopPropagation();
        fromOptions.style.display = fromOptions.style.display === 'block' ? 'none' : 'block';
      });

      document.addEventListener('click', (e) => {
        if (!fromDropdown.contains(e.target)) {
          fromOptions.style.display = 'none';
        }
      });

      fromOptions.querySelectorAll('.from-opt').forEach(opt => {
        opt.addEventListener('click', () => {
          selectedFrom = opt.dataset.value;
          fromText.textContent = opt.textContent.trim();
          fromOptions.style.display = 'none';
          validate();
        });
      });

      [toField, subjectField, bodyField].forEach(el => el.addEventListener('input', validate));

      sendBtn.addEventListener('click', () => {
        toast.style.display = 'flex';
        setTimeout(() => toast.style.display = 'none', 4000);
        closeCompose();
      });

      // Mark emails as read
      document.getElementById('emailList').addEventListener('click', (e) => {
        const item = e.target.closest('.message-item');
        if (item) item.classList.remove('unread');
      });
    });
  </script>
</body>
</html>