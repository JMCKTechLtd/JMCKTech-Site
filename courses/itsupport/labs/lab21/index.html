<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Lab 21: Exchange Admin Center — Send As</title>

  <!-- Tailwind (CDN) -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            ms: {
              brand: '#0078d4',
              brandDark: '#106ebe',
              canvas: '#f3f2f1',
              text: '#323130',
              sub: '#605e5c',
              line: '#edebe9',
              tableHover: '#faf9f8',
              badgeBg: '#eef2f8',
              badgeText: '#004e8c',
              successBg: '#dff6dd',
              successText: '#107c10',
              errorBg: '#fde7e9',
              errorText: '#a80000'
            }
          },
          boxShadow: {
            ms: '0 1.6px 3.6px 0 rgba(0,0,0,.132),0 0.3px 0.9px 0 rgba(0,0,0,.108)',
          },
          fontFamily: {
            ui: ["Segoe UI", "Tahoma", "Geneva", "Verdana", "sans-serif"]
          }
        }
      }
    }
  </script>
  <style>
    html, body { height: 100%; }
    body { font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif; color:#323130; background:#f3f2f1; }
    .focus-ring:focus { outline: 3px solid #aad7ff; outline-offset: 2px; }
  </style>
</head>
<body class="bg-ms-canvas">

  <!-- ===================== -->
  <!-- SIGN-IN SCREEN -->
  <!-- ===================== -->
  <section id="loginScreen" class="min-h-screen flex items-center justify-center px-4">
    <div class="w-full max-w-4xl grid grid-cols-1 md:grid-cols-[260px,1fr] bg-white shadow-ms rounded-md overflow-hidden">
      <!-- Left rail (brand) -->
      <div class="bg-ms-brand text-white p-8 flex flex-col items-start justify-between">
        <div class="space-y-6">
          <div class="flex items-center space-x-3">
            <div class="w-10 h-10 rounded bg-white/10 flex items-center justify-center text-white font-semibold">O</div>
            <div class="text-lg font-semibold">Outlook</div>
          </div>
          <div>
            <div class="text-2xl font-semibold leading-tight">Exchange Admin Center</div>
            <p class="mt-2 text-white/90">Sign in to manage blockshell.app mailboxes.</p>
          </div>
        </div>
        <div class="text-xs text-white/80">© blockshell.app</div>
      </div>

      <!-- Form -->
      <div class="p-8">
        <h1 class="text-2xl font-semibold mb-6">Exchange Admin Center</h1>

        <div class="space-y-5">
          <label class="block">
            <span class="block text-sm font-semibold mb-1">Domain\user name</span>
            <input id="loginUser" class="w-full border border-ms-line rounded px-3 py-2 focus-ring"
                   placeholder="blockshell\administrator" value="blockshell\administrator" autocomplete="off">
          </label>

          <label class="block">
            <span class="block text-sm font-semibold mb-1">Password</span>
            <input id="loginPass" type="password" class="w-full border border-ms-line rounded px-3 py-2 focus-ring"
                   placeholder="••••••••" value="P@ssw0rd!" autocomplete="off">
          </label>

          <div class="flex items-center gap-3">
            <button id="loginBtn"
                    class="inline-flex items-center justify-center px-4 py-2 rounded bg-ms-brand text-white hover:bg-ms-brandDark focus-ring">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor"><path d="M3 4a1 1 0 011-1h6a1 1 0 110 2H5v10h5a1 1 0 110 2H4a1 1 0 01-1-1V4z"/><path d="M13.293 9.293a1 1 0 011.414 0L18 12.586l-3.293 3.293a1 1 0 01-1.414-1.414L14.586 13H9a1 1 0 110-2h5.586l-1.293-1.293a1 1 0 010-1.414z"/></svg>
              Sign in
            </button>

            <button id="loginResetBtn"
                    class="px-4 py-2 rounded border border-ms-line hover:bg-ms-canvas focus-ring">
              Reset form
            </button>
          </div>

          <p id="loginHint" class="text-sm text-ms-sub">Hint: use <span class="font-semibold">blockshell\\administrator</span> and any password.</p>
          <p id="loginError" class="hidden text-sm text-red-600">Sign-in failed. Try again.</p>
        </div>

        <!-- Mini instructions (pre-login) -->
        <div class="mt-8 p-4 bg-ms-tableHover border border-ms-line rounded">
          <div class="font-semibold mb-2">Lab Goal</div>
          <ul class="list-disc ml-5 text-sm leading-6">
            <li>Sign in to the Exchange Admin Center (simulated).</li>
            <li>Open <strong>Recipients → Mailboxes</strong> and select a shared mailbox.</li>
            <li>Grant <strong>Send As</strong> permission and verify the update.</li>
          </ul>
        </div>
      </div>
    </div>
  </section>

  <!-- ===================== -->
  <!-- EAC APP (POST LOGIN) -->
  <!-- ===================== -->
  <section id="app" class="hidden min-h-screen">
    <!-- Top header -->
    <header class="bg-ms-brand text-white px-5 py-3 flex items-center justify-between">
      <div class="flex items-center space-x-3">
        <div class="font-semibold">Exchange admin center</div>
        <span class="text-white/90 hidden sm:inline">|</span>
        <span class="text-white/90 hidden sm:inline text-sm">blockshell.app</span>
      </div>
      <div class="flex items-center space-x-2">
        <button id="resetBtnHeader" class="text-sm px-3 py-1.5 rounded bg-white/10 hover:bg-white/20 focus-ring">Reset lab</button>
        <button id="closeBtnHeader" class="text-sm px-3 py-1.5 rounded bg-white/10 hover:bg-white/20 focus-ring">Close lab</button>
        <span class="text-sm hidden sm:block ml-2">Admin User</span>
        <div class="w-8 h-8 rounded-full bg-white/20 flex items-center justify-center text-sm font-semibold">AU</div>
      </div>
    </header>

    <div class="grid grid-cols-[240px,1fr]">
      <!-- Left nav -->
      <aside class="bg-white h-[calc(100vh-48px)] shadow-[1px_0_5px_rgba(0,0,0,0.08)]">
        <nav class="py-2">
          <a class="block px-4 py-2 text-sm hover:bg-ms-canvas">Dashboard</a>
          <div class="mt-2">
            <div class="px-4 py-2 text-xs uppercase tracking-wide text-ms-sub">Recipients</div>
            <a class="block px-4 py-2 text-sm bg-ms-canvas border-l-4 border-ms-brand">Mailboxes</a>
            <a class="block px-4 py-2 text-sm hover:bg-ms-canvas">Groups</a>
            <a class="block px-4 py-2 text-sm hover:bg-ms-canvas">Resources</a>
            <a class="block px-4 py-2 text-sm hover:bg-ms-canvas">Contacts</a>
          </div>
          <div class="mt-2">
            <div class="px-4 py-2 text-xs uppercase tracking-wide text-ms-sub">Mail flow</div>
            <a class="block px-4 py-2 text-sm hover:bg-ms-canvas">Rules</a>
            <a class="block px-4 py-2 text-sm hover:bg-ms-canvas">Message trace</a>
          </div>
          <div class="mt-2">
            <div class="px-4 py-2 text-xs uppercase tracking-wide text-ms-sub">Organization</div>
            <a class="block px-4 py-2 text-sm hover:bg-ms-canvas">Sharing</a>
            <a class="block px-4 py-2 text-sm hover:bg-ms-canvas">Add-ins</a>
          </div>
        </nav>
      </aside>

      <!-- Main -->
      <main class="p-5">
        <div class="text-sm text-ms-sub mb-3">Home &gt; Recipients &gt; Mailboxes</div>

        <!-- Toasts -->
        <div id="toast" class="hidden mb-4 rounded border border-green-200 bg-ms-successBg text-ms-successText px-4 py-3" aria-live="polite">
          <span id="toastText" class="font-semibold"></span>
        </div>
        <div id="toastError" class="hidden mb-4 rounded border border-red-200 bg-ms-errorBg text-ms-errorText px-4 py-3" aria-live="polite">
          <span id="toastErrorText" class="font-semibold"></span>
        </div>

        <!-- Instructions panel -->
        <div class="bg-white shadow-ms rounded p-4 mb-4">
          <div class="font-semibold text-lg mb-1">Lab Instructions — Grant “Send As” Permission</div>
          <ol class="list-decimal ml-5 text-sm leading-7">
            <li>Select a shared mailbox (e.g., <strong>Support Team</strong>).</li>
            <li>Click <strong>Manage permissions</strong>.</li>
            <li>Choose a user and tick <strong>Send As</strong> (optionally Full Access / Send on Behalf).</li>
            <li>Click <strong>Add</strong>. Confirm the success banner and see counts update in the table.</li>
          </ol>
        </div>

        <!-- Mailbox table -->
        <div class="bg-white shadow-ms rounded overflow-hidden">
          <div class="px-4 py-3 border-b border-ms-line font-semibold">Shared mailboxes</div>
          <div class="overflow-x-auto">
            <table class="w-full text-left">
              <thead class="bg-ms-canvas text-sm">
                <tr>
                  <th class="px-4 py-2">Display name</th>
                  <th class="px-4 py-2">Email address</th>
                  <th class="px-4 py-2">Type</th>
                  <th class="px-4 py-2">Permissions</th>
                  <th class="px-4 py-2">Actions</th>
                </tr>
              </thead>
              <tbody id="mailboxTable" class="text-sm">
                <tr class="border-t border-ms-line hover:bg-ms-tableHover">
                  <td class="px-4 py-2">Support Team</td>
                  <td class="px-4 py-2">support@blockshell.app</td>
                  <td class="px-4 py-2">Shared</td>
                  <td class="px-4 py-2">
                    <span class="inline-block text-xs px-2 py-1 rounded bg-ms-badgeBg text-ms-badgeText mr-2">Full Access (3)</span>
                    <span class="inline-block text-xs px-2 py-1 rounded bg-ms-badgeBg text-ms-badgeText">Send As (2)</span>
                  </td>
                  <td class="px-4 py-2">
                    <button class="text-sm px-3 py-1.5 rounded border border-ms-line hover:bg-ms-canvas"
                            onclick="managePermissions('support@blockshell.app','Support Team')">Manage permissions</button>
                  </td>
                </tr>
                <tr class="border-t border-ms-line hover:bg-ms-tableHover">
                  <td class="px-4 py-2">Sales Department</td>
                  <td class="px-4 py-2">sales@blockshell.app</td>
                  <td class="px-4 py-2">Shared</td>
                  <td class="px-4 py-2">
                    <span class="inline-block text-xs px-2 py-1 rounded bg-ms-badgeBg text-ms-badgeText mr-2">Full Access (5)</span>
                    <span class="inline-block text-xs px-2 py-1 rounded bg-ms-badgeBg text-ms-badgeText">Send As (3)</span>
                  </td>
                  <td class="px-4 py-2">
                    <button class="text-sm px-3 py-1.5 rounded border border-ms-line hover:bg-ms-canvas"
                            onclick="managePermissions('sales@blockshell.app','Sales Department')">Manage permissions</button>
                  </td>
                </tr>
                <tr class="border-t border-ms-line hover:bg-ms-tableHover">
                  <td class="px-4 py-2">HR Team</td>
                  <td class="px-4 py-2">hr@blockshell.app</td>
                  <td class="px-4 py-2">Shared</td>
                  <td class="px-4 py-2">
                    <span class="inline-block text-xs px-2 py-1 rounded bg-ms-badgeBg text-ms-badgeText mr-2">Full Access (2)</span>
                  </td>
                  <td class="px-4 py-2">
                    <button class="text-sm px-3 py-1.5 rounded border border-ms-line hover:bg-ms-canvas"
                            onclick="managePermissions('hr@blockshell.app','HR Team')">Manage permissions</button>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <!-- Permissions Modal -->
        <div id="permissionModal"
             class="hidden fixed inset-0 z-40 flex items-center justify-center p-4">
          <div class="absolute inset-0 bg-black/30" onclick="closeModal()"></div>
          <div class="relative z-10 w-full max-w-5xl bg-white rounded shadow-ms max-h-[85vh] overflow-auto">
            <div class="px-5 py-4 border-b border-ms-line flex items-center justify-between">
              <div class="font-semibold" id="modalTitle">Manage permissions</div>
              <button class="text-sm px-3 py-1.5 rounded border border-ms-line hover:bg-ms-canvas" onclick="closeModal()">Close</button>
            </div>

            <div class="p-5 grid gap-5 md:grid-cols-2">
              <div class="space-y-4">
                <div id="modalMsg" class="hidden px-3 py-2 rounded border border-red-200 bg-ms-errorBg text-ms-errorText text-sm"></div>

                <label class="block">
                  <span class="block text-sm font-semibold mb-1">Add permissions</span>
                  <select id="userSelect" class="w-full border border-ms-line rounded px-3 py-2">
                    <option value="">Select a user…</option>
                    <option value="jdoe@blockshell.app">John Doe (jdoe@blockshell.app)</option>
                    <option value="asmith@blockshell.app">Alice Smith (asmith@blockshell.app)</option>
                    <option value="bjohnson@blockshell.app">Bob Johnson (bjohnson@blockshell.app)</option>
                    <option value="mwilson@blockshell.app">Mary Wilson (mwilson@blockshell.app)</option>
                  </select>
                </label>

                <div>
                  <div class="text-sm font-semibold mb-2">Permission type</div>
                  <label class="flex items-center space-x-2 mb-2">
                    <input id="fullAccess" type="checkbox" class="h-4 w-4">
                    <span class="text-sm">Full Access — open the mailbox and view contents</span>
                  </label>
                  <label class="flex items-center space-x-2 mb-2">
                    <input id="sendAs" type="checkbox" class="h-4 w-4">
                    <span class="text-sm">Send As — send messages as this mailbox</span>
                  </label>
                  <label class="flex items-center space-x-2">
                    <input id="sendOnBehalf" type="checkbox" class="h-4 w-4">
                    <span class="text-sm">Send on Behalf — send on behalf of this mailbox</span>
                  </label>
                </div>

                <div class="flex items-center space-x-2">
                  <button class="px-4 py-2 rounded bg-ms-brand text-white hover:bg-ms-brandDark" onclick="addPermission()">Add</button>
                  <button class="px-4 py-2 rounded border border-ms-line hover:bg-ms-canvas" onclick="closeModal()">Cancel</button>
                </div>
              </div>

              <div class="md:border-l md:border-ms-line md:pl-5">
                <div class="text-sm font-semibold mb-2">Current permissions</div>
                <div class="border border-ms-line rounded overflow-hidden">
                  <table class="w-full text-sm">
                    <thead class="bg-ms-canvas">
                      <tr>
                        <th class="px-3 py-2 text-left">User</th>
                        <th class="px-3 py-2 text-left">Permissions</th>
                        <th class="px-3 py-2 text-left w-28">Actions</th>
                      </tr>
                    </thead>
                    <tbody id="currentPermissions"></tbody>
                  </table>
                </div>
              </div>
            </div>

          </div>
        </div>

        <!-- Close blocked modal -->
        <div id="closeBlocked" class="hidden fixed inset-0 z-50 items-center justify-center p-4" role="dialog" aria-modal="true">
          <div class="absolute inset-0 bg-black/30"></div>
          <div class="relative z-10 w-full max-w-lg bg-white rounded shadow-ms">
            <div class="px-5 py-4 border-b border-ms-line font-semibold">Close lab</div>
            <div class="p-5">
              <p class="text-sm">
                Your browser blocked automatic tab closing. Please close this tab manually.
              </p>
              <div class="mt-4 text-right">
                <button id="closeBlockedOk"
                        class="px-4 py-2 rounded bg-ms-brand text-white hover:bg-ms-brandDark">OK</button>
              </div>
            </div>
          </div>
        </div>

      </main>
    </div>
  </section>

  <script>
    window.addEventListener('DOMContentLoaded', () => {
      let currentMailbox = null;
      let currentDisplayName = null;

      const initialPermissions = {
        'support@blockshell.app': [
          { user: 'asmith@blockshell.app', name: 'Alice Smith', permissions: ['Full Access','Send As'] },
          { user: 'bjohnson@blockshell.app', name: 'Bob Johnson', permissions: ['Full Access','Send As'] },
          { user: 'mwilson@blockshell.app', name: 'Mary Wilson', permissions: ['Full Access'] }
        ],
        'sales@blockshell.app': [
          { user: 'jdoe@blockshell.app', name: 'John Doe', permissions: ['Full Access','Send As'] },
          { user: 'asmith@blockshell.app', name: 'Alice Smith', permissions: ['Full Access','Send As'] },
          { user: 'mwilson@blockshell.app', name: 'Mary Wilson', permissions: ['Full Access','Send As'] }
        ],
        'hr@blockshell.app': [
          { user: 'bjohnson@blockshell.app', name: 'Bob Johnson', permissions: ['Full Access'] },
          { user: 'mwilson@blockshell.app', name: 'Mary Wilson', permissions: ['Full Access'] }
        ]
      };

      let permissionsData = JSON.parse(JSON.stringify(initialPermissions));

      function showToast(text) {
        const toast = document.getElementById('toast');
        const tt = document.getElementById('toastText');
        tt.textContent = text;
        document.getElementById('toastError').classList.add('hidden');
        toast.classList.remove('hidden');
        setTimeout(() => toast.classList.add('hidden'), 2500);
      }

      function updateMailboxTable() {
        const rows = document.querySelectorAll('#mailboxTable tr');
        rows.forEach(row => {
          const email = row.cells[1].textContent;
          if (permissionsData[email]) {
            const fullAccessCount = permissionsData[email].filter(p => p.permissions.includes('Full Access')).length;
            const sendAsCount = permissionsData[email].filter(p => p.permissions.includes('Send As')).length;
            const cell = row.cells[3];
            cell.innerHTML = '';
            if (fullAccessCount > 0) {
              const badge1 = document.createElement('span');
              badge1.className = 'inline-block text-xs px-2 py-1 rounded bg-ms-badgeBg text-ms-badgeText mr-2';
              badge1.textContent = `Full Access (${fullAccessCount})`;
              cell.appendChild(badge1);
            }
            if (sendAsCount > 0) {
              const badge2 = document.createElement('span');
              badge2.className = 'inline-block text-xs px-2 py-1 rounded bg-ms-badgeBg text-ms-badgeText';
              badge2.textContent = `Send As (${sendAsCount})`;
              cell.appendChild(badge2);
            }
          }
        });
      }

      function setModalMessage(msg) {
        const box = document.getElementById('modalMsg');
        box.textContent = msg;
        box.classList.remove('hidden');
      }
      function clearModalMessage() {
        const box = document.getElementById('modalMsg');
        box.classList.add('hidden');
      }

      window.managePermissions = (mailbox, displayName) => {
        currentMailbox = mailbox;
        currentDisplayName = displayName;
        document.getElementById('modalTitle').textContent = `Manage permissions for ${displayName} (${mailbox})`;
        document.getElementById('permissionModal').classList.remove('hidden');
        clearModalMessage();
        updateCurrentPermissions();
      };

      window.closeModal = () => {
        document.getElementById('permissionModal').classList.add('hidden');
        currentMailbox = null;
        currentDisplayName = null;
        document.getElementById('userSelect').value = '';
        document.getElementById('fullAccess').checked = false;
        document.getElementById('sendAs').checked = false;
        document.getElementById('sendOnBehalf').checked = false;
        clearModalMessage();
      };

      function updateCurrentPermissions() {
        const tbody = document.getElementById('currentPermissions');
        tbody.innerHTML = '';
        if (!currentMailbox || !permissionsData[currentMailbox]) return;

        permissionsData[currentMailbox].forEach(perm => {
          const tr = document.createElement('tr');
          tr.className = 'border-t border-ms-line hover:bg-ms-tableHover';

          const tdUser = document.createElement('td');
          tdUser.className = 'px-3 py-2 align-top break-all';
          tdUser.textContent = `${perm.name} (${perm.user})`;

          const tdPerms = document.createElement('td');
          tdPerms.className = 'px-3 py-2';
          perm.permissions.forEach(p => {
            const chip = document.createElement('span');
            chip.className = 'inline-block text-xs px-2 py-1 mr-2 mb-1 rounded bg-ms-badgeBg text-ms-badgeText';
            chip.textContent = p;
            tdPerms.appendChild(chip);
          });

          const tdAct = document.createElement('td');
          tdAct.className = 'px-3 py-2';
          const rm = document.createElement('button');
          rm.className = 'text-sm px-3 py-1.5 rounded border border-ms-line hover:bg-ms-canvas';
          rm.textContent = 'Remove';
          rm.onclick = () => removePermission(perm.user);
          tdAct.appendChild(rm);

          tr.append(tdUser, tdPerms, tdAct);
          tbody.appendChild(tr);
        });
      }

      window.addPermission = () => {
        if (!currentMailbox) return;

        const user = document.getElementById('userSelect').value;
        const fullAccess = document.getElementById('fullAccess').checked;
        const sendAs = document.getElementById('sendAs').checked;
        const sendOnBehalf = document.getElementById('sendOnBehalf').checked;

        if (!user) { setModalMessage('Please select a user.'); return; }
        if (!fullAccess && !sendAs && !sendOnBehalf) {
          setModalMessage('Select at least one permission type.'); return;
        }
        clearModalMessage();

        const userOption = document.querySelector(`#userSelect option[value="${user}"]`);
        const userName = userOption.textContent.split(' (')[0];

        if (!permissionsData[currentMailbox]) permissionsData[currentMailbox] = [];

        const idx = permissionsData[currentMailbox].findIndex(p => p.user === user);
        const toAdd = [];
        if (fullAccess) toAdd.push('Full Access');
        if (sendAs) toAdd.push('Send As');
        if (sendOnBehalf) toAdd.push('Send on Behalf');

        if (idx >= 0) {
          permissionsData[currentMailbox][idx].permissions =
            [...new Set([...permissionsData[currentMailbox][idx].permissions, ...toAdd])];
        } else {
          permissionsData[currentMailbox].push({ user, name: userName, permissions: toAdd });
        }

        if (sendAs) {
          showToast('Successfully granted "Send As" to "' + user + '" on "' + currentMailbox + '".');
        }

        document.getElementById('userSelect').value = '';
        document.getElementById('fullAccess').checked = false;
        document.getElementById('sendAs').checked = false;
        document.getElementById('sendOnBehalf').checked = false;

        updateCurrentPermissions();
        updateMailboxTable();
      };

      function removePermission(user) {
        if (!currentMailbox || !permissionsData[currentMailbox]) return;
        permissionsData[currentMailbox] =
          permissionsData[currentMailbox].filter(p => p.user !== user);
        updateCurrentPermissions();
        updateMailboxTable();
      }

      // Login + header controls
      document.getElementById('loginBtn').addEventListener('click', (e) => {
        e.preventDefault();
        const u = document.getElementById('loginUser').value.trim();
        const p = document.getElementById('loginPass').value.trim();
        if (u !== '' && p !== '') {
          document.getElementById('loginScreen').classList.add('hidden');
          document.getElementById('app').classList.remove('hidden');
          showToast('Signed in as ' + u + '.');
          window.scrollTo({ top: 0, behavior: 'smooth' });
        } else {
          document.getElementById('loginError').classList.remove('hidden');
          setTimeout(()=>document.getElementById('loginError').classList.add('hidden'), 2000);
        }
      });

      document.getElementById('loginResetBtn').addEventListener('click', () => {
        document.getElementById('loginUser').value = 'blockshell\\administrator';
        document.getElementById('loginPass').value = 'P@ssw0rd!';
      });

      function hardReset() {
        window.closeModal();
        permissionsData = JSON.parse(JSON.stringify(initialPermissions));
        updateMailboxTable();
        document.getElementById('app').classList.add('hidden');
        document.getElementById('loginScreen').classList.remove('hidden');
        document.getElementById('loginUser').value = 'blockshell\\administrator';
        document.getElementById('loginPass').value = 'P@ssw0rd!';
        showToast('Lab reset.');
        window.scrollTo({ top: 0, behavior: 'smooth' });
      }

      function tryCloseWindow() {
        window.open('', '_self');
        window.close();
        setTimeout(() => {
          if (!document.hidden) {
            const d = document.getElementById('closeBlocked');
            d.classList.remove('hidden');
            d.classList.add('flex');
          }
        }, 300);
      }

      document.getElementById('resetBtnHeader').addEventListener('click', hardReset);
      document.getElementById('closeBtnHeader').addEventListener('click', tryCloseWindow);
      document.getElementById('closeBlockedOk').addEventListener('click', () => {
        const d = document.getElementById('closeBlocked');
        d.classList.add('hidden');
        d.classList.remove('flex');
      });

      updateMailboxTable();
    });
  </script>
</body>
</html>
