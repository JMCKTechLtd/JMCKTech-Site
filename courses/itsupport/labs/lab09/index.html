<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Lab 9: UEFI vs Legacy Boot Mode</title>
  <style>
    :root {
      --primary-color: #2e51bb;
      --success-color: #10b981;
      --warning-color: #f59e0b;
      --bios-blue: #0066cc;
      --bios-text: #ffffff;
    }
    
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    body {
      font-family: 'Segoe UI', Tahoma, sans-serif;
      background: #f0f0f0;
      min-height: 100vh;
      padding: 20px;
      display: flex;
      justify-content: center;
      align-items: center;
    }
    
    .lab-container {
      width: 100%;
      max-width: 1400px;
      background: #fff;
      border-radius: 8px;
      box-shadow: 0 4px 8px rgba(0,0,0,.1);
      overflow: hidden;
    }
    
    .lab-header {
      background: var(--primary-color);
      color: #fff;
      padding: 16px;
      text-align: center;
    }
    
    .lab-title {
      font-size: 24px;
      font-weight: 600;
      margin: 0;
    }
    
    .task-panel {
      background: #f8f9fa;
      border: 1px solid #dee2e6;
      padding: 16px;
      margin: 16px;
      border-radius: 6px;
    }
    
    .task-title {
      font-size: 16px;
      font-weight: 600;
      color: var(--primary-color);
      margin-bottom: 8px;
    }
    
    .workspace {
      display: flex;
      gap: 20px;
      padding: 16px;
    }
    
    .main-area {
      flex: 1;
    }
    
    .sidebar {
      width: 300px;
      display: flex;
      flex-direction: column;
      gap: 12px;
    }
    
    .bios-screen {
      width: 900px;
      height: 550px;
      background: var(--bios-blue);
      color: var(--bios-text);
      padding: 20px;
      display: flex;
      flex-direction: column;
      font-family: 'Courier New', monospace;
      border: 3px solid #333;
      margin: 0 auto;
    }
    
    .bios-header {
      border-bottom: 2px solid #fff;
      padding-bottom: 8px;
      margin-bottom: 12px;
      text-align: center;
    }
    
    .bios-title {
      font-size: 18px;
      color: #ff0;
      font-weight: bold;
    }
    
    .bios-content {
      flex: 1;
      display: flex;
      gap: 20px;
    }
    
    .bios-menu {
      width: 200px;
    }
    
    .menu-item {
      padding: 8px;
      border-radius: 4px;
      margin-bottom: 8px;
      background: rgba(255,255,255,.08);
      border: 1px solid rgba(255,255,255,.2);
      cursor: default;
    }
    
    .menu-item.active {
      background: #fff;
      color: #003a99;
      border-color: #fff;
      font-weight: bold;
    }
    
    .bios-info {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 15px;
    }
    
    .info-title {
      color: #ff0;
      font-weight: bold;
      margin-bottom: 8px;
    }
    
    .settings-section {
      background: rgba(0,0,0,.25);
      border: 1px solid rgba(255,255,255,.35);
      border-radius: 6px;
      padding: 12px;
    }
    
    .setting {
      padding: 8px;
      margin: 4px 0;
      border-radius: 4px;
      background: rgba(255,255,255,.1);
      display: flex;
      justify-content: space-between;
      align-items: center;
      cursor: default;
    }
    
    .setting.selected {
      background: #fff;
      color: #003a99;
    }
    
    .setting.disabled {
      opacity: 0.5;
    }
    
    .boot-devices {
      margin-top: 8px;
    }
    
    .boot-device {
      padding: 6px;
      margin: 2px 0;
      background: rgba(255,255,255,.05);
      border-radius: 3px;
      display: flex;
      align-items: center;
      gap: 8px;
      cursor: default;
    }
    
    .boot-device.selected {
      background: #fff;
      color: #003a99;
    }
    
    .device-number {
      color: #ff0;
      width: 20px;
      font-weight: bold;
    }
    
    .bios-controls {
      margin-top: 16px;
      padding-top: 12px;
      border-top: 1px solid rgba(255,255,255,.3);
    }
    
    .controls-row {
      display: flex;
      gap: 8px;
      justify-content: center;
      margin-bottom: 8px;
    }
    
    .key-button {
      padding: 6px 12px;
      background: #444;
      border: 1px solid #666;
      border-radius: 4px;
      color: #fff;
      cursor: pointer;
      user-select: none;
      font-size: 12px;
    }
    
    .key-button.special {
      background: #0b61d6;
      border-color: #0b61d6;
      font-weight: bold;
    }
    
    .key-button.enter {
      background: #0a7e2a;
      border-color: #0a7e2a;
      font-weight: bold;
    }
    
    .key-button.esc {
      background: #b91c1c;
      border-color: #b91c1c;
      font-weight: bold;
    }
    
    .key-button:hover {
      opacity: .8;
    }
    
    .key-button.pressed {
      outline: 2px solid #fff;
      background: #666;
    }
    
    .instructions {
      text-align: center;
      font-size: 12px;
      opacity: .9;
      margin-top: 8px;
    }
    
    .panel {
      background: #fff;
      border: 1px solid #ddd;
      border-radius: 6px;
      padding: 12px;
    }
    
    .status-title {
      font-size: 14px;
      font-weight: 600;
      margin-bottom: 8px;
    }
    
    .status-item {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 6px;
      margin-bottom: 4px;
      font-size: 13px;
    }
    
    .status-indicator {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      border: 2px solid #ccc;
      flex-shrink: 0;
    }
    
    .status-indicator.complete {
      background: var(--success-color);
      border-color: var(--success-color);
    }
    
    .hint {
      font-size: 13px;
      color: #8b5a00;
      background: #fff8e1;
      border: 1px solid #ffc107;
      border-radius: 4px;
      padding: 8px;
    }
    
    .warning {
      font-size: 13px;
      color: #b45309;
      background: #fef3c7;
      border: 1px solid #f59e0b;
      border-radius: 4px;
      padding: 8px;
    }
    
    .hidden {
      display: none !important;
    }
    
    .lab-controls {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    
    .lab-button {
      background: var(--primary-color);
      color: #fff;
      border: none;
      padding: 8px 12px;
      border-radius: 4px;
      font-size: 13px;
      cursor: pointer;
      width: 100%;
      transition: background-color 0.2s ease;
    }
    
    .lab-button:hover {
      background: #1e40a0;
    }
    
    .lab-button.secondary {
      background: #6c757d;
      color: #fff;
    }
    
    .lab-button.secondary:hover {
      background: #5a6268;
    }
    
    .dialog-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0,0,0,0.7);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
    }
    
    .bios-dialog {
      background: var(--bios-blue);
      color: var(--bios-text);
      border: 2px solid #fff;
      padding: 20px;
      min-width: 400px;
      font-family: 'Courier New', monospace;
    }
    
    .dialog-title {
      color: #ff0;
      font-weight: bold;
      margin-bottom: 12px;
      text-align: center;
    }
    
    .dialog-options {
      display: flex;
      gap: 12px;
      justify-content: center;
      margin-top: 16px;
    }
    
    .dialog-option {
      padding: 8px 16px;
      background: #444;
      border: 1px solid #666;
      cursor: pointer;
      color: #fff;
    }
    
    .dialog-option:hover {
      background: #555;
    }
    
    .info-text {
      font-size: 12px;
      opacity: 0.8;
      margin-top: 8px;
      font-style: italic;
    }
    
    .boot-order-instruction {
      font-size: 11px;
      color: #ff0;
      margin-top: 5px;
      text-align: center;
    }
  </style>
</head>
<body>
<div class="lab-container">
  <div class="lab-header">
    <div class="lab-title">Lab 9: UEFI vs Legacy Boot Mode</div>
  </div>
  
  <div class="task-panel">
    <div class="task-title">üîß Task</div>
    <p><strong>Primary Objective:</strong> Change <strong>Boot Mode</strong> from <em>Legacy</em> ‚Üí <em>UEFI</em> and configure Secure Boot.</p>
    <p><strong>Additional Tasks:</strong></p>
    <ul>
      <li>Configure Boot Device Priority: Set <strong>Windows Boot Manager</strong> as 1st boot device</li>
      <li>Enable Secure Boot in UEFI mode</li>
      <li>Save changes and exit BIOS</li>
    </ul>
  </div>
  
  <div class="workspace">
    <div class="main-area">
      <div class="bios-screen">
        <div class="bios-header">
          <div class="bios-title">ACME BIOS Setup Utility - UEFI BIOS Version 2.1</div>
        </div>
        
        <div class="bios-content">
          <div class="bios-menu">
            <div class="menu-item">Main</div>
            <div class="menu-item">Advanced</div>
            <div class="menu-item">Security</div>
            <div class="menu-item active">Boot</div>
            <div class="menu-item">Save & Exit</div>
          </div>
          
          <div class="bios-info">
            <div class="settings-section">
              <div class="info-title">Boot Configuration</div>
              <div class="setting" data-key="bootMode">
                <span class="name">Boot Mode</span>
                <span class="value" id="bootModeVal">Legacy</span>
              </div>
              <div class="setting" data-key="csm">
                <span class="name">CSM Support</span>
                <span class="value" id="csmVal">Enabled</span>
              </div>
              <div class="setting" data-key="secureBoot">
                <span class="name">Secure Boot</span>
                <span class="value" id="secureBootVal">[Not Available]</span>
              </div>
              <div class="setting">
                <span class="name">Fast Boot</span>
                <span class="value">Enabled</span>
              </div>
            </div>
            
            <div class="settings-section">
              <div class="info-title">Boot Device Priority</div>
              <div class="boot-devices" id="bootDevicesContainer">
                <!-- Boot devices will be dynamically rendered here -->
              </div>
              <div class="info-text">Use +/- keys to change boot order</div>
              <div class="boot-order-instruction">Goal: Set Windows Boot Manager as 1st boot device</div>
            </div>
          </div>
        </div>
        
        <div class="bios-controls">
          <div class="controls-row">
            <div class="key-button esc" id="escKey">Esc</div>
            <div class="key-button special" id="f10Key">F10</div>
            <div class="key-button enter" id="enterKey">Enter</div>
            <div class="key-button" id="upKey">‚Üë</div>
            <div class="key-button" id="downKey">‚Üì</div>
            <div class="key-button" id="plusKey">+</div>
            <div class="key-button" id="minusKey">-</div>
          </div>
          <div class="instructions">‚Üë‚Üì Navigate | Enter Select | +/- Change Order | F10 Save | Esc Cancel</div>
        </div>
      </div>
    </div>
    
    <div class="sidebar">
      <div class="panel">
        <div class="status-title">Lab Progress</div>
        <div class="status-item">
          <div class="status-indicator" id="navDot"></div>
          Navigate to Boot Settings
        </div>
        <div class="status-item">
          <div class="status-indicator" id="modeDot"></div>
          Set Boot Mode to UEFI
        </div>
        <div class="status-item">
          <div class="status-indicator" id="secureDot"></div>
          Enable Secure Boot
        </div>
        <div class="status-item">
          <div class="status-indicator" id="bootOrderDot"></div>
          Set Windows Boot Manager as 1st device
        </div>
        <div class="status-item">
          <div class="status-indicator" id="saveDot"></div>
          Save Changes and Exit
        </div>
      </div>
      
      <div class="panel hint" id="hintPanel">
        Use arrow keys to navigate through BIOS settings
      </div>
      
      <div class="panel warning hidden" id="warningPanel">
        <!-- Warnings will appear here -->
      </div>
      
      <div class="panel hidden" id="donePanel">
        <b>üéâ Lab Completed!</b>
        <p>All objectives completed successfully:</p>
        <ul style="font-size:12px;margin:8px 0;padding-left:16px">
          <li>‚úì Boot Mode set to UEFI</li>
          <li>‚úì Secure Boot enabled</li>
          <li>‚úì Boot order configured correctly</li>
          <li>‚úì Changes saved and applied</li>
        </ul>
      </div>
      
      <div class="panel">
        <div class="lab-controls">
          <button class="lab-button secondary" id="resetLab" type="button">üîÑ Reset Lab</button>
          <button class="lab-button" id="closeLab" type="button">Close Lab</button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Save Confirmation Dialog -->
<div class="dialog-overlay hidden" id="saveDialog">
  <div class="bios-dialog">
    <div class="dialog-title">Save configuration changes and exit?</div>
    <div style="text-align:center;margin-bottom:16px">
      <div>Changes will be saved and system will restart</div>
    </div>
    <div class="dialog-options">
      <div class="dialog-option" data-action="save">Save Changes and Exit</div>
      <div class="dialog-option" data-action="discard">Discard Changes and Exit</div>
      <div class="dialog-option" data-action="cancel">Cancel</div>
    </div>
  </div>
</div>

<!-- Secure Boot Warning Dialog -->
<div class="dialog-overlay hidden" id="secureBootDialog">
  <div class="bios-dialog">
    <div class="dialog-title">Secure Boot Configuration</div>
    <div style="margin-bottom:16px">
      <div>Enabling Secure Boot helps prevent unauthorized</div>
      <div>operating systems from loading during boot process.</div>
      <br>
      <div>‚ö†Ô∏è Warning: Some operating systems or hardware</div>
      <div>may not be compatible with Secure Boot.</div>
    </div>
    <div class="dialog-options">
      <div class="dialog-option" data-action="enable">Enable Secure Boot</div>
      <div class="dialog-option" data-action="cancel">Cancel</div>
    </div>
  </div>
</div>

<script>
class BIOSLab {
  constructor() {
    this.currentIndex = 0;
    this.bootMode = 'Legacy';
    this.csmEnabled = true;
    this.secureBootEnabled = false;
    
    // Boot devices data - device 1 is Windows Boot Manager
    this.bootDevices = [
      { id: 1, name: 'Windows Boot Manager (UEFI)' },
      { id: 2, name: 'Hard Drive: WDC WD1003FZEX' },
      { id: 3, name: 'USB Device: SanDisk Cruzer' },
      { id: 4, name: 'CD/DVD: TSSTcorp CDDVDW' }
    ];
    
    // Current boot order (array of device IDs in order)
    this.bootOrder = [1, 2, 3, 4];
    
    this.changesMade = false;
    
    this.init();
  }

  init() {
    console.log('BIOS Lab Initializing...');
    
    // Render boot devices initially
    this.renderBootDevices();
    
    // Get all selectable items
    this.items = [
      ...document.querySelectorAll('.setting'),
      ...document.querySelectorAll('.boot-device')
    ];
    
    // Bind button events
    this.bindEvents();
    
    // Bind keyboard events
    this.bindKeyboard();
    
    // Initial setup
    this.updateDisplay();
    this.updateProgress();
    
    console.log('BIOS Lab Ready - Items found:', this.items.length);
  }

  renderBootDevices() {
    const container = document.getElementById('bootDevicesContainer');
    container.innerHTML = '';
    
    this.bootOrder.forEach((deviceId, index) => {
      const device = this.bootDevices.find(d => d.id === deviceId);
      if (device) {
        const deviceElement = document.createElement('div');
        deviceElement.className = 'boot-device';
        deviceElement.dataset.device = device.id;
        deviceElement.innerHTML = `
          <span class="device-number">${index + 1}.</span>
          <span class="device-name">${device.name}</span>
        `;
        container.appendChild(deviceElement);
      }
    });
    
    // Update items array after rendering
    this.items = [
      ...document.querySelectorAll('.setting'),
      ...document.querySelectorAll('.boot-device')
    ];
  }

  bindEvents() {
    // Navigation buttons
    document.getElementById('upKey').addEventListener('click', () => this.navigate(-1));
    document.getElementById('downKey').addEventListener('click', () => this.navigate(1));
    document.getElementById('enterKey').addEventListener('click', () => this.selectItem());
    document.getElementById('plusKey').addEventListener('click', () => this.changeBootOrder(1));
    document.getElementById('minusKey').addEventListener('click', () => this.changeBootOrder(-1));
    document.getElementById('escKey').addEventListener('click', () => this.cancelAction());
    document.getElementById('f10Key').addEventListener('click', () => this.initiateSave());

    // Lab controls
    document.getElementById('resetLab').addEventListener('click', () => this.resetLab());
    document.getElementById('closeLab').addEventListener('click', () => this.closeLab());

    // Dialog options
    document.querySelectorAll('.dialog-option').forEach(option => {
      option.addEventListener('click', (e) => {
        const action = e.target.dataset.action;
        this.handleDialogAction(action);
      });
    });
  }

  bindKeyboard() {
    document.addEventListener('keydown', (e) => {
      switch(e.key) {
        case 'ArrowUp':
          e.preventDefault();
          this.flashKey('#upKey');
          this.navigate(-1);
          break;
        case 'ArrowDown':
          e.preventDefault();
          this.flashKey('#downKey');
          this.navigate(1);
          break;
        case 'Enter':
          e.preventDefault();
          this.flashKey('#enterKey');
          this.selectItem();
          break;
        case '+':
        case '=':
          e.preventDefault();
          this.flashKey('#plusKey');
          this.changeBootOrder(1);
          break;
        case '-':
        case '_':
          e.preventDefault();
          this.flashKey('#minusKey');
          this.changeBootOrder(-1);
          break;
        case 'Escape':
          e.preventDefault();
          this.flashKey('#escKey');
          this.cancelAction();
          break;
        case 'F10':
        case 'f10':
          e.preventDefault();
          this.flashKey('#f10Key');
          this.initiateSave();
          break;
      }
    });
  }

  navigate(direction) {
    this.currentIndex = (this.currentIndex + direction + this.items.length) % this.items.length;
    this.updateDisplay();
    this.showHint(`Selected: ${this.getCurrentItemName()}`);
  }

  getCurrentItemName() {
    const currentItem = this.items[this.currentIndex];
    if (currentItem.classList.contains('setting')) {
      return currentItem.querySelector('.name').textContent;
    } else {
      return currentItem.querySelector('.device-name').textContent;
    }
  }

  selectItem() {
    const currentItem = this.items[this.currentIndex];
    const key = currentItem.dataset?.key;
    
    if (key === 'bootMode') {
      this.toggleBootMode();
    } else if (key === 'secureBoot') {
      if (this.bootMode === 'UEFI') {
        this.showSecureBootDialog();
      } else {
        this.showWarning('Secure Boot is only available in UEFI mode');
      }
    } else if (currentItem.classList.contains('boot-device')) {
      this.showHint('Boot device selected. Use + and - keys to change priority.');
    }
    
    this.changesMade = true;
    this.updateProgress();
  }

  toggleBootMode() {
    this.bootMode = this.bootMode === 'Legacy' ? 'UEFI' : 'Legacy';
    
    if (this.bootMode === 'UEFI') {
      this.csmEnabled = false;
      this.showHint('Boot Mode set to UEFI. CSM automatically disabled. You can now enable Secure Boot.');
    } else {
      this.csmEnabled = true;
      this.secureBootEnabled = false;
      this.showHint('Boot Mode set to Legacy. CSM enabled.');
    }
    
    this.updateDisplay();
    this.updateProgress();
  }

  changeBootOrder(direction) {
    const currentItem = this.items[this.currentIndex];
    if (!currentItem.classList.contains('boot-device')) {
      this.showWarning('Select a boot device first to change boot order');
      return;
    }

    const deviceId = parseInt(currentItem.dataset.device);
    const currentPos = this.bootOrder.indexOf(deviceId);
    const newPos = currentPos + direction;

    if (newPos >= 0 && newPos < this.bootOrder.length) {
      // Remove from current position and insert at new position
      this.bootOrder.splice(currentPos, 1);
      this.bootOrder.splice(newPos, 0, deviceId);
      
      // Re-render boot devices with new order
      this.renderBootDevices();
      
      // Update selection to follow the moved device
      this.currentIndex = this.items.findIndex(item => 
        item.classList.contains('boot-device') && 
        parseInt(item.dataset.device) === deviceId
      );
      
      this.updateDisplay();
      this.showHint(`Boot order updated. ${this.getDeviceName(deviceId)} moved to position ${newPos + 1}`);
      this.changesMade = true;
      this.updateProgress();
    }
  }

  getDeviceName(deviceId) {
    const device = this.bootDevices.find(d => d.id === deviceId);
    return device ? device.name : `Device ${deviceId}`;
  }

  cancelAction() {
    this.hideAllDialogs();
    this.showHint('Action cancelled');
  }

  initiateSave() {
    if (!this.changesMade) {
      this.showWarning('No changes to save');
      return;
    }
    
    this.showSaveDialog();
  }

  showSaveDialog() {
    document.getElementById('saveDialog').classList.remove('hidden');
  }

  showSecureBootDialog() {
    document.getElementById('secureBootDialog').classList.remove('hidden');
  }

  hideAllDialogs() {
    document.querySelectorAll('.dialog-overlay').forEach(dialog => {
      dialog.classList.add('hidden');
    });
  }

  handleDialogAction(action) {
    this.hideAllDialogs();
    
    switch(action) {
      case 'save':
        this.saveChanges();
        break;
      case 'discard':
        this.showHint('Changes discarded');
        this.resetLab();
        break;
      case 'enable':
        this.secureBootEnabled = true;
        this.showHint('Secure Boot enabled. System will only boot signed operating systems.');
        this.updateDisplay();
        this.updateProgress();
        break;
      case 'cancel':
        this.showHint('Action cancelled');
        break;
    }
  }

  saveChanges() {
    // Check if all objectives are met
    const bootModeOk = this.bootMode === 'UEFI';
    const secureBootOk = this.secureBootEnabled;
    const bootOrderOk = this.bootOrder[0] === 1; // Windows Boot Manager is device 1
    
    if (bootModeOk && secureBootOk && bootOrderOk) {
      document.getElementById('saveDot').classList.add('complete');
      document.getElementById('donePanel').classList.remove('hidden');
      this.showHint('Configuration saved successfully! Lab completed.');
    } else {
      let missing = [];
      if (!bootModeOk) missing.push('Set Boot Mode to UEFI');
      if (!secureBootOk) missing.push('Enable Secure Boot');
      if (!bootOrderOk) missing.push('Set Windows Boot Manager as 1st boot device');
      
      this.showWarning('Complete all tasks before saving: ' + missing.join(', '));
    }
  }

  updateDisplay() {
    // Update selection
    this.items.forEach((item, index) => {
      item.classList.toggle('selected', index === this.currentIndex);
    });

    // Update values
    document.getElementById('bootModeVal').textContent = this.bootMode;
    document.getElementById('csmVal').textContent = this.csmEnabled ? 'Enabled' : 'Disabled';
    
    const secureBootSetting = document.querySelector('[data-key="secureBoot"]');
    if (this.bootMode === 'UEFI') {
      document.getElementById('secureBootVal').textContent = this.secureBootEnabled ? 'Enabled' : 'Disabled';
      secureBootSetting.classList.remove('disabled');
    } else {
      document.getElementById('secureBootVal').textContent = '[Not Available]';
      secureBootSetting.classList.add('disabled');
    }
  }

  updateProgress() {
    // Navigation is always complete once we're interacting
    document.getElementById('navDot').classList.add('complete');
    
    // Boot mode
    document.getElementById('modeDot').classList.toggle('complete', this.bootMode === 'UEFI');
    
    // Secure Boot
    document.getElementById('secureDot').classList.toggle('complete', this.secureBootEnabled);
    
    // Boot order - Windows Boot Manager (device 1) should be first
    document.getElementById('bootOrderDot').classList.toggle('complete', this.bootOrder[0] === 1);
  }

  flashKey(keyId) {
    const element = document.querySelector(keyId);
    if (element) {
      element.classList.add('pressed');
      setTimeout(() => element.classList.remove('pressed'), 150);
    }
  }

  showHint(message) {
    const hintPanel = document.getElementById('hintPanel');
    hintPanel.innerHTML = message;
    hintPanel.classList.remove('hidden');
    
    document.getElementById('warningPanel').classList.add('hidden');
    
    clearTimeout(this.hintTimeout);
    this.hintTimeout = setTimeout(() => {
      hintPanel.innerHTML = 'Use arrow keys to navigate through BIOS settings';
    }, 4000);
  }

  showWarning(message) {
    const warningPanel = document.getElementById('warningPanel');
    warningPanel.innerHTML = message;
    warningPanel.classList.remove('hidden');
    
    document.getElementById('hintPanel').classList.add('hidden');
    
    clearTimeout(this.warningTimeout);
    this.warningTimeout = setTimeout(() => {
      warningPanel.classList.add('hidden');
      document.getElementById('hintPanel').classList.remove('hidden');
    }, 4000);
  }

  resetLab() {
    this.currentIndex = 0;
    this.bootMode = 'Legacy';
    this.csmEnabled = true;
    this.secureBootEnabled = false;
    this.bootOrder = [1, 2, 3, 4];
    this.changesMade = false;
    
    // Re-render boot devices
    this.renderBootDevices();
    
    document.querySelectorAll('.status-indicator').forEach(indicator => {
      indicator.classList.remove('complete');
    });
    
    document.getElementById('donePanel').classList.add('hidden');
    this.hideAllDialogs();
    
    this.updateDisplay();
    this.updateProgress();
    this.showHint('Lab has been reset. Use arrow keys to navigate.');
  }

  closeLab() {
    try {
      window.close();
    } catch (err) {
      setTimeout(() => {
        window.location.href = 'about:blank';
      }, 300);
    }
  }
}

// Initialize when page loads
document.addEventListener('DOMContentLoaded', () => {
  console.log('DOM loaded, starting BIOS lab...');
  new BIOSLab();
});
</script>
</body>
</html>