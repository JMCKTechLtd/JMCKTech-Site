<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Lab 12: Uninstall a Program</title>
<style>
/* ==== Desktop background (from template style) ==== */
html,body{height:100%;margin:0;font-family:Segoe UI, Roboto, Arial, Helvetica, sans-serif;}
body{background:linear-gradient(120deg,#1976d2,#0d47a1);color:#111;overflow:hidden;}
#desktop{position:absolute;inset:0 0 48px 0;padding:14px;}

/* ==== Desktop icon (from template) ==== */
.desktop-icon{width:80px;text-align:center;color:#fff;cursor:default;user-select:none;position:absolute;}
.desktop-icon img{width:48px;height:48px;display:block;margin:0 auto 6px;}
.desktop-icon .label{font-size:12px;text-shadow:0 1px 2px rgba(0,0,0,.4)}

/* ==== Windows (simulation windows) ==== */
.window{position:absolute;background:#fff;border:1px solid #c9c9c9;border-radius:10px;box-shadow:0 14px 40px rgba(0,0,0,.35);display:none;flex-direction:column;overflow:hidden;}
.window-header{background:#e9e9e9;padding:8px 10px;display:flex;align-items:center;gap:8px;cursor:move;border-bottom:1px solid #cfcfcf;user-select:none;}
.window-title{font-weight:600;flex:1}
.window-controls{display:flex;gap:6px}
.window-control{width:24px;height:24px;border-radius:6px;background:#dcdcdc;display:grid;place-items:center;cursor:pointer}
.window-control:hover{background:#cfcfcf}
.window-body{padding:10px;overflow:auto;background:#fff;flex:1}

/* ==== Instructions window ==== */
#instructionsWindow{left:20px;top:20px;width:440px;height:360px;display:flex}
#instructionsWindow .window-body{font-size:14px}
#instructionsWindow ol{margin-left:18px}
#instructionsWindow li{margin:6px 0}
#instructionsWindow .btnbar{display:flex;gap:8px;margin-top:10px}
button{border:1px solid #c9c9c9;background:#efefef;padding:6px 10px;border-radius:6px;cursor:pointer}
button:disabled{opacity:.55;cursor:not-allowed}

/* ==== Control Panel Views ==== */
.cp-view-controls{display:flex;gap:8px;margin-bottom:12px;padding-bottom:8px;border-bottom:1px solid #e5e5e5}
.cp-view-btn{background:none;border:1px solid transparent;padding:4px 8px;font-size:12px}
.cp-view-btn.active{background:#0078d4;color:#fff;border-color:#0078d4}
.cp-search{flex:1;max-width:200px;margin-left:auto;border:1px solid #ccc;padding:4px 8px;border-radius:4px;font-size:12px}

/* ==== Control Panel Category View ==== */
.cp-category-view{display:block}
.cp-category-item{display:flex;align-items:center;gap:12px;padding:12px;border-bottom:1px solid #f0f0f0;cursor:pointer}
.cp-category-item:hover{background:#f8f8f8}
.cp-category-icon{font-size:24px;width:32px;text-align:center}
.cp-category-text{flex:1}
.cp-category-desc{font-size:12px;color:#666;margin-top:2px}

/* ==== Control Panel Grid (icon view) ==== */
.cp-grid-view{display:none;grid-template-columns:repeat(3,1fr);gap:14px}
.cp-item{border:1px solid #e5e5e5;border-radius:10px;padding:16px;text-align:center;background:#fafafa;cursor:pointer;transition:transform .12s ease, box-shadow .12s ease}
.cp-item:hover{transform:translateY(-1px);box-shadow:0 6px 16px rgba(0,0,0,.12)}
.cp-icon{font-size:36px;display:block;margin-bottom:8px}

/* ==== Settings App (Modern) ==== */
#settingsWindow{left:100px;top:60px;width:800px;height:500px;display:none}
.settings-nav{display:flex;border-bottom:1px solid #e5e5e5;background:#f8f8f8}
.settings-nav-item{padding:12px 16px;cursor:pointer;border-bottom:2px solid transparent}
.settings-nav-item.active{border-bottom-color:#0078d4;color:#0078d4;font-weight:600}
.settings-content{display:flex;height:calc(100% - 49px)}
.settings-sidebar{width:200px;background:#f8f8f8;border-right:1px solid #e5e5e5;padding:16px 0}
.settings-main{flex:1;padding:16px;overflow:auto}
.settings-option{padding:12px 0;border-bottom:1px solid #f0f0f0;cursor:pointer;display:flex;justify-content:space-between;align-items:center}
.settings-option:hover{background:#f8f8f8}
.settings-option:last-child{border-bottom:none}

/* ==== Programs & Features window ==== */
.toolbar{display:flex;gap:8px;margin-bottom:10px}
.btn-danger{background:#d83b01;color:#fff;border-color:#d83b01}
.btn-danger:hover{background:#c13200}
.table{width:100%;border-collapse:collapse;font-size:14px}
.table th,.table td{padding:8px;border-bottom:1px solid #e8e8e8;text-align:left}
.table thead th{background:#f7f7f7;position:sticky;top:0;cursor:pointer}
.table thead th:hover{background:#eaeaea}
.table tr{cursor:pointer}
.table tr:hover{background:#f0f8ff}
.table tr.selected{background:#1976d2;color:#fff}
.table tr.target{background:#fff8dc}
.table tr.target:hover{background:#fff3c6}

/* ==== Uninstall Wizard ==== */
.wizard{display:none;position:absolute;top:0;left:0;right:0;bottom:0;background:#fff;z-index:10;flex-direction:column}
.wizard-header{background:#0078d4;color:#fff;padding:16px;font-weight:600}
.wizard-body{flex:1;padding:20px;display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center}
.wizard-icon{font-size:48px;margin-bottom:16px}
.wizard-progress{width:80%;height:4px;background:#e5e5e5;border-radius:2px;margin:20px 0;overflow:hidden}
.wizard-progress-bar{height:100%;background:#0078d4;width:0%;transition:width 0.3s ease}
.wizard-actions{display:flex;gap:8px;justify-content:center;padding:16px;border-top:1px solid #e5e5e5}

/* ==== Toast (from template) ==== */
#toast{position:fixed;bottom:60px;left:50%;transform:translateX(-50%);background:#333;color:#fff;padding:10px 14px;border-radius:10px;display:none;z-index:500}

/* ==== Context menus (template style) ==== */
.context-menu{position:absolute;display:none;background:rgba(30,30,30,0.97);color:#fff;border:1px solid rgba(255,255,255,0.12);border-radius:10px;box-shadow:0 12px 40px rgba(0,0,0,0.4);z-index:400;overflow:hidden;backdrop-filter:blur(16px);min-width:220px;}
.context-menu-item{padding:12px 16px;cursor:pointer;display:flex;align-items:center;color:white;font-size:14px;transition:all .2s ease;border-bottom:1px solid rgba(255,255,255,0.05);user-select:none;}
.context-menu-item:last-child{border-bottom:none}
.context-menu-item:hover{background:rgba(255,255,255,0.08)}

/* ==== Taskbar + refined tray (from template) ==== */
.taskbar{position:absolute;bottom:0;width:100%;height:48px;background:rgba(0,0,0,0.8);backdrop-filter:blur(20px);display:flex;align-items:center;padding:0 12px;z-index:100;border-top:1px solid rgba(255,255,255,0.1)}
.start-button{color:#fff;font-weight:600;display:flex;align-items:center;gap:8px;padding:6px 10px;border-radius:8px;transition:all .2s ease;font-size:14px;background:rgba(255,255,255,0.22);border:1px solid rgba(255,255,255,0.35);cursor:pointer;box-shadow:inset 0 0 0 1px rgba(255,255,255,0.06)}
.start-button:hover{background:rgba(255,255,255,0.32);border-color:rgba(255,255,255,0.5)}
.windows-logo{width:20px;height:20px;display:inline-block}
.taskbar-icons{display:flex;gap:8px;margin-left:10px}
.system-tray{display:flex;align-items:center;color:#fff;font-size:13px;padding:0 6px;white-space:nowrap;gap:6px;margin-left:auto}
.tray-chip{display:inline-flex;align-items:center;gap:8px;height:32px;padding:0 10px;background:rgba(255,255,255,0.08);border:1px solid rgba(255,255,255,0.2);border-radius:10px;cursor:pointer;user-select:none;box-shadow:0 2px 8px rgba(0,0,0,0.25), inset 0 0 0 1px rgba(255,255,255,0.06);transition:transform .12s ease, background .15s ease, border-color .15s ease}
.tray-chip:hover{background:rgba(255,255,255,0.16);border-color:rgba(255,255,255,0.35);transform:translateY(-1px)}
.tray-time{min-width:92px;justify-content:center;font-variant-numeric:tabular-nums}

/* ==== Start menu (enhanced) ==== */
.start-menu{position:absolute;bottom:52px;left:12px;width:520px;height:440px;background:rgba(30,30,30,0.97);color:#fff;border:1px solid rgba(255,255,255,0.12);border-radius:12px;box-shadow:0 12px 40px rgba(0,0,0,0.4);backdrop-filter:blur(16px);display:none;overflow:hidden;z-index:200}
.start-search{background:rgba(255,255,255,0.1);margin:12px;padding:8px 12px;border-radius:8px;display:flex;align-items:center;gap:8px}
.start-search input{background:none;border:none;color:#fff;flex:1;font-size:14px}
.start-search input::placeholder{color:rgba(255,255,255,0.7)}
.start-menu-body{display:grid;grid-template-columns:1fr 1fr;height:calc(100% - 80px)}
.start-menu-left{padding:16px;background:rgba(255,255,255,0.02);border-right:1px solid rgba(255,255,255,0.08)}
.start-menu-right{padding:16px}
.app-item{display:flex;align-items:center;gap:12px;padding:12px;border-radius:8px;cursor:pointer;transition:background .2s ease;margin-bottom:8px}
.app-item:hover{background:rgba(255,255,255,0.08)}
.app-item .icon{width:32px;height:32px;border-radius:6px;background:#0078d4;display:flex;align-items:center;justify-content:center;font-size:16px}
.instructions-icon{background:linear-gradient(45deg,#ff6b35,#f7931e)!important}
.settings-icon{background:linear-gradient(45deg,#00bcff,#0078d7)!important}
.app-list{max-height:100%;overflow-y:auto}
.start-menu-all-apps{position:absolute;bottom:0;left:0;right:0;background:rgba(255,255,255,0.05);padding:12px;text-align:center;cursor:pointer;border-top:1px solid rgba(255,255,255,0.1)}
.start-menu-all-apps:hover{background:rgba(255,255,255,0.1)}

/* ==== All Apps Menu ==== */
.all-apps-menu{position:absolute;bottom:52px;left:12px;width:520px;height:440px;background:rgba(30,30,30,0.97);color:#fff;border:1px solid rgba(255,255,255,0.12);border-radius:12px;box-shadow:0 12px 40px rgba(0,0,0,0.4);backdrop-filter:blur(16px);display:none;overflow:hidden;z-index:200}
.all-apps-header{display:flex;align-items:center;gap:12px;padding:16px;border-bottom:1px solid rgba(255,255,255,0.1)}
.all-apps-back{background:none;border:none;color:#fff;cursor:pointer;padding:4px}
.all-apps-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:8px;padding:16px;height:calc(100% - 73px);overflow-y:auto}
.all-apps-item{display:flex;align-items:center;gap:12px;padding:12px;border-radius:8px;cursor:pointer;transition:background .2s ease}
.all-apps-item:hover{background:rgba(255,255,255,0.08)}

/* ==== Tray popover (calendar) (from template) ==== */
.tray-popover{position:absolute;display:none;min-width:300px;background:rgba(30,30,30,0.97);color:#fff;border:1px solid rgba(255,255,255,0.12);border-radius:12px;box-shadow:0 12px 40px rgba(0,0,0,0.4);z-index:400;overflow:hidden;backdrop-filter:blur(16px)}
.tray-popover .pop-header{padding:12px 16px;background:rgba(255,255,255,0.06);border-bottom:1px solid rgba(255,255,255,0.1);font-weight:600;font-size:13px}
.tray-popover .pop-body{padding:14px 16px;font-size:13px;max-height:380px;overflow:auto}
.calendar{width:100%;user-select:none}
.calendar .big-clock{font-size:28px;font-weight:700;margin-bottom:6px}
.calendar .small-date{opacity:.9;margin-bottom:10px}
.calendar .cal-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:6px}
.calendar .month{font-weight:600}
.calendar .grid{display:grid;grid-template-columns:repeat(7,1fr);gap:4px;font-size:12px}
.calendar .dow{text-align:center;opacity:.8;padding:4px 0}
.calendar .day{text-align:center;padding:6px 0;border-radius:6px}
.calendar .day.today{background:#1976d4;color:#fff}
.calendar .day.other{opacity:.35}

/* ==== Sim Confirm Modal (replaces browser confirm) ==== */
.modal-overlay{position:fixed;inset:0;background:rgba(0,0,0,.4);display:none;align-items:center;justify-content:center;z-index:600}
.modal{width:420px;max-width:90vw;background:#fff;border:1px solid #c9c9c9;border-radius:12px;box-shadow:0 14px 40px rgba(0,0,0,.35);overflow:hidden;font-size:14px}
.modal-header{background:#e9e9e9;padding:10px 12px;font-weight:600;border-bottom:1px solid #cfcfcf}
.modal-body{padding:14px}
.modal-actions{display:flex;gap:8px;justify-content:flex-end;padding:12px;border-top:1px solid #eee;background:#fafafa}
.modal-actions button{min-width:92px}
.modal-actions .btn-danger{background:#d83b01;color:#fff;border-color:#d83b01}

</style>
</head>
<body>
  <div id="desktop">
    <!-- Desktop icons -->
    <div class="desktop-icon" id="thisPcIcon" style="left:20px;top:20px;">
      <img alt="This PC" src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='48' height='48'><rect width='46' height='34' x='1' y='4' rx='6' ry='6' fill='%23ffffff' stroke='%23000' stroke-width='0.5'/><rect x='8' y='40' width='32' height='4' fill='%23ffffff' stroke='%23000' stroke-width='0.5'/></svg>" />
      <div class="label">This PC</div>
    </div>
    <div class="desktop-icon" id="controlPanelIcon" style="left:20px;top:120px;">
      <img alt="Control Panel" src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='48' height='48'><circle cx='24' cy='24' r='22' fill='%23ffffff' stroke='%23000' stroke-width='0.5'/><circle cx='24' cy='24' r='16' fill='%230078d4'/><circle cx='24' cy='24' r='8' fill='%23ffffff'/></svg>" />
      <div class="label">Control Panel</div>
    </div>

    <!-- Instructions window -->
    <div class="window" id="instructionsWindow">
      <div class="window-header">
        <div class="window-title">Lab 12: Uninstall a Program ‚Äì Instructions</div>
        <div class="window-controls">
          <div class="window-control" data-minimize title="Minimize">‚àí</div>
          <div class="window-control" data-maximize title="Maximize">‚¨ú</div>
          <div class="window-control" data-close title="Close">‚úï</div>
        </div>
      </div>
      <div class="window-body">
        <p><strong>Goal:</strong> Use multiple methods to uninstall <strong>Old Antivirus Security Suite</strong>.</p>
        <ol>
          <li><strong>Method 1 (Traditional):</strong> Open <strong>Control Panel</strong> ‚Üí <strong>Programs</strong> ‚Üí <strong>Programs and Features</strong></li>
          <li><strong>Method 2 (Modern):</strong> Open <strong>Settings</strong> ‚Üí <strong>Apps</strong> ‚Üí <strong>Apps & features</strong></li>
          <li><strong>Method 3 (Search):</strong> Use Start menu search for "Add or remove programs"</li>
          <li>Find and select <strong>Old Antivirus Security Suite</strong></li>
          <li>Click <strong>Uninstall</strong> and follow the wizard</li>
          <li>Wait for success confirmation. Use <strong>Reset Lab</strong> to restore initial state.</li>
        </ol>
        <div class="btnbar">
          <button id="resetLab">Reset Lab</button>
          <button id="closeBrowser">Close Lab</button>
        </div>
      </div>
    </div>

    <!-- Control Panel main window -->
    <div class="window" id="controlPanel" style="left:260px;top:90px;width:760px;height:520px;">
      <div class="window-header">
        <div class="window-title">Control Panel</div>
        <div class="window-controls">
          <div class="window-control" data-minimize title="Minimize">‚àí</div>
          <div class="window-control" data-maximize title="Maximize">‚¨ú</div>
          <div class="window-control" data-close title="Close">‚úï</div>
        </div>
      </div>
      <div class="window-body">
        <div class="cp-view-controls">
          <button class="cp-view-btn active" data-view="category">Category</button>
          <button class="cp-view-btn" data-view="icons">Large icons</button>
          <button class="cp-view-btn" data-view="icons">Small icons</button>
          <input type="text" class="cp-search" placeholder="Search Control Panel">
        </div>
        
        <div class="cp-category-view" id="categoryView">
          <div class="cp-category-item" data-category="programs">
            <div class="cp-category-icon">üì¶</div>
            <div class="cp-category-text">
              <div>Programs</div>
              <div class="cp-category-desc">Uninstall programs, turn Windows features on or off</div>
            </div>
          </div>
          <div class="cp-category-item">
            <div class="cp-category-icon">üñ•Ô∏è</div>
            <div class="cp-category-text">
              <div>System and Security</div>
              <div class="cp-category-desc">Review your computer's status, back up your computer</div>
            </div>
          </div>
          <div class="cp-category-item">
            <div class="cp-category-icon">üåê</div>
            <div class="cp-category-text">
              <div>Network and Internet</div>
              <div class="cp-category-desc">View network status and tasks, connect to the Internet</div>
            </div>
          </div>
        </div>
        
        <div class="cp-grid-view" id="gridView">
          <div class="cp-item" id="cpPrograms">
            <span class="cp-icon">üì¶</span>
            <div>Programs and Features</div>
          </div>
          <div class="cp-item"><span class="cp-icon">üñ•Ô∏è</span><div>System and Security</div></div>
          <div class="cp-item"><span class="cp-icon">üåê</span><div>Network and Internet</div></div>
          <div class="cp-item"><span class="cp-icon">üë§</span><div>User Accounts</div></div>
          <div class="cp-item"><span class="cp-icon">üõ°Ô∏è</span><div>Security &amp; Maintenance</div></div>
          <div class="cp-item"><span class="cp-icon">üé®</span><div>Appearance</div></div>
        </div>
      </div>
    </div>

    <!-- Programs & Features window -->
    <div class="window" id="programsWin" style="left:300px;top:120px;width:760px;height:520px;">
      <div class="window-header">
        <div class="window-title">Programs and Features</div>
        <div class="window-controls">
          <div class="window-control" data-minimize title="Minimize">‚àí</div>
          <div class="window-control" data-maximize title="Maximize">‚¨ú</div>
          <div class="window-control" data-close title="Close">‚úï</div>
        </div>
      </div>
      <div class="window-body">
        <div class="toolbar">
          <button class="btn-danger" id="btnUninstall" disabled>Uninstall</button>
          <button disabled>Change</button>
          <button disabled>Repair</button>
          <select style="margin-left: auto; font-size: 12px; padding: 4px;">
            <option>Sort by: Name</option>
            <option>Sort by: Size</option>
            <option>Sort by: Installed On</option>
          </select>
        </div>
        <div style="height:calc(100% - 52px);overflow:auto">
          <table class="table" id="programsTable">
            <thead>
              <tr><th>Name</th><th>Publisher</th><th>Installed On</th><th>Size</th><th>Version</th></tr>
            </thead>
            <tbody>
              <tr><td>Adobe Acrobat Reader DC</td><td>Adobe Inc.</td><td>2024-04-15</td><td>435 MB</td><td>23.008.20421</td></tr>
              <tr><td>Google Chrome</td><td>Google LLC</td><td>2024-03-22</td><td>280 MB</td><td>121.0.6167.184</td></tr>
              <tr><td>Microsoft Office Professional Plus 2021</td><td>Microsoft</td><td>2024-02-08</td><td>2.8 GB</td><td>16.0.14332.20481</td></tr>
              <tr class="target" id="targetProgram"><td>Old Antivirus Security Suite</td><td>SecureTech Solutions</td><td>2024-01-10</td><td>320 MB</td><td>8.2.1045</td></tr>
              <tr><td>VLC Media Player</td><td>VideoLAN</td><td>2024-03-28</td><td>75 MB</td><td>3.0.20</td></tr>
              <tr><td>7-Zip 23.01</td><td>Igor Pavlov</td><td>2024-03-05</td><td>1.5 MB</td><td>23.01</td></tr>
              <tr><td>Notepad++</td><td>Notepad++ Team</td><td>2024-04-02</td><td>8.2 MB</td><td>8.6.4</td></tr>
            </tbody>
          </table>
        </div>
        
        <!-- Uninstall Wizard -->
        <div class="wizard" id="uninstallWizard">
          <div class="wizard-header">Uninstall Old Antivirus Security Suite</div>
          <div class="wizard-body">
            <div class="wizard-icon">üîÑ</div>
            <h3>Uninstalling Old Antivirus Security Suite</h3>
            <p>Please wait while the program is being uninstalled...</p>
            <div class="wizard-progress">
              <div class="wizard-progress-bar" id="wizardProgress"></div>
            </div>
            <p id="wizardStatus">Preparing to uninstall...</p>
          </div>
          <div class="wizard-actions">
            <button id="wizardCancel">Cancel</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Settings App (Modern) -->
    <div class="window" id="settingsWindow">
      <div class="window-header">
        <div class="window-title">Settings</div>
        <div class="window-controls">
          <div class="window-control" data-minimize title="Minimize">‚àí</div>
          <div class="window-control" data-maximize title="Maximize">‚¨ú</div>
          <div class="window-control" data-close title="Close">‚úï</div>
        </div>
      </div>
      <div class="settings-nav">
        <div class="settings-nav-item active" data-page="apps">Apps</div>
        <div class="settings-nav-item" data-page="system">System</div>
        <div class="settings-nav-item" data-page="devices">Devices</div>
        <div class="settings-nav-item" data-page="network">Network & Internet</div>
      </div>
      <div class="settings-content">
        <div class="settings-sidebar">
          <div class="settings-option active" data-section="apps-features">Apps & features</div>
          <div class="settings-option" data-section="default-apps">Default apps</div>
          <div class="settings-option" data-section="offline-maps">Offline maps</div>
        </div>
        <div class="settings-main">
          <h3>Apps & features</h3>
          <p>Uninstall, move, or modify apps on your computer</p>
          <div style="margin: 16px 0;">
            <input type="text" placeholder="Search this list..." style="width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 4px;">
          </div>
          <div class="settings-option" data-app="target">
            <div>
              <strong>Old Antivirus Security Suite</strong>
              <div style="font-size: 12px; color: #666;">SecureTech Solutions ‚Ä¢ 320 MB</div>
            </div>
            <button class="btn-danger" style="font-size: 12px;">Uninstall</button>
          </div>
          <div class="settings-option">
            <div>
              <strong>Google Chrome</strong>
              <div style="font-size: 12px; color: #666;">Google LLC ‚Ä¢ 280 MB</div>
            </div>
            <button style="font-size: 12px;" disabled>Uninstall</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Start menu (enhanced) -->
  <div class="start-menu" id="startMenu">
    <div class="start-search">
      <span>üîç</span>
      <input type="text" placeholder="Type here to search" id="startSearch">
    </div>
    <div class="start-menu-body">
      <div class="start-menu-left">
        <div class="app-item" data-app="instructions">
          <div class="icon instructions-icon">üìã</div>
          <span>Instructions</span>
        </div>
        <div class="app-item" data-app="settings">
          <div class="icon settings-icon">‚öôÔ∏è</div>
          <span>Settings</span>
        </div>
        <div class="app-item" data-app="controlPanel">
          <div class="icon">üñ•Ô∏è</div>
          <span>Control Panel</span>
        </div>
      </div>
      <div class="start-menu-right">
        <div class="app-list">
          <div class="app-item" data-app="chrome">
            <div class="icon">üåê</div>
            <span>Google Chrome</span>
          </div>
          <div class="app-item" data-app="word">
            <div class="icon">üìù</div>
            <span>Word</span>
          </div>
          <div class="app-item" data-app="excel">
            <div class="icon">üìä</div>
            <span>Excel</span>
          </div>
        </div>
      </div>
    </div>
    <div class="start-menu-all-apps" id="showAllApps">
      All apps
    </div>
  </div>

  <!-- All Apps Menu -->
  <div class="all-apps-menu" id="allAppsMenu">
    <div class="all-apps-header">
      <button class="all-apps-back" id="backToStart">‚Üê</button>
      <div>All apps</div>
    </div>
    <div class="all-apps-grid">
      <div class="all-apps-item" data-app="controlPanel">
        <div class="icon">üñ•Ô∏è</div>
        <span>Control Panel</span>
      </div>
      <div class="all-apps-item" data-app="settings">
        <div class="icon settings-icon">‚öôÔ∏è</div>
        <span>Settings</span>
      </div>
      <div class="all-apps-item" data-app="chrome">
        <div class="icon">üåê</div>
        <span>Google Chrome</span>
      </div>
      <div class="all-apps-item" data-app="word">
        <div class="icon">üìù</div>
        <span>Word</span>
      </div>
      <div class="all-apps-item" data-app="excel">
        <div class="icon">üìä</div>
        <span>Excel</span>
      </div>
      <div class="all-apps-item" data-app="addRemove">
        <div class="icon">üì¶</div>
        <span>Add or remove programs</span>
      </div>
    </div>
  </div>

  <!-- Context menu for Start (right-click) -->
  <div class="context-menu" id="startContext">
    <div class="context-menu-item" data-app="controlPanel">Control Panel</div>
    <div class="context-menu-item" data-app="settings">Settings</div>
    <div class="context-menu-item" data-app="fileExplorer">File Explorer</div>
    <div class="context-menu-item" data-app="search">Search</div>
    <div class="context-menu-item" data-app="run">Run</div>
    <div class="context-menu-item" data-app="taskManager">Task Manager</div>
  </div>

  <!-- Taskbar -->
  <div class="taskbar">
    <div class="start-button" id="startButton" title="Start">
      <span class="windows-logo">
        <svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
          <rect x="1" y="1" width="8" height="8" fill="#00BCF2"/>
          <rect x="11" y="1" width="8" height="8" fill="#00BCF2"/>
          <rect x="1" y="11" width="8" height="8" fill="#00BCF2"/>
          <rect x="11" y="11" width="8" height="8" fill="#00BCF2"/>
        </svg>
      </span>
      Start
    </div>
    <div class="taskbar-icons"></div>
    <div class="system-tray" id="systemTray">
      <div class="tray-chip tray-time" id="trayTimeChip" title="Date and time">
        <span id="trayTime">--:--</span>
      </div>
    </div>
  </div>

  <!-- Tray popover: Calendar -->
  <div class="tray-popover" id="timePopover">
    <div class="pop-header">Date &amp; time</div>
    <div class="pop-body">
      <div class="calendar">
        <div class="big-clock" id="bigClock">--:--</div>
        <div class="small-date" id="smallDate">---</div>
        <div class="cal-header">
          <div class="month" id="monthLabel">Month YYYY</div>
        </div>
        <div class="grid" id="calGrid"></div>
      </div>
    </div>
  </div>

  <div id="toast"></div>

  <!-- Simulated Confirm Modal -->
  <div class="modal-overlay" id="confirmOverlay" aria-hidden="true">
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="confirmTitle">
      <div class="modal-header" id="confirmTitle">Confirm Uninstall</div>
      <div class="modal-body"><div id="confirmMessage">Are you sure?</div></div>
      <div class="modal-actions">
        <button id="confirmNo">No</button>
        <button id="confirmYes" class="btn-danger">Yes</button>
      </div>
    </div>
  </div>

<script>
window.addEventListener('DOMContentLoaded', () => {
  /* ===== Utils ===== */
  const $ = (sel, root=document) => root.querySelector(sel);
  const $$ = (sel, root=document) => Array.from(root.querySelectorAll(sel));
  function flashToast(msg, ms=1800){ const t=$('#toast'); t.textContent=msg; t.style.display='block'; setTimeout(()=>t.style.display='none', ms); }
  function clamp(v,min,max){ return Math.max(min, Math.min(max, v)); }

  /* ===== Elements ===== */
  const startButton = $('#startButton');
  const startMenu = $('#startMenu');
  const allAppsMenu = $('#allAppsMenu');
  const startContext = $('#startContext');
  const instructionsWindow = $('#instructionsWindow');
  const controlPanel = $('#controlPanel');
  const programsWin = $('#programsWin');
  const settingsWindow = $('#settingsWindow');
  const resetLab = $('#resetLab');
  const closeBrowser = $('#closeBrowser');
  const desktop = $('#desktop');
  const startSearch = $('#startSearch');

  /* ===== Enhanced Start Menu ===== */
  startButton.addEventListener('click', (e)=>{
    e.stopPropagation();
    startMenu.style.display = (startMenu.style.display==='block') ? 'none' : 'block';
    allAppsMenu.style.display = 'none';
    startContext.style.display='none';
  });

  $('#showAllApps').addEventListener('click', () => {
    startMenu.style.display = 'none';
    allAppsMenu.style.display = 'block';
  });

  $('#backToStart').addEventListener('click', () => {
    allAppsMenu.style.display = 'none';
    startMenu.style.display = 'block';
  });

  // Start menu search functionality
  startSearch.addEventListener('input', (e) => {
    const query = e.target.value.toLowerCase();
    if (query.includes('add or remove') || query.includes('uninstall') || query.includes('programs')) {
      flashToast('Try opening "Add or remove programs" from All apps or Control Panel');
    }
  });

  startSearch.addEventListener('keypress', (e) => {
    if (e.key === 'Enter') {
      const query = startSearch.value.toLowerCase();
      if (query.includes('control panel')) {
        openApp('controlPanel');
        startMenu.style.display = 'none';
      } else if (query.includes('settings')) {
        openApp('settings');
        startMenu.style.display = 'none';
      } else if (query.includes('add or remove') || query.includes('uninstall')) {
        openApp('programs');
        startMenu.style.display = 'none';
        flashToast('Opening Programs and Features');
      }
    }
  });

  startButton.addEventListener('contextmenu', (e)=>{
    e.preventDefault(); e.stopPropagation();
    startMenu.style.display='none';
    allAppsMenu.style.display='none';
    const rect = desktop.getBoundingClientRect();
    let x = e.clientX - rect.left, y = e.clientY - rect.top; const mw=220, mh=200, tb=48, m=8;
    x = clamp(x, m, desktop.clientWidth - mw - m);
    y = clamp(y, m, desktop.clientHeight - tb - mh - m);
    startContext.style.left = x + 'px';
    startContext.style.top  = y + 'px';
    startContext.style.display='block';
  });

  document.addEventListener('click', (e)=>{
    if(!startMenu.contains(e.target) && e.target!==startButton && !startButton.contains(e.target)) startMenu.style.display='none';
    if(!allAppsMenu.contains(e.target)) allAppsMenu.style.display='none';
    if(!startContext.contains(e.target)) startContext.style.display='none';
  });

  /* ===== Enhanced App Opening ===== */
  function openApp(app){
    if(app==='instructions'){ instructionsWindow.style.display='flex'; return; }
    if(app==='controlPanel'){ controlPanel.style.display='flex'; programsWin.style.display='none'; settingsWindow.style.display='none'; return; }
    if(app==='settings'){ settingsWindow.style.display='flex'; controlPanel.style.display='none'; programsWin.style.display='none'; return; }
    if(app==='programs'){ programsWin.style.display='flex'; controlPanel.style.display='none'; settingsWindow.style.display='none'; return; }
    if(app==='addRemove'){ programsWin.style.display='flex'; controlPanel.style.display='none'; settingsWindow.style.display='none'; flashToast('Opening Programs and Features'); return; }
  }

  $$('.app-item, .all-apps-item').forEach(a=>a.addEventListener('click',()=>{ 
    openApp(a.dataset.app); 
    startMenu.style.display='none'; 
    allAppsMenu.style.display='none'; 
  }));

  $$('#startContext .context-menu-item').forEach(i=>i.addEventListener('click',()=>{ 
    openApp(i.dataset.app); 
    startContext.style.display='none'; 
  }));

  // Desktop icons
  $('#controlPanelIcon').addEventListener('click', () => openApp('controlPanel'));

  /* ===== Enhanced Control Panel ===== */
  // View switching
  $$('.cp-view-btn').forEach(btn => {
    btn.addEventListener('click', () => {
      $$('.cp-view-btn').forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
      
      if (btn.dataset.view === 'category') {
        $('#categoryView').style.display = 'block';
        $('#gridView').style.display = 'none';
      } else {
        $('#categoryView').style.display = 'none';
        $('#gridView').style.display = 'grid';
      }
    });
  });

  // Category navigation
  $$('.cp-category-item').forEach(item => {
    item.addEventListener('click', () => {
      if (item.dataset.category === 'programs') {
        controlPanel.style.display = 'none';
        programsWin.style.display = 'flex';
      }
    });
  });

  // Control Panel search
  $('.cp-search').addEventListener('input', (e) => {
    const query = e.target.value.toLowerCase();
    if (query.includes('program') || query.includes('uninstall')) {
      flashToast('Try "Programs and Features" in the Programs category');
    }
  });

  /* ===== Enhanced Programs & Features ===== */
  $('#cpPrograms').addEventListener('click', ()=>{ 
    controlPanel.style.display='none'; 
    programsWin.style.display='flex'; 
  });

  // Settings app uninstall
  $$('#settingsWindow .settings-option').forEach(opt => {
    opt.addEventListener('click', () => {
      if (opt.dataset.app === 'target') {
        showConfirm('Are you sure you want to uninstall "Old Antivirus Security Suite"?', () => {
          simulateUninstall();
        });
      }
    });
  });

  // Table sorting
  $$('#programsTable thead th').forEach((th, index) => {
    th.addEventListener('click', () => {
      flashToast(`Sorted by ${th.textContent}`);
    });
  });

  // Programs table selection + uninstall flow
  const table = $('#programsTable');
  function clearSel(){ $$('#programsTable tbody tr').forEach(r=>r.classList.remove('selected')); }
  function enableUninstall(on){ $('#btnUninstall').disabled = !on; }
  table.addEventListener('click', (e)=>{
    const row = e.target.closest('tbody tr'); if(!row) return;
    clearSel(); row.classList.add('selected');
    enableUninstall(true);
  });

  /* ===== Enhanced Uninstall Flow with Wizard ===== */
  function simulateUninstall() {
    const wizard = $('#uninstallWizard');
    const progress = $('#wizardProgress');
    const status = $('#wizardStatus');
    
    wizard.style.display = 'flex';
    let progressValue = 0;
    
    const steps = [
      'Preparing to uninstall...',
      'Running uninstaller...',
      'Removing program files...',
      'Cleaning up registry...',
      'Finalizing...',
      'Uninstall complete!'
    ];
    
    const interval = setInterval(() => {
      progressValue += 20;
      progress.style.width = `${progressValue}%`;
      
      if (progressValue <= 100) {
        status.textContent = steps[Math.floor(progressValue / 20)];
      }
      
      if (progressValue >= 100) {
        clearInterval(interval);
        setTimeout(() => {
          wizard.style.display = 'none';
          const target = $('#targetProgram');
          if (target) {
            target.parentElement.removeChild(target);
            flashToast('‚úÖ Excellent! You successfully uninstalled Old Antivirus Security Suite');
            enableUninstall(false);
            clearSel();
          }
        }, 1000);
      }
    }, 600);
    
    $('#wizardCancel').addEventListener('click', () => {
      clearInterval(interval);
      wizard.style.display = 'none';
      flashToast('Uninstall cancelled');
    }, { once: true });
  }

  // Confirm dialog
  let confirming = false;
  function showConfirm(message, onYes){
    if(confirming) return; confirming = true;
    const overlay = $('#confirmOverlay');
    const msgEl = $('#confirmMessage');
    const yesBtn = $('#confirmYes');
    const noBtn  = $('#confirmNo');
    msgEl.textContent = message;
    overlay.style.display = 'flex';

    function cleanup(){
      overlay.style.display = 'none';
      yesBtn.removeEventListener('click', yesHandler);
      noBtn.removeEventListener('click', noHandler);
      confirming = false;
    }
    function yesHandler(){
      cleanup();
      onYes && onYes();
    }
    function noHandler(){
      cleanup();
    }
    yesBtn.addEventListener('click', yesHandler, { once: true });
    noBtn.addEventListener('click', noHandler, { once: true });
  }

  $('#btnUninstall').addEventListener('click', ()=>{
    const sel = table.querySelector('tbody tr.selected'); 
    if(!sel) return;
    const name = sel.children[0].textContent.trim();
    const isTarget = sel.id === 'targetProgram';
    
    showConfirm(`Are you sure you want to uninstall "${name}"?`, ()=>{
      if (isTarget) {
        simulateUninstall();
      } else {
        sel.parentElement.removeChild(sel);
        enableUninstall(false);
        flashToast('‚úÖ Program uninstalled successfully');
      }
    });
  });

  /* ===== Reset & Close Lab ===== */
  function resetPrograms(){
    const tbody = table.querySelector('tbody');
    tbody.innerHTML = `
      <tr><td>Adobe Acrobat Reader DC</td><td>Adobe Inc.</td><td>2024-04-15</td><td>435 MB</td><td>23.008.20421</td></tr>
      <tr><td>Google Chrome</td><td>Google LLC</td><td>2024-03-22</td><td>280 MB</td><td>121.0.6167.184</td></tr>
      <tr><td>Microsoft Office Professional Plus 2021</td><td>Microsoft</td><td>2024-02-08</td><td>2.8 GB</td><td>16.0.14332.20481</td></tr>
      <tr class="target" id="targetProgram"><td>Old Antivirus Security Suite</td><td>SecureTech Solutions</td><td>2024-01-10</td><td>320 MB</td><td>8.2.1045</td></tr>
      <tr><td>VLC Media Player</td><td>VideoLAN</td><td>2024-03-28</td><td>75 MB</td><td>3.0.20</td></tr>
      <tr><td>7-Zip 23.01</td><td>Igor Pavlov</td><td>2024-03-05</td><td>1.5 MB</td><td>23.01</td></tr>
      <tr><td>Notepad++</td><td>Notepad++ Team</td><td>2024-04-02</td><td>8.2 MB</td><td>8.6.4</td></tr>`;
    enableUninstall(false); clearSel();
  }

  resetLab.addEventListener('click', ()=>{
    [controlPanel, programsWin, settingsWindow].forEach(w=>w.style.display='none');
    Object.assign(instructionsWindow.style, {display:'flex', left:'20px', top:'20px', width:'440px', height:'360px'});
    $('#uninstallWizard').style.display = 'none';
    resetPrograms();
    flashToast('Lab reset to initial state');
  });

  closeBrowser.addEventListener('click', ()=>{
    flashToast('Closing lab‚Ä¶');
    setTimeout(()=>{ window.location.href='about:blank'; }, 300);
  });

  /* ===== Window controls & dragging ===== */
  document.querySelectorAll('[data-close]').forEach(btn=>btn.addEventListener('click', (e)=>{ e.stopPropagation(); btn.closest('.window').style.display='none'; }));
  document.querySelectorAll('[data-minimize]').forEach(btn=>btn.addEventListener('click', (e)=>{ e.stopPropagation(); btn.closest('.window').style.display='none'; }));
  document.querySelectorAll('[data-maximize]').forEach(btn=>btn.addEventListener('click', (e)=>{
    e.stopPropagation(); const w = btn.closest('.window');
    if (w.style.width === '100%') {
      if (w.id === 'instructionsWindow') { Object.assign(w.style,{width:'440px',height:'360px',left:'20px',top:'20px'}); }
      if (w.id === 'controlPanel')      { Object.assign(w.style,{width:'760px',height:'520px',left:'260px',top:'90px'}); }
      if (w.id === 'programsWin')       { Object.assign(w.style,{width:'760px',height:'520px',left:'300px',top:'120px'}); }
      if (w.id === 'settingsWindow')    { Object.assign(w.style,{width:'800px',height:'500px',left:'100px',top:'60px'}); }
    } else {
      Object.assign(w.style,{width:'100%',height:'calc(100% - 48px)',left:'0',top:'0'});
    }
  }));

  let dragWin=null, sx=0, sy=0, ix=0, iy=0, dragging=false;
  $$('.window-header').forEach(h=>{
    h.addEventListener('mousedown', e=>{
      if(e.target.closest('.window-control')) return;
      e.preventDefault(); dragWin = h.closest('.window'); dragging=true;
      sx=e.clientX; sy=e.clientY; ix=parseInt(dragWin.style.left||getComputedStyle(dragWin).left); iy=parseInt(dragWin.style.top||getComputedStyle(dragWin).top);
      document.addEventListener('mousemove', onDrag); document.addEventListener('mouseup', stopDrag);
    });
  });
  function onDrag(e){ if(!dragging||!dragWin) return; dragWin.style.left=(ix + (e.clientX-sx))+'px'; dragWin.style.top=(iy + (e.clientY-sy))+'px'; }
  function stopDrag(){ dragging=false; dragWin=null; document.removeEventListener('mousemove', onDrag); document.removeEventListener('mouseup', stopDrag); }

  /* ===== Tray time + calendar ===== */
  const trayChip = $('#trayTimeChip'); const timePopover = $('#timePopover'); const trayTime = $('#trayTime');
  function togglePopover(popover, anchor){
    const r = anchor.getBoundingClientRect();
    popover.style.right  = (window.innerWidth - r.right) + 'px';
    popover.style.bottom = (window.innerHeight - r.top + 8) + 'px';
    const open = popover.style.display==='block';
    document.querySelectorAll('.tray-popover').forEach(p=>p.style.display='none');
    if(!open) popover.style.display='block';
  }
  trayChip.addEventListener('click', ()=>togglePopover(timePopover, trayChip));
  document.addEventListener('click', (e)=>{ if(!timePopover.contains(e.target) && e.target!==trayChip && !trayChip.contains(e.target)) timePopover.style.display='none'; });

  function pad(n){ return n.toString().padStart(2,'0'); }
  function buildCalendar(date){
    const bigClock=$('#bigClock'), smallDate=$('#smallDate'), monthLabel=$('#monthLabel'), grid=$('#calGrid');
    const d = new Date();
    bigClock.textContent = pad(d.getHours()) + ':' + pad(d.getMinutes());
    smallDate.textContent = d.toLocaleDateString(undefined,{weekday:'long', year:'numeric', month:'long', day:'numeric'});
    trayTime.textContent = pad(d.getHours())+':'+pad(d.getMinutes());

    const year=d.getFullYear(), month=d.getMonth();
    monthLabel.textContent = d.toLocaleDateString(undefined,{month:'long', year:'numeric'});
    grid.innerHTML = '';
    const first = new Date(year, month, 1); const startDow=(first.getDay()+6)%7; // Mon=0
    const daysInMonth = new Date(year, month+1, 0).getDate();
    const prevDays = new Date(year, month, 0).getDate();

    // DOW header
    const dows=['Mon','Tue','Wed','Thu','Fri','Sat','Sun'];
    grid.insertAdjacentHTML('beforeend', dows.map(d=>`<div class="dow">${d}</div>`).join(''));

    // Previous month filler
    for(let i=0;i<startDow;i++) grid.insertAdjacentHTML('beforeend', `<div class="day other">${prevDays - startDow + i + 1}</div>`);
    // Current month
    const today = new Date();
    for(let day=1; day<=daysInMonth; day++){
      const isToday = day===today.getDate() && month===today.getMonth() && year===today.getFullYear();
      grid.insertAdjacentHTML('beforeend', `<div class="day${isToday? ' today':''}">${day}</div>`);
    }
  }
  buildCalendar(); setInterval(buildCalendar, 30*1000);

  // Initial state
  instructionsWindow.style.display='flex';
});
</script>
</body>
</html>