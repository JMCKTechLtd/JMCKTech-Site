<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <title>RHCSA Lab 6</title>
    <style>
        :root {
            --redhat-red: #cc0000;
            --redhat-dark: #1e1e1e;
            --redhat-light: #f0f0f0;
            --redhat-accent: #4CAF50;
            --redhat-blue: #007ACC;
        }
        body {
            font-family: 'Red Hat Text', 'Overpass', sans-serif;
            background-color: var(--redhat-dark);
            color: var(--redhat-light);
            margin: 0;
            padding: 0;
            line-height: 1.6;
        }
        .lab-container {
            max-width: 900px;
            margin: 20px auto;
            background: #252525;
            border-radius: 8px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
            overflow: hidden;
            border-top: 4px solid var(--redhat-red);
        }
        .header {
            background: linear-gradient(to right, #1e1e1e, #333);
            padding: 15px 20px;
            color: white;
            display: flex;
            align-items: center;
            border-bottom: 1px solid #444;
        }
        .header img {
            height: 30px;
            margin-right: 15px;
        }
        .header h1 {
            margin: 0;
            font-size: 1.5em;
            font-weight: normal;
        }
        .terminal-container {
            display: flex;
            flex-direction: column;
            height: 600px;
        }
        .guide {
            padding: 20px;
            background: #2d2d2d;
            flex: 1;
            overflow-y: auto;
        }
        .guide h2 {
            margin-top: 0;
            color: var(--redhat-accent);
            border-bottom: 1px solid #444;
            padding-bottom: 10px;
        }
        .guide-step {
            margin-bottom: 15px;
            padding: 15px;
            background: #333;
            border-left: 4px solid var(--redhat-accent);
        }
        .terminal {
            background: #000;
            padding: 15px;
            height: 250px;
            overflow-y: auto;
            font-family: 'Red Hat Mono', monospace;
            border-top: 1px solid #444;
        }
        .prompt {
            color: var(--redhat-accent);
        }
        .command-line {
            display: flex;
            align-items: center;
            padding: 15px;
            background: #333;
            border-top: 1px solid #444;
        }
        #command-input {
            flex: 1;
            background: transparent;
            border: none;
            color: var(--redhat-light);
            font-family: 'Red Hat Mono', monospace;
            font-size: 16px;
            outline: none;
            padding: 8px;
        }
        .success {
            color: var(--redhat-accent);
            font-weight: bold;
        }
        .error {
            color: #FF5252;
        }
        .completion {
            color: #FFD700;
            font-weight: bold;
        }
        .concept {
            background: #2a2a2a;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
            border-left: 4px solid var(--redhat-blue);
        }
        .concept h4 {
            margin-top: 0;
            color: var(--redhat-blue);
            border-bottom: 1px solid #444;
            padding-bottom: 5px;
        }
        .concept-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-bottom: 10px;
        }
        .concept-item {
            background: #252525;
            padding: 10px;
            border-radius: 5px;
            border-left: 2px solid var(--redhat-red);
        }
        .concept-item strong {
            color: var(--redhat-red);
            display: block;
            margin-bottom: 5px;
        }
        code {
            background: #1e1e1e;
            padding: 2px 5px;
            border-radius: 3px;
            color: var(--redhat-accent);
            font-family: 'Red Hat Mono', monospace;
        }
        kbd {
            background: #444;
            padding: 2px 5px;
            border-radius: 3px;
            color: white;
            font-family: 'Red Hat Mono', monospace;
        }
        .required-command {
            background: rgba(76, 175, 80, 0.1);
            padding: 5px;
            border-radius: 3px;
            border-left: 3px solid var(--redhat-accent);
        }
        .trophy {
            display: inline-block;
            margin-left: 5px;
        }
        .syntax-error {
            color: #FF5252;
            font-weight: bold;
        }
        .warning {
            color: #FFD700;
            font-weight: bold;
        }
        .strict-feedback {
            background: rgba(204, 0, 0, 0.1);
            padding: 10px;
            border-radius: 5px;
            border-left: 3px solid var(--redhat-red);
            margin-top: 10px;
        }
        .requirements-panel {
            background: #2a2a2a;
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 5px;
            border-left: 4px solid var(--redhat-red);
        }
        .requirements-panel h4 {
            margin-top: 0;
            color: var(--redhat-red);
            border-bottom: 1px solid #444;
            padding-bottom: 5px;
        }
        .requirement-item {
            display: flex;
            align-items: center;
            margin: 8px 0;
            padding: 8px;
            background: #252525;
            border-radius: 3px;
        }
        .requirement-item.completed {
            border-left: 3px solid var(--redhat-accent);
        }
        .requirement-item.partial {
            border-left: 3px solid #FFD700;
        }
        .requirement-checkbox {
            margin-right: 10px;
            color: var(--redhat-accent);
        }
        .requirement-label {
            flex: 1;
        }
        .file-content {
            background: #1e1e1e;
            padding: 10px;
            border-radius: 3px;
            font-family: 'Red Hat Mono', monospace;
            white-space: pre;
            overflow-x: auto;
        }
        .file-path {
            color: var(--redhat-blue);
            font-weight: bold;
            margin-bottom: 5px;
        }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Red+Hat+Text:wght@400;700&family=Red+Hat+Mono&display=swap" rel="stylesheet"/>
</head>
<body>
<div class="lab-container">
    <div class="header">
        <img alt="Red Hat Logo" src="https://www.redhat.com/profiles/rh/themes/redhatdotcom/img/logo.svg"/>
        <h1>RHCSA Lab 6</h1>
    </div>
    <div class="terminal-container">
        <div class="guide">
            <h2>Lab Instructions</h2>
            
            <div class="requirements-panel">
                <h4>File Filtering Requirements</h4>
                <div class="requirement-item" id="req-grep-command">
                    <span class="requirement-checkbox">‚òê</span>
                    <span class="requirement-label">Use <code>grep</code> to find lines containing "abcde" in <code>/etc/testfile</code></span>
                </div>
                <div class="requirement-item" id="req-output-redirection">
                    <span class="requirement-checkbox">‚òê</span>
                    <span class="requirement-label">Redirect the output to <code>/tmp/testfile</code></span>
                </div>
                <div class="requirement-item" id="req-preserve-order">
                    <span class="requirement-checkbox">‚òê</span>
                    <span class="requirement-label">Preserve the original line order from <code>/etc/testfile</code></span>
                </div>
                <div class="requirement-item" id="req-verify-result">
                    <span class="requirement-checkbox">‚òê</span>
                    <span class="requirement-label">Verify the contents of <code>/tmp/testfile</code></span>
                </div>
            </div>

            <div class="concept">
                <h4>File Filtering Methods</h4>
                <div class="concept-grid">
                    <div class="concept-item">
                        <strong>grep Command</strong>
                        <code>grep 'pattern' file</code> searches for lines matching the pattern<br>
                        Basic syntax: <code>grep [options] pattern [file...]</code>
                    </div>
                    <div class="concept-item">
                        <strong>Output Redirection</strong>
                        <code>> file</code> overwrites output to file<br>
                        <code>>> file</code> appends output to file<br>
                        <code>| tee file</code> displays and saves output
                    </div>
                    <div class="concept-item">
                        <strong>Preserving Order</strong>
                        Simple grep preserves original order<br>
                        For complex filtering, use while loops to process line by line
                    </div>
                    <div class="concept-item">
                        <strong>Verification</strong>
                        Use <code>cat</code> to view file contents<br>
                        <code>diff</code> to compare files<br>
                        <code>wc -l</code> to count matching lines
                    </div>
                </div>
            </div>

            <div class="guide-step" id="step1">
                <h3>Step 1: Find Lines Containing "abcde"</h3>
                <p>Use grep to search for the pattern "abcde" in /etc/testfile:</p>
                
                <div class="required-command">
                    <p><strong>Basic grep command:</strong></p>
                    <p>Type: <code>grep 'abcde' /etc/testfile</code></p>
                    <p>This will display all lines containing "abcde" while preserving the original order.</p>
                </div>
                
                <div class="concept">
                    <h4>Understanding grep</h4>
                    <p>The grep command searches for patterns in files. Key points:</p>
                    <ul>
                        <li>By default, grep is case-sensitive (use <code>-i</code> for case-insensitive)</li>
                        <li>Use quotes around the pattern to prevent shell interpretation</li>
                        <li>grep preserves the original line order from the input file</li>
                        <li>Exit status is 0 if matches found, 1 if no matches, 2 for errors</li>
                    </ul>
                </div>
            </div>

            <div class="guide-step" id="step2">
                <h3>Step 2: Redirect Output to /tmp/testfile</h3>
                <p>Redirect the grep output to save it in /tmp/testfile:</p>
                
                <div class="required-command">
                    <p><strong>Method 1: Simple redirection</strong></p>
                    <p>Type: <code>grep 'abcde' /etc/testfile > /tmp/testfile</code></p>
                </div>
                
                <div class="required-command">
                    <p><strong>Method 2: Using tee (displays and saves)</strong></p>
                    <p>Type: <code>grep 'abcde' /etc/testfile | tee /tmp/testfile</code></p>
                </div>
                
                <div class="required-command">
                    <p><strong>Method 3: Line-by-line processing (preserves order)</strong></p>
                    <div class="file-content">cat /etc/testfile | while read line; do
  echo "$line" | grep 'abcde' | tee -a /tmp/testfile
done</div>
                </div>

                <div class="concept">
                    <h4>Understanding Output Redirection</h4>
                    <p>Linux provides several ways to redirect command output:</p>
                    <ul>
                        <li><code>> file</code>: Overwrites file with output</li>
                        <li><code>>> file</code>: Appends output to file</li>
                        <li><code>| tee file</code>: Displays output and saves to file</li>
                        <li><code>| tee -a file</code>: Displays output and appends to file</li>
                    </ul>
                </div>
            </div>

            <div class="guide-step" id="step3">
                <h3>Step 3: Verify the Results</h3>
                <p>Check that the operation was successful:</p>
                
                <div class="required-command">
                    <p><strong>View the output file:</strong></p>
                    <p>Type: <code>cat /tmp/testfile</code></p>
                </div>
                
                <div class="required-command">
                    <p><strong>Count matching lines:</strong></p>
                    <p>Type: <code>wc -l /tmp/testfile</code></p>
                </div>
                
                <div class="required-command">
                    <p><strong>Compare with original:</strong></p>
                    <p>Type: <code>grep -n 'abcde' /etc/testfile</code> (shows line numbers)</p>
                </div>

                <div class="concept">
                    <h4>Verification Techniques</h4>
                    <p>Always verify your file operations:</p>
                    <ul>
                        <li><code>cat</code> shows the complete file contents</li>
                        <li><code>wc -l</code> counts lines to ensure all matches were captured</li>
                        <li><code>grep -n</code> shows line numbers to verify order preservation</li>
                        <li><code>diff</code> can compare filtered output with expected results</li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="command-line">
            <span class="prompt">[root@station ~]#</span>
            <input autofocus="" id="command-input" placeholder="Type a command..." type="text"/>
        </div>
        <div class="terminal" id="terminal-output">
            <div>[root@station ~]# <span class="prompt">Welcome to RHCSA Lab 1.6: File Filtering and Output Redirection</span></div>
            <div>[root@station ~]# <span class="prompt">Find lines containing "abcde" in /etc/testfile and save to /tmp/testfile</span></div>
        </div>
    </div>
</div>

<script>
    const commandInput = document.getElementById('command-input');
    const terminalOutput = document.getElementById('terminal-output');
    const requirementItems = document.querySelectorAll('.requirement-item');
    
    let commandHistory = [];
    let historyIndex = -1;
    
    // Track configuration state
    const configState = {
        grepCommand: false,
        outputRedirection: false,
        preserveOrder: false,
        verifyResult: false
    };
    
    // Simulated file contents
    const testFileContent = `This is a test file with multiple lines
Some lines contain abcde and some don't
abcde should be found in these lines
Another line with abcde in the middle
Final line without the pattern`;
    
    let tmpTestFileContent = "";
    
    const commands = {
        'cat': (args) => {
            if (args[0] === "/etc/testfile") {
                return testFileContent;
            } else if (args[0] === "/tmp/testfile") {
                if (tmpTestFileContent) {
                    configState.verifyResult = true;
                    updateRequirements();
                    return tmpTestFileContent;
                }
                return `cat: ${args[0]}: No such file or directory`;
            }
            return `cat: ${args[0]}: No such file or directory`;
        },
        'grep': (args) => {
            if (args.includes("/etc/testfile")) {
                configState.grepCommand = true;
                
                // Check if output is being redirected
                const outputIndex = args.indexOf(">");
                const teeIndex = args.indexOf("|");
                
                if (outputIndex !== -1 || teeIndex !== -1) {
                    configState.outputRedirection = true;
                    
                    // Check if order is preserved (not using sort or other order-changing commands)
                    if (!args.includes("sort") && !args.includes("awk") && !args.includes("cut")) {
                        configState.preserveOrder = true;
                    }
                    
                    // Simulate the output file creation
                    const pattern = args[0].replace(/'/g, '');
                    const matches = testFileContent.split('\n').filter(line => line.includes(pattern));
                    tmpTestFileContent = matches.join('\n');
                    
                    updateRequirements();
                    return ""; // No output when redirecting
                }
                
                // Just display matches if no redirection
                const pattern = args[0].replace(/'/g, '');
                return testFileContent.split('\n').filter(line => line.includes(pattern)).join('\n');
            }
            return `grep: ${args.join(' ')}: No such file or directory`;
        },
        'wc': (args) => {
            if (args[0] === "-l" && args[1] === "/tmp/testfile") {
                if (tmpTestFileContent) {
                    return `${tmpTestFileContent.split('\n').length} /tmp/testfile`;
                }
                return `wc: ${args[1]}: No such file or directory`;
            }
            return `wc: invalid option -- '${args[0]}'`;
        },
        'tee': (args) => {
            if (args.includes("/tmp/testfile")) {
                configState.outputRedirection = true;
                configState.preserveOrder = true;
                
                // Simulate the output file creation
                const pattern = 'abcde';
                const matches = testFileContent.split('\n').filter(line => line.includes(pattern));
                tmpTestFileContent = matches.join('\n');
                
                updateRequirements();
                return matches.join('\n'); // tee shows output and saves to file
            }
            return `tee: ${args.join(' ')}: No such file or directory`;
        },
        'help': () => 'Available commands: cat, grep, wc, tee, help',
    };
    
    commandInput.addEventListener('keydown', (e) => {
        if (e.key === 'Enter') {
            const commandText = commandInput.value.trim();
            if (commandText) {
                commandHistory.push(commandText);
                historyIndex = commandHistory.length;
                processCommand(commandText);
            }
            commandInput.value = '';
        } else if (e.key === 'ArrowUp') {
            if (historyIndex > 0) {
                historyIndex--;
                commandInput.value = commandHistory[historyIndex];
            }
        } else if (e.key === 'ArrowDown') {
            if (historyIndex < commandHistory.length - 1) {
                historyIndex++;
                commandInput.value = commandHistory[historyIndex];
            } else {
                historyIndex = commandHistory.length;
                commandInput.value = '';
            }
        } else if (e.key === 'Tab') {
            e.preventDefault();
            const partial = commandInput.value.split(' ').pop();
            const matches = ['/etc/testfile', '/tmp/testfile', 'abcde']
                .filter(cmd => cmd.startsWith(partial));
            if (matches.length === 1) {
                commandInput.value = commandInput.value.replace(new RegExp(partial + '$'), matches[0]);
            }
        }
    });
    
    function processCommand(commandText) {
        const parts = commandText.trim().split(/\s+/);
        const cmd = parts[0];
        const args = parts.slice(1);
        
        let output;
        if (commands[cmd]) {
            output = commands[cmd](args);
            if (output) {
                terminalOutput.innerHTML += `<div>[root@station ~]# ${commandText}</div><div>${output}</div>`;
            } else {
                terminalOutput.innerHTML += `<div>[root@station ~]# ${commandText}</div>`;
            }
        } else {
            terminalOutput.innerHTML += `<div>[root@station ~]# ${commandText}</div><div class="error">Command not found: ${cmd}. Type 'help' for available commands.</div>`;
        }
        
        terminalOutput.scrollTop = terminalOutput.scrollHeight;
        
        // Check if all requirements are met
        if (Object.values(configState).every(v => v)) {
            terminalOutput.innerHTML += `<div class="success">üéâ All file filtering requirements completed successfully!</div>`;
        }
    }
    
    function updateRequirements() {
        // Update grep command requirement
        const grepCommandItem = document.getElementById('req-grep-command');
        if (configState.grepCommand) {
            grepCommandItem.classList.add('completed');
            grepCommandItem.querySelector('.requirement-checkbox').textContent = '‚úì';
        }
        
        // Update output redirection requirement
        const outputRedirectionItem = document.getElementById('req-output-redirection');
        if (configState.outputRedirection) {
            outputRedirectionItem.classList.add('completed');
            outputRedirectionItem.querySelector('.requirement-checkbox').textContent = '‚úì';
        }
        
        // Update preserve order requirement
        const preserveOrderItem = document.getElementById('req-preserve-order');
        if (configState.preserveOrder) {
            preserveOrderItem.classList.add('completed');
            preserveOrderItem.querySelector('.requirement-checkbox').textContent = '‚úì';
        }
        
        // Update verify result requirement
        const verifyResultItem = document.getElementById('req-verify-result');
        if (configState.verifyResult) {
            verifyResultItem.classList.add('completed');
            verifyResultItem.querySelector('.requirement-checkbox').textContent = '‚úì';
        }
    }
</script>
</body>
</html>